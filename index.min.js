/*!
 *
 * The MIT License (MIT)
 *
 * Copyright © 2024 Taufik Nurrohman <https://github.com/taufik-nurrohman>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the “Software”), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */
!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(n="undefined"!=typeof globalThis?globalThis:n||self).OptionPicker=t()}(this,(function(){"use strict";var n=function(n,t){return-1!==t.indexOf(n)},t=function(n){return Array.isArray(n)},e=function(n){return"function"==typeof n},r=function(n,t){return n&&i(t)&&n instanceof t},u=function(n,t){return void 0===t&&(t=!0),"object"==typeof n&&(!t||r(n,Object))},i=function(n){return function(n){return void 0!==n}(n)&&!function(n){return null===n}(n)},o=function(n){return"string"==typeof n},f=function(n){return n.length},l=function n(e){if(t(e))return e.map((function(t){return n(t)}));if(function(n){return/^-?(?:\d*.)?\d+$/.test(n+"")}(e))return function(n,t){return void 0===t&&(t=10),t?parseInt(n,t):parseFloat(n)}(e);if(u(e)){for(var r in e)e[r]=n(e[r]);return e}return"false"!==e&&("null"===e?null:"true"===e||e)},c=function e(){for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];for(var c=o.shift(),a=0,s=f(o);a<s;++a)for(var v in o[a])if(i(c[v]))if(t(c[v])&&t(o[a][v])){c[v]=[].concat(c[v]);for(var d=0,p=f(o[a][v]);d<p;++d)n(o[a][v][d],c[v])||c[v].push(o[a][v][d])}else u(c[v])&&u(o[a][v])?c[v]=e({},c[v],o[a][v]):c[v]=o[a][v];else c[v]=o[a][v];return c},a=function n(e){if(t(e))return e.map((function(t){return n(e)}));if(u(e)){for(var r in e)e[r]=n(e[r]);return e}return!1===e?"false":null===e?"null":!0===e?"true":""+e},s=document,v=function(n,t){void 0===t&&(t=!0);for(var e,r=n.attributes,u={},i=0,o=r.length;i<o;++i)e=r[i].value,u[r[i].name]=t?l(e):e;return u},d=function(n){return(n&&n.nodeName||"").toLowerCase()||null},p=function(n,t){return t?n.closest(t)||null:n.parentNode||null},h=function(n){var t="form";return _(n,t)&&t===d(n.form)?n.form:p(n,t)},m=function(n,t){void 0===t&&(t=!0);var e="textContent";if(!_(n,e))return!1;var r=n[e];return""!==(r=t?r.trim():r)?r:null},_=function(n,t){return t in n},b=function(n,t){return n.removeAttribute(t),n},y=function(n,t,e){return!0===e&&(e=t),n.setAttribute(t,a(e)),n},k=function(n,t){return n.append(t),t},g=function(n,t,e){return n=o(n)?s.createElement(n):n,u(t)&&(e=t,t=!1),o(t)&&x(n,t),u(e)&&function(n,t){var e;for(var r in t)(e=t[r])||""===e||0===e?y(n,r,e):b(n,r)}(n,e),n},x=function(n,t,e){if(void 0===e&&(e=!0),null===t)return n;var r="innerHTML";return _(n,r)&&(n[r]=e?t.trim():t),n};var w=function(n,t,e){t.removeEventListener(n,e)},E=function(n,t,e,r){void 0===r&&(r=!1),t.addEventListener(n,e,r)};const L="OptionPicker";function O(n,t,e){Object.defineProperty(n,t,e)}function A(n){return(n.value||"").replace(/\r/g,"")}function C(n){return n.disabled}function I(n){return n.readOnly}function P(n,t){const e=this;return n?r(e,P)?(n["_"+L]=function(n){var t={};return n.hooks=t,n.fire=function(e,r){return i(t[e])?(t[e].forEach((function(t){return t.apply(n,r)})),n):n},n.off=function(e,r){if(!i(e))return t={},n;if(i(t[e]))if(i(r)){for(var u=0,o=t[e].length;u<o;++u)if(r===t[e][u]){t[e].splice(u,1);break}0===j&&delete t[e]}else delete t[e];return n},n.on=function(e,r){return i(t[e])||(t[e]=[]),i(r)&&t[e].push(r),n},n}(e),e.attach(n,c({},P.state,t||{}))):new P(n,t):e}P.state={n:"option-picker",options:null,with:[]},P.version="2.0.0",O(P,"name",{value:L});const T=P.prototype;function N(n){this["_"+L].let().fire("reset",[n])}function B(n){return this["_"+L].fire("submit",[n])}return O(T,"value",{get:function(){let n=this.self.value;return""===n?null:n},set:function(n){this.fire("change")}}),T.attach=function(n,r){let l=this;n=n||l.self,r=r||l.state,l._active=!C(n)&&!I(n),l._options=function(n){const t={},e=A(n);if("input"===d(n));else{let r=[];for(let e=0,u=f(n.options);e<u;++e){let u=n.options[e],i=v(u);["disabled","selected"].forEach((n=>{n in i?(i[n]=""===i[n]||i[n],"selected"===n&&r.push(e)):i[n]=null})),t[u.value]=[m(u)||u.value,i]}0===f(r)&&t[e]&&(t[e][1].selected=!0)}return t}(n),l._value=A(n)||null,l.self=n,l.state=r;let c=r.n,a="input"===d(n);const s=h(n),b=g("div",{class:c,tabindex:!C(n)&&-1});l.mask=b;const y=g("span",{class:c+"__values"}),x=g("span",{class:c+"__text"}),w=g("span",{contenteditable:!(C(n)||I(n)||!a)&&"",spellcheck:!!a&&"false"}),O=g("span",a?n.placeholder+"":"");var j;k(b,y),k(y,x),k(x,w),k(x,O),j=c+"__self",n.classList.add(j),function(n,t){p(n).insertBefore(t,function(n,t){return n["next"+(!0?"":"Element")+"Sibling"]||null}(n))}(n,b),s&&(s["_"+L]=l,E("reset",s,N),E("submit",s,B)),n.tabIndex=-1,b["_"+L]=l;let T={hint:null,input:null};T.of=n,T.options=null,T.self=b,T.text=null,l._mask=T;const F=l._options[l._value];if(function(n,t,e){if(void 0===e&&(e=!0),null===t)return n;var r="textContent";_(n,r)&&(n[r]=e?t.trim():t)}(w,t(F)?F[0]:F),i(r)&&t(r.with))for(let t=0,i=f(r.with);t<i;++t){let i=r.with[t];o(i)&&(i=P[i]),e(i)?i.call(l,n,r):u(i)&&e(i.attach)&&i.attach.call(l,n,r)}return l},T.blur=function(){},T.detach=function(){let n=this,{_mask:r,mask:i,self:l,state:c}=n;const a=h(l);if(n._active=!1,n._value=A(l)||null,a&&(w("reset",a,N),w("submit",a,B)),t(c.with))for(let t=0,r=f(c.with);t<r;++t){let r=c.with[t];o(r)&&(r=P[r]),u(r)&&e(r.detach)&&r.detach.call(n,l,c)}var s,v;return l.tabIndex=null,s=l,v=c.n+"__self",s.classList.remove(v),function(n){var t=p(n);n.remove()}(i),n._mask={of:l},n.mask=null,n},T.focus=function(){},P}));