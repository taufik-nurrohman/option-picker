/*!
 *
 * The MIT License (MIT)
 *
 * Copyright © 2024 Taufik Nurrohman <https://github.com/taufik-nurrohman>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the “Software”), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */
!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(t="undefined"!=typeof globalThis?globalThis:t||self).OptionPicker=n()}(this,(function(){"use strict";var t=function(t,n){return-1!==n.indexOf(t)},n=function(t){return Array.isArray(t)},e=function(t){return u(t)&&0!=t%1},r=function(t){return"function"==typeof t},i=function(t,n,e){return!(!t||"object"!=typeof t)&&(e?s(n)&&s(t.constructor)&&n===t.constructor:s(n)&&t instanceof n)},o=function(t){return u(t)&&0==t%1},u=function(t){return"number"==typeof t},a=function(t,n){return void 0===n&&(n=!0),!(!t||"object"!=typeof t)&&(!n||i(t,Object,1))},s=function(t){return function(t){return void 0!==t}(t)&&!function(t){return null===t}(t)},f=function(t){return"string"==typeof t},l=function(t){return t.replace(/[-_.](\w)/g,(function(t,n){return v(n)}))},c=function(t){return t.toLowerCase()},v=function(t){return t.toUpperCase()},d=function(t){return t.length},p=function(t){if(n(t))return t.map((function(t){return p(t)}));if(function(t){return/^-?(?:\d*.)?\d+$/.test(t+"")}(t))return function(t,n){return void 0===n&&(n=10),n?parseInt(t,n):parseFloat(t)}(t);if(a(t)){for(var e in t)t[e]=p(t[e]);return t}return"false"!==t&&("null"===t?null:"true"===t||t)},h=function(){for(var e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];for(var o=r.shift(),u=0,f=d(r);u<f;++u)for(var l in r[u])if(s(o[l]))if(n(o[l])&&n(r[u][l])){o[l]=[].concat(o[l]);for(var c=0,v=d(r[u][l]);c<v;++c)t(r[u][l][c],o[l])||o[l].push(r[u][l][c])}else a(o[l])&&a(r[u][l])?o[l]=h({},o[l],r[u][l]):o[l]=r[u][l];else o[l]=r[u][l];return o},_=function(t){if(n(t))return t.map((function(n){return _(t)}));if(a(t)){for(var e in t)t[e]=_(t[e]);return t}return!1===t?"false":null===t?"null":!0===t?"true":""+t},m=document,g=window,k=m.body,b=m.documentElement,x=function(t){return t.firstElementChild||null},y=function(t){return t.lastElementChild||null},w=function(t,n,e){void 0===e&&(e=!0);var r=function(t,n,e){if(void 0===e&&(e=!0),!M(t,n))return null;var r=t.getAttribute(n);return e?p(r):r}(t,"data-"+n,e),i=(r+"").trim();return e&&i&&("["===i[0]&&"]"===i.slice(-1)||"{"===i[0]&&"}"===i.slice(-1))&&null!==(i=function(t){var n=null;try{n=JSON.parse(t)}catch(t){}return n}(r))?i:r},z=function(t,n){void 0===n&&(n=!0);var e="innerHTML";if(!j(t,e))return!1;var r=t[e];return""!==(r=n?r.trim():r)?r:null},E=function(t){return c(t&&t.nodeName||"")||null},L=function(t,n){return t["next"+(n?"":"Element")+"Sibling"]||null},T=function(t,n){return n?t.closest(n)||null:t.parentNode||null},A=function(t){var n="form";return j(t,n)&&n===E(t[n])?t[n]:T(t,n)},C=function(t,n){return t["previous"+(n?"":"Element")+"Sibling"]||null},O=function(t,n,e){var r=g.getComputedStyle(t).getPropertyValue(n);return r||""===r||0===r?r:null},P=function(t,n){void 0===n&&(n=!0);var e="textContent";if(!j(t,e))return!1;var r=t[e];return""!==(r=n?r.trim():r)?r:null},M=function(t,n){return t.hasAttribute(n)},S=function(t,n){return t.classList.contains(n)},j=function(t,n){return n in t},N=function(t,n){return t.removeAttribute(n),t},R=function(t,n){return t.classList.remove(n),t},D=function(t){var n=T(t);return t.remove(),n},H=function(t,n){return t.style[l(n)]=null,t},I=function(t,n,e){return!0===e&&(e=n),t.setAttribute(n,_(e)),t},K=function(t,n){return t.append(n),n},B=function(t,n){return t.classList.add(n),t},U=function(t,e,r){return(n(r)||a(r))&&(r=JSON.stringify(r)),I(t,"data-"+e,r)},Y=function(t,n,e){return t=f(t)?m.createElement(t):t,a(n)&&(e=n,n=!1),f(n)&&J(t,n),a(e)&&function(t,n){var e;for(var r in n)(e=n[r])||""===e||0===e?I(t,r,e):N(t,r)}(t,e),t},J=function(t,n,e){if(void 0===e&&(e=!0),null===n)return t;var r="innerHTML";return j(t,r)&&(t[r]=e?n.trim():n),t},V=function(t,n,e){return u(e)&&(e+="px"),t.style[l(n)]=_(e),t},W=function(t,n){var e;for(var r in n)(e=n[r])||""===e||0===e?V(t,r,e):H(t,r);return t},F=function(t,n,e){if(void 0===e&&(e=!0),null===n)return t;var r="textContent";return j(t,r)&&(t[r]=e?n.trim():n),t},X=function(t,n){var e;return function(){var r=arguments,i=this;e&&clearTimeout(e),e=setTimeout((function(){return t.apply(i,r)}),n)}},$=function(t,n){return function(){var e=arguments,r=this;setTimeout((function(){return t.apply(r,e)}),n)}},q=function(t){var n,e,r,i,o,u,a;return!function(t){return t===g}(t)?(i=(e=t.getBoundingClientRect()).left,o=e.top,r=e.width,n=e.height,u=e.right,a=e.bottom):(i=t.pageXOffset||b.scrollLeft||k.scrollLeft,o=t.pageYOffset||b.scrollTop||k.scrollTop,r=t.innerWidth,n=t.innerHeight),[i,o,r,n,u,a]},G=function(t){return[t.scrollLeft,t.scrollTop]};var Q=function(t,n,e){n.removeEventListener(t,e)},Z=function(t){return t&&t.preventDefault()},tt=function(t){return t&&t.stopPropagation()},nt=function(t,n,e,r){void 0===r&&(r=!1),n.addEventListener(t,e,r)},et="ArrowDown",rt="ArrowUp",it="Backspace",ot="Delete",ut="Enter",at="Escape",st="PageDown",ft="PageUp",lt="Tab",ct=X((function(t){return t.fit()}),10),vt=new WeakMap;function dt(t,n){var r,i,u=this,a=u.self,s=u.state.n;s+="__option",r="input"===E(a)?(r=a.list)?r.children:[]:a.children;for(var l=0,c=d(r);l<c;++l)r[l]&&D(r[l]);u._options=new Map,J(t,""),gt(n,(function(n,r){(e(n)||o(n)||f(n))&&(n=[n,{}]),"data-group"in n[1]?i&&kt(i)===n[1]["data-group"]||K(t,i=Y("span",{class:s+"-group","data-value":n[1]["data-group"]})):i=!1;var l=n[1],c=l.disabled,v=l.selected,d=l.value;zt(a)&&(c=!0);var p=Y("span",_(n[0]),{class:s+(c?" "+s+"--disabled":"")+(v?" "+s+"--selected":""),"data-group":"data-group"in n[1]&&n[1]["data-group"],"data-value":_(d||r),tabindex:!c&&-1});if(c||(nt("blur",p,jt),nt("focus",p,Ht),nt("keydown",p,Vt),nt("mousedown",p,$t),nt("touchend",p,Zt),nt("touchstart",p,$t)),p._={},n[2])p._[0]=n[2];else{var h=Y("option",n[0],{disabled:!!c&&"",selected:!!v&&"",value:_(d||r)});a.add(h),p._[0]=h}K(i||t,p),Tt(p,u),At(r,p,u._options)})),console.log(n)}function pt(t,e,r){var o=i(e,Map)?e:new Map;if(n(e))mt(e,(function(t){var e,r,i;n(t)?(t[0]=null!=(e=t[0])?e:"",t[1]=null!=(r=t[1])?r:{},At(null!=(i=t[1].value)?i:t[0],t,o)):At(t,[t,{}],o)}));else if(a(e))for(var u in e){var s,f,l;if(n(e[u]))e[u][0]=null!=(s=e[u][0])?s:"",e[u][1]=null!=(f=e[u][1])?f:{},At(null!=(l=e[u][1].value)?l:u,e[u],o);else At(u,[e[u],{}],o)}dt.call(t,r,o)}function ht(t,n,e){Object.defineProperty(t,n,e)}function _t(t){t.focus()}function mt(t,n){t.forEach(n)}function gt(t,n){mt(t,n)}function kt(t){return w(t,"value",!1)}function bt(t){var n,e,r=new Map,i=[],o=yt(t);e="input"===E(t)?(e=t.list)?e.children:[]:t.children;for(var u=function(t){var n=e[t],o=function(t,n){void 0===n&&(n=!0);for(var e,r=t.attributes,i={},o=0,u=r.length;o<u;++o)e=r[o].value,i[r[o].name]=n?p(e):e;return i}(n);if(mt(["disabled","selected"],(function(n){n in o?(o[n]=""===o[n]||o[n],"selected"===n&&i.push(t)):o[n]=null})),"optgroup"===E(n))return gt(bt(n),(function(t,e){t[1]["data-group"]=n.label,At(e,t,r)})),1;At(n.value,[P(n)||n.value,o,n],r)},a=0,s=d(e);a<s;++a)u(a);return 0===d(i)&&(n=wt(o,r))&&(n[1].selected=!0,At(o,n,r)),r}function xt(t){return wt(t,vt)||null}function yt(t){return(t.value||"").replace(/\r/g,"")}function wt(t,n){return n.get(t)}function zt(t){return t.disabled}function Et(t){return t.readOnly}function Lt(t){return function(t,n){return n.delete(t)}(t,vt)}function Tt(t,n){return At(t,n,vt)}function At(t,n,e){return e.set(t,n)}function Ct(t){var n=[];return gt(t,(function(t){return n.push(t)})),n}function Ot(t,n){var e=this;return t?i(e,Ot)?(Tt(t,function(t,n){return(n=n||t).fire=function(t,n,e){var r=this,i=r.hooks;return s(i[t])?(i[t].forEach((function(t){return t.apply(e||r,n)})),r):r},n.off=function(t,n){var e=this,r=e.hooks;if(!s(t))return r={},e;if(s(r[t]))if(s(n)){var i=r[t].length;if(0===i)delete r[t];else for(var o=0;o<i;++o)if(n===r[t][o]){r[t].splice(o,1);break}}else delete r[t];return e},n.on=function(t,n){var e=this.hooks;return s(e[t])||(e[t]=[]),s(n)&&e[t].push(n),this},t.hooks={},t}(e,Ot._)),e.attach(t,h({},Ot.state,n||{}))):new Ot(t,n):e}Ot.from=function(t,n){return new Ot(t,n)},Ot.of=xt,Ot.state={n:"option-picker",options:null,size:null,strict:!1,with:[]},Ot.version="2.0.0",ht(Ot,"name",{value:"OptionPicker"});var Pt=Ot._=Ot.prototype;ht(Pt,"options",{get:function(){return this._options},set:function(t){var n=this,r=n._mask,i=n.state.n;i+="__option",(e(t)||o(t)||f(t))&&(t=[t]),pt(n,t,r.options);var u=Ct(n._options).find((function(t){return!t.hidden&&!S(t,i+"--disabled")}));u&&(n.value=kt(u))}}),ht(Pt,"size",{get:function(){var t=this.state.size||1;return o(t)?t<1?1:t:1},set:function(t){var n=this,e=n._mask,r=n._options,i=n.mask,u=n.state,a=e.options;u.n;var s=o(t)?t<1?1:t:1;if(n.state.size=s,1===s)N(i,"data-"+"size"),H(a,"max-height"),Lt(b);else{var f=Ct(r).find((function(t){return!t.hidden}));if(f){var l,c,v=O(a,"gap"),d=O(a,"padding-bottom"),p=null!=(l=null!=(c=O(f,"height"))?c:O(f,"min-height"))?l:O(f,"line-height");U(i,"size",s),V(a,"max-height","calc(("+p+" + max("+v+","+d+"))*"+s+")"),Tt(b,n)}}}}),ht(Pt,"text",{get:function(){var t=this._mask,n=t.input;return t.text?P(n):null},set:function(t){var n=this._mask,e=this.self,r=n.hint,i=n.input;n.text&&(F(i,_(t)),P(i,!1)?F(r,""):F(r,e.placeholder+""))}}),ht(Pt,"value",{get:function(){var t=yt(this.self);return""===t?null:t},set:function(t){var n,e=this._options;(n=wt(t,e))||(n=wt(p(t),e)),n&&sn(n,this)}}),ht(Pt,"values",{get:function(){},set:function(t){}});var Mt=X((function(n,e,o,u){var a=f(e)?e:P(e)||"",s=c(a),l=n._event,v=n._mask,h=n.mask,_=n.self,m=n.state,g=v.options,k=v.value,b=m.n,x=w(h,"size");if(b+="__option",u){var y,E=yt(_);gt(o,(function(t,n){N(t._[0],"selected"),R(t,b+"--selected")}));try{gt(o,(function(t,e){var r=c(P(t)+"\t"+(y=kt(t)));if(""!==s&&s===r.slice(0,d(s))&&!S(t,b+"--disabled"))throw _.value=y,I(t._[0],"selected",""),B(t,b+"--selected"),U(k,"value",y),J(k,z(t)),y!==E&&n.fire("change",[l,p(y)]),x&&t.scrollIntoView({block:"nearest"}),""}))}catch(t){}}else{var L=o.size;gt(o,(function(n,e){var r=c(P(n)+"\t"+kt(n));""!==s&&!t(s,r)||S(n,b+"--disabled")?(n.hidden=!0,--L):n.hidden=!1})),g.hidden=!L}n.fire("search",[l,a]);var T=m.options;r(T)&&(T=T.call(n,a),i(T,Promise)?T.then((function(t){pt(n,t,g),n.fire("load",[l,t,a])})):pt(n,T,g))}),50);function St(t){var n=this,e=xt(n),r=e.state.n;e._event=t,R(n,r+="--focus"),R(n,r+="-self")}function jt(t){var n=this,e=xt(n);e.mask;var r=e.state.n;e._event=t,R(n,r+="--focus"),R(n,r+="-option")}function Nt(t){var n=xt(this),e=n._mask,r=n.mask,i=n.state,o=e.text,u=i.n;n._event=t,R(r,u+"--focus-text"),R(o,u+"__text--focus")}function Rt(t){var n=this,e=xt(n),r=e._mask,i=e.self,o=r.hint;e._event=t,$((function(){return F(o,P(n,!1)?"":i.placeholder)}),1)()}function Dt(t){var n=this,e=xt(n),r=e.state.n;e._event=t,B(n,r+="--focus"),B(n,r+="-self")}function Ht(t){var n=xt(this),e=n.mask,r=n.state.n;un(),n._event=t,B(e,r+="--focus"),B(e,r+="-option")}function It(t){var n=xt(this);n._event=t,n.focus()}function Kt(t){var n=xt(this),e=n._mask,r=n.mask;n.self;var i=n.state,o=e.input,u=e.text,a=i.n;n._event=t,B(u,a+"__text--focus"),B(r,a+="--focus"),B(r,a+="-text"),P(o,!1)?an(this):n.enter().fit()}function Bt(t){var n,e=this,r=t.key,i=xt(e),o=i._mask,u=i._options,a=i.mask,s=i.self,f=i.state,l=o.hint,c=f.n;if(c+="__option--disabled",i._event=t,$((function(){return F(l,P(e,!1)?"":s.placeholder)}),1)(),it!==r&&ot!==r&&1!==d(r)||$((function(){return i.enter().fit()}),51)(),et===r||rt===r||ut===r){var v=yt(s),h=wt(v,u)||wt(p(v),u);if(!h||h.hidden)for(h=Ct(u).shift();h&&(S(h,c)||h.hidden);)h=L(h);h&&!S(a,c+"--open")&&i.enter(),h&&_t(h),n=!0}else lt===r?(f.strict,i.exit()):Mt(i,e,u);n&&(Z(t),tt(t))}var Ut="",Yt=X((function(){return Ut=""}),500);function Jt(t){var n,e=t.key,r=t.altKey,i=t.ctrlKey,o=xt(this),u=o._options,a=o.self;if(Yt(),zt(a)||Et(a))return Z(t);o._event=t,it===e||ot===e?Ut="":at===e?(Ut="",o.exit(n=!0)):lt===e?(Ut="",o.exit(!(n=!1))):et===e||rt===e||ut===e||st===e||ft===e||""===Ut&&" "===e?o.enter(n=!0).fit():1!==d(e)||r||i||(Ut+=e),""!==Ut&&Mt(o,Ut,u,n=!0),n&&Z(t)}function Vt(t){var n,e=this,r=t.key,i=t.altKey,o=t.ctrlKey,u=xt(e),a=u._mask,s=u._options;u.mask;var f=u.self,l=u.state,c=a.hint,v=a.input,h=a.value,_=l.n;_+="__option";var m,g,k,b,w,A="input"===E(f);if(u._event=t,it===r)u.exit(n=!0);else if(ut===r||at===r||lt===r||" "===r){if(at!==r){var O,M=yt(f);(w=wt(M,s)||wt(p(M),s))&&(N(w._[0],"selected"),R(w,_+"--selected")),I(e._[0],"selected",""),B(e,_+"--selected"),f.value=O=kt(e),A?(F(c,""),F(v,P(e))):(U(h,"value",O),J(h,z(e))),O!==M&&u.fire("change",[t,p(O)])}u.exit(n=lt!==r)}else if(et===r||st===r){for(n=!0,k=st===r&&S(b=T(e),_+"-group")?L(b):L(e);k&&(S(k,_+"--disabled")||k.hidden);)k=L(k);for(k?S(k,_+"-group")&&(k=x(k)):((b=T(e))&&S(b,_+"-group")&&(k=L(b)),k&&S(k,_+"-group")&&(k=x(k)));k&&(S(k,_+"--disabled")||k.hidden);)k=L(k);k?_t(k):(m=Ct(s).find((function(t){return!t.hidden&&!S(t,_+"--disabled")})))&&_t(m)}else if(rt===r||ft===r){for(n=!0,w=ft===r&&S(b=T(e),_+"-group")?C(b):C(e);w&&(S(w,_+"--disabled")||w.hidden);)w=C(w);for(w?S(w,_+"-group")&&(w=y(w)):((b=T(e))&&S(b,_+"-group")&&(w=C(b)),w&&S(w,_+"-group")&&(w=y(w)));w&&(S(w,_+"--disabled")||w.hidden);)w=C(w);w?_t(w):(g=Ct(s).findLast((function(t){return!t.hidden&&!S(t,_+"--disabled")})))&&_t(g)}else"Home"===r?(n=!0,(m=Ct(s).find((function(t){return!t.hidden&&!S(t,_+"--disabled")})))&&_t(m)):"End"===r?(n=!0,(g=Ct(s).findLast((function(t){return!t.hidden&&!S(t,_+"--disabled")})))&&_t(g)):(A&&1===d(r)&&!i&&!o&&F(c,""),u.exit(!(n=!1)));n&&(Z(t),tt(t))}function Wt(t){var n=this,e=xt(n),r=e._mask,i=e.self,o=r.hint;e._event=t,$((function(){return F(n,P(n))}))(),$((function(){return F(o,P(n,!1)?"":i.placeholder)}),1)()}function Ft(t){var n=this,e=xt(n),r=e.self,i=e.state.n,o=t.target;Z(t),zt(r)||Et(r)||w(n,"size")||(e._event=t,S(o,i+"__options")||T(o,"."+i+"__options")||e[S(n,i+"--open")?"exit":"enter"](!0).fit())}var Xt=0;function $t(t){var n=this,e=xt(n),r=e._mask,i=e.mask,o=r.options;e._event=t,"mousedown"===t.type?(sn(n,e),w(i,"size")||e.exit(!0)):(_t(n),Xt=G(o)[1]),Z(t)}var qt=!1;function Gt(t){"touchstart"===t.type&&(qt=t.touches[0].clientY);var n=xt(this);if(n){var e=n.mask,r=n.state.n,i=t.target;n._event=t,e!==i&&e!==T(i,"."+r)&&(w(e,"size")?n.blur():(Lt(this),n.exit()))}}function Qt(t){if(!1!==qt){var n,e,r=xt(this);if(r._event=t,"touchmove"===t.type&&r){var i=r._mask.options,o=t.touches[0].clientY;if(i){var u=G(i);u[1]-=o-qt,e=u,(n=i).scrollLeft=e[0],n.scrollTop=e[1],qt=o}}}}function Zt(t){var n=xt(this),e=n._mask.options;n._event=t,G(e)[1]===Xt&&(sn(this,n),n.exit(!0))}function tn(){qt=!1}function nn(t){var n=xt(this);n._event=t,n.let().fire("reset",[t])}function en(t){var n=xt(this);n&&(ct(n),n._event=t)}function rn(t){en.call(this,t)}function on(t){var n=xt(this);return n._event=t,n.fire("submit",[t])}function un(t){var n=m.getSelection();n.rangeCount&&n.removeRange(n.getRangeAt(0))}function an(t,n){var e=m.getSelection();un();var r=m.createRange();r.selectNodeContents(t),e.addRange(r),1===n?e.collapseToEnd():-1===n&&e.collapseToStart()}function sn(t,n){var e=n._event,r=n._mask,i=n._options,o=n.self,u=n.state,a=r.hint,s=r.input;r.options;var f=r.value,l=u.n;l+="__option--selected";var c,v=yt(o);gt(i,(function(n,e){t!==n&&(N(n._[0],"selected"),R(n,l))})),I(t._[0],"selected",""),B(t,l),o.value=c=kt(t),"input"===E(o)?(F(a,""),F(s,P(t))):(U(f,"value",c),J(f,z(t))),c!==v&&n.fire("change",[e,p(c)])}return Pt.attach=function(t,e){var o,u=this;t=t||u.self,e=e||u.state,u._active=!zt(t)&&!Et(t),u._event=null,u._options=new Map,u._value=yt(t)||null,u.self=t,u.state=e;var l="input"===E(t),c=e.n,v=Y("span",{class:c+"__arrow"}),h=A(t),_=Y("div",{class:c,tabindex:!zt(t)&&!l&&0});u.mask=_;var m=Y("div",{class:c+"__options"}),k=e.options;r(k)?(k=k.call(u,null),i(k,Promise)?k.then((function(t){pt(u,t,m),u.fire("load",[picker._event,t,null])})):pt(u,k,m)):pt(u,k||bt(t),m);var x,y,w=Y("div",{class:c+"__values"}),C=Y("span",{class:c+"__"+(l?"text":"value")}),O=Y("span",{autocapitalize:"off",contenteditable:!(zt(t)||Et(t)||!l)&&"",spellcheck:!!l&&"false"}),M=Y("span",l?t.placeholder+"":"");K(_,w),K(_,m),K(w,C),K(w,v),l?(nt("blur",O,Nt),nt("cut",O,Rt),nt("focus",O,Kt),nt("keydown",O,Bt),nt("paste",O,Wt),K(C,O),K(C,M),Tt(O,u)):(nt("blur",_,St),nt("focus",_,Dt),nt("keydown",_,Jt)),B(t,c+"__self"),y=_,T(x=t).insertBefore(y,L(x,!0)),h&&(nt("reset",h,nn),nt("submit",h,on),Tt(h,u)),nt("focus",t,It),nt("mousedown",b,Gt),nt("mousedown",_,Ft),nt("mousemove",b,Qt),nt("mouseup",b,tn),nt("resize",g,en),nt("scroll",g,rn),nt("touchend",b,tn),nt("touchmove",b,Qt,{passive:!1}),nt("touchstart",b,Gt),nt("touchstart",_,Ft),t.tabIndex=-1,Tt(_,u);var S,j={};if(j.arrow=v,j.hint=l?M:null,j.input=l?O:null,j.of=t,j.options=m,j.self=_,j[l?"text":"value"]=C,u._mask=j,u.size=null!=(o=e.size)?o:l?1:t.size,(S=wt(u._value,u._options)||wt(p(u._value),u._options)||(l?0:Ct(u._options).find((function(t){return!zt(t._[0])}))))&&(I(S._[0],"selected",""),l?(F(O,P(S)),P(O,!1)&&F(M,"")):(U(C,"value",kt(S)),J(C,z(S)))),s(e)&&n(e.with))for(var N=0,R=d(e.with);N<R;++N){var D=e.with[N];f(D)&&(D=Ot[D]),r(D)?D.call(u,t,e):a(D)&&r(D.attach)&&D.attach.call(u,t,e)}return u},Pt.blur=function(){un();var t=this,n=t._mask,e=t.mask;return(n.input||e).blur(),t.exit()},Pt.detach=function(){var t=this,e=t._mask,i=t.mask,o=t.self,u=t.state,s=e.input,l=A(o);if(t._active=!1,t._value=yt(o)||null,l&&(Q("reset",l,nn),Q("submit",l,on)),s&&(Q("blur",s,Nt),Q("blur",i,St),Q("cut",s,Rt),Q("focus",s,Kt),Q("focus",i,Dt),Q("keydown",s,Bt),Q("keydown",i,Jt),Q("paste",s,Wt)),Q("focus",o,It),Q("mousedown",b,Gt),Q("mousedown",i,Ft),Q("mousemove",b,Qt),Q("mouseup",b,tn),Q("resize",g,en),Q("scroll",g,rn),Q("touchend",b,tn),Q("touchmove",b,Qt),Q("touchstart",b,Gt),Q("touchstart",i,Ft),n(u.with))for(var c=0,v=d(u.with);c<v;++c){var p=u.with[c];f(p)&&(p=Ot[p]),a(p)&&r(p.detach)&&p.detach.call(t,o,u)}return o.tabIndex=null,R(o,u.n+"__self"),D(i),t._mask={of:o},t.mask=null,t},Pt.enter=function(t){var n,e,r=this,i=r._event,o=r._mask,u=r._options,a=r.mask,s=r.self,f=r.state,l=o.input,c=f.n;B(a,c+"--focus"),B(a,c+"--focus-option"),B(a,c+="--open");var v=xt(b);return v&&r!==v&&v.exit(),Tt(b,r),Tt(g,r),r.fire("enter",[i]),t&&(r.fire("focus",[i]),"input"===E(s)?(_t(l),an(l)):(n=wt(e=yt(s),u)||wt(p(e),u))&&_t(n),r.fire("focus.option",[i])),r},Pt.exit=function(t){var n=this,e=n._event,r=n._mask,i=n.mask,o=n.self,u=n.state,a=r.input,s=u.n;return R(i,s+"--focus"),R(i,s+"--focus-option"),R(i,s+="--open"),n.fire("exit",[e]),t&&("input"===E(o)?(_t(a),an(a)):_t(i),n.fire("focus",[e]).fire("focus.self",[e])),n},Pt.fit=function(){var t=this,n=t._mask,e=t.mask,r=n.options;if(w(e,"size"))return t;var i=O(e,"border-bottom-width"),o=O(e,"border-top-width"),u=q(e),a=q(g);return u[1]+u[3]/2>a[3]/2?W(r,{bottom:"100%","max-height":"calc("+u[1]+"px + "+i+")",top:"auto"}):W(r,{bottom:"auto","max-height":"calc("+(a[3]-u[1]-u[3])+"px + "+o+")",top:"100%"}),t},Pt.focus=function(t){var n=this,e=n._mask,r=n.mask,i=e.input;return i?(_t(i),an(i,t),n):(_t(r),n)},Ot}));