/*!
 *
 * The MIT License (MIT)
 *
 * Copyright © 2024 Taufik Nurrohman <https://github.com/taufik-nurrohman>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the “Software”), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */
!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(t="undefined"!=typeof globalThis?globalThis:t||self).OptionPicker=n()}(this,(function(){"use strict";var t=function(t,n){return-1!==n.indexOf(t)},n=function(t){return Array.isArray(t)},e=function(t){return"function"==typeof t},r=function(t,n,e){return!(!t||"object"!=typeof t)&&(e?a(n)&&a(t.constructor)&&n===t.constructor:a(n)&&t instanceof n)},i=function(t){return o(t)&&0==t%1},o=function(t){return"number"==typeof t},u=function(t,n){return void 0===n&&(n=!0),!(!t||"object"!=typeof t)&&(!n||r(t,Object,1))},a=function(t){return function(t){return void 0!==t}(t)&&!function(t){return null===t}(t)},s=function(t){return"string"==typeof t},f=function(t){return t.replace(/[-_.](\w)/g,(function(t,n){return c(n)}))},l=function(t){return t.toLowerCase()},c=function(t){return t.toUpperCase()},d=function(t){return t.length},v=function(t){return Object.keys(t)},p=function(t){return Object.values(t)},h=function(t){if(n(t))return t.map((function(t){return h(t)}));if(function(t){return/^-?(?:\d*.)?\d+$/.test(t+"")}(t))return function(t,n){return void 0===n&&(n=10),n?parseInt(t,n):parseFloat(t)}(t);if(u(t)){for(var e in t)t[e]=h(t[e]);return t}return"false"!==t&&("null"===t?null:"true"===t||t)},m=function(){for(var e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];for(var o=r.shift(),s=0,f=d(r);s<f;++s)for(var l in r[s])if(a(o[l]))if(n(o[l])&&n(r[s][l])){o[l]=[].concat(o[l]);for(var c=0,v=d(r[s][l]);c<v;++c)t(r[s][l][c],o[l])||o[l].push(r[s][l][c])}else u(o[l])&&u(r[s][l])?o[l]=m({},o[l],r[s][l]):o[l]=r[s][l];else o[l]=r[s][l];return o},_=function(t){if(n(t))return t.map((function(n){return _(t)}));if(u(t)){for(var e in t)t[e]=_(t[e]);return t}return!1===t?"false":null===t?"null":!0===t?"true":""+t},g=document,b=window,k=g.body,y=g.documentElement,x=function(t){return t.firstElementChild||null},w=function(t){return t.lastElementChild||null},z=function(t,n,e){void 0===e&&(e=!0);var r=function(t,n,e){if(void 0===e&&(e=!0),!j(t,n))return null;var r=t.getAttribute(n);return e?h(r):r}(t,"data-"+n,e),i=(r+"").trim();return e&&i&&("["===i[0]&&"]"===i.slice(-1)||"{"===i[0]&&"}"===i.slice(-1))&&null!==(i=function(t){var n=null;try{n=JSON.parse(t)}catch(t){}return n}(r))?i:r},E=function(t,n){void 0===n&&(n=!0);var e="innerHTML";if(!N(t,e))return!1;var r=t[e];return""!==(r=n?r.trim():r)?r:null},L=function(t){return l(t&&t.nodeName||"")||null},T=function(t,n){return t["next"+(n?"":"Element")+"Sibling"]||null},O=function(t,n){return n?t.closest(n)||null:t.parentNode||null},A=function(t){var n="form";return N(t,n)&&n===L(t[n])?t[n]:O(t,n)},C=function(t,n){return t["previous"+(n?"":"Element")+"Sibling"]||null},P=function(t,n,e){var r=b.getComputedStyle(t).getPropertyValue(n);return r||""===r||0===r?r:null},S=function(t,n){void 0===n&&(n=!0);var e="textContent";if(!N(t,e))return!1;var r=t[e];return""!==(r=n?r.trim():r)?r:null},j=function(t,n){return t.hasAttribute(n)},M=function(t,n){return t.classList.contains(n)},N=function(t,n){return n in t},R=function(t,n){return t.removeAttribute(n),t},D=function(t,n){return t.classList.remove(n),t},H=function(t,n){return t.style[f(n)]=null,t},I=function(t,n,e){return!0===e&&(e=n),t.setAttribute(n,_(e)),t},K=function(t,n){return t.append(n),n},B=function(t,n){return t.classList.add(n),t},U=function(t,e,r){return(n(r)||u(r))&&(r=JSON.stringify(r)),I(t,"data-"+e,r)},Y=function(t,n,e){return t=s(t)?g.createElement(t):t,u(n)&&(e=n,n=!1),s(n)&&J(t,n),u(e)&&function(t,n){var e;for(var r in n)(e=n[r])||""===e||0===e?I(t,r,e):R(t,r)}(t,e),t},J=function(t,n,e){if(void 0===e&&(e=!0),null===n)return t;var r="innerHTML";return N(t,r)&&(t[r]=e?n.trim():n),t},V=function(t,n,e){return o(e)&&(e+="px"),t.style[f(n)]=_(e),t},W=function(t,n){var e;for(var r in n)(e=n[r])||""===e||0===e?V(t,r,e):H(t,r);return t},F=function(t,n,e){if(void 0===e&&(e=!0),null===n)return t;var r="textContent";return N(t,r)&&(t[r]=e?n.trim():n),t},X=function(t,n){var e;return function(){var r=arguments,i=this;e&&clearTimeout(e),e=setTimeout((function(){return t.apply(i,r)}),n)}},$=function(t,n){return function(){var e=arguments,r=this;setTimeout((function(){return t.apply(r,e)}),n)}},q=function(t){var n,e,r,i,o,u,a;return!function(t){return t===b}(t)?(i=(e=t.getBoundingClientRect()).left,o=e.top,r=e.width,n=e.height,u=e.right,a=e.bottom):(i=t.pageXOffset||y.scrollLeft||k.scrollLeft,o=t.pageYOffset||y.scrollTop||k.scrollTop,r=t.innerWidth,n=t.innerHeight),[i,o,r,n,u,a]},G=function(t){return[t.scrollLeft,t.scrollTop]};var Q=function(t,n,e){n.removeEventListener(t,e)},Z=function(t){return t&&t.preventDefault()},tt=function(t){return t&&t.stopPropagation()},nt=function(t,n,e,r){void 0===r&&(r=!1),n.addEventListener(t,e,r)},et="ArrowDown",rt="ArrowUp",it="Backspace",ot="Delete",ut="Enter",at="Escape",st="PageDown",ft="PageUp",lt="Tab",ct=X((function(t){return t.fit()}),10),dt=new WeakMap;function vt(t,n){var e,i=this,o=i.self,u=i.state.n;u+="__option",gt(n=r(n,Map)&&n.size>0?n:bt(o),(function(n,r){"data-group"in n[1]?e&&z(e,"value",!1)===n[1]["data-group"]||K(t,e=Y("span",{class:u+"-group","data-value":n[1]["data-group"]})):e=!1;var o=n[1],a=o.disabled,s=o.selected,f=o.value,l=Y("span",n[0],{class:u+(a?" "+u+"--disabled":"")+(s?" "+u+"--selected":""),"data-value":_(f||r),tabindex:!a&&-1});a||(nt("blur",l,St),nt("focus",l,Rt),nt("keydown",l,Yt),nt("mousedown",l,Ft),nt("touchend",l,Gt),nt("touchstart",l,Ft)),l._={},l._[0]=n[2],i._options[r]=l,K(e||t,l),Lt(l,i)})),i.state.options=n}function pt(t,e,r){var i=new Map;if(n(e))_t(e,(function(t){var e,r;n(t)?(t[0]=null!=(e=t[0])?e:"",t[1]=null!=(r=t[1])?r:{},Tt(t[0],t,i)):Tt(t,[t,{}],i)}));else if(u(e))for(var o in e){var a,s;if(n(e[o]))e[o][0]=null!=(a=e[o][0])?a:"",e[o][1]=null!=(s=e[o][1])?s:{},Tt(o,e[o],i);else Tt(o,[e[o],{}],i)}vt.call(t,r,i)}function ht(t,n,e){Object.defineProperty(t,n,e)}function mt(t){t.focus()}function _t(t,n){t.forEach(n)}function gt(t,n){_t(t,n)}function bt(t){var n,e,r=new Map,i=yt(t),o=[];e="input"===L(t)?(e=t.list)?e.children:[]:t.children;for(var u=function(t){var n=e[t],i=function(t,n){void 0===n&&(n=!0);for(var e,r=t.attributes,i={},o=0,u=r.length;o<u;++o)e=r[o].value,i[r[o].name]=n?h(e):e;return i}(n);if(_t(["disabled","selected"],(function(n){n in i?(i[n]=""===i[n]||i[n],"selected"===n&&o.push(t)):i[n]=null})),"optgroup"===L(n))return gt(bt(n),(function(t,e){t[1]["data-group"]=n.label,Tt(e,t,r)})),1;Tt(n.value,[S(n)||n.value,i,n],r)},a=0,s=d(e);a<s;++a)u(a);return 0===d(o)&&(n=xt(i,r))&&(n[1].selected=!0,Tt(i,n,r)),r}function kt(t){return xt(t,dt)||null}function yt(t){return(t.value||"").replace(/\r/g,"")}function xt(t,n){return n.get(t)}function wt(t){return t.disabled}function zt(t){return t.readOnly}function Et(t){return function(t,n){return n.delete(t)}(t,dt)}function Lt(t,n){return Tt(t,n,dt)}function Tt(t,n,e){return e.set(t,n)}function Ot(t,n){var e=this;return t?r(e,Ot)?(Lt(t,function(t,n){return(n=n||t).fire=function(t,n,e){var r=this,i=r.hooks;return a(i[t])?(i[t].forEach((function(t){return t.apply(e||r,n)})),r):r},n.off=function(t,n){var e=this,r=e.hooks;if(!a(t))return r={},e;if(a(r[t]))if(a(n)){var i=r[t].length;if(0===i)delete r[t];else for(var o=0;o<i;++o)if(n===r[t][o]){r[t].splice(o,1);break}}else delete r[t];return e},n.on=function(t,n){var e=this.hooks;return a(e[t])||(e[t]=[]),a(n)&&e[t].push(n),this},t.hooks={},t}(e,Ot.prototype)),e.attach(t,m({},Ot.state,n||{}))):new Ot(t,n):e}Ot.from=function(t,n){return new Ot(t,n)},Ot.of=kt,Ot.state={n:"option-picker",options:null,size:null,with:[]},Ot.version="2.0.0",ht(Ot,"name",{value:"OptionPicker"});var At=Ot.prototype;ht(At,"size",{get:function(){var t=this.state.size||1;return i(t)?t<1?1:t:1},set:function(t){var n=this,e=n._mask,r=n._options,o=n.mask,u=n.state,a=e.options;u.n;var s=i(t)?t<1?1:t:1;if(n.state.size=s,1===s)R(o,"data-"+"size"),H(a,"max-height"),Et(y);else{var f=p(r).find((function(t){return!t.hidden}));if(f){var l,c,d=P(a,"gap"),v=P(a,"padding-bottom"),h=null!=(l=null!=(c=P(f,"height"))?c:P(f,"min-height"))?l:P(f,"line-height");U(o,"size",s),V(a,"max-height","calc(("+h+" + max("+d+","+v+"))*"+s+")"),Lt(y,n)}}}}),ht(At,"value",{get:function(){var t=yt(this.self);return""===t?null:t},set:function(t){this.fire("change",[h(t)])}});var Ct=X((function(n,i,o,u){var a=s(i)?i:S(i)||"",f=l(a),c=n._mask,p=n.mask,m=n.self,_=n.state,g=c.options,b=c.value,k=_.n,y=z(p,"size");if(k+="__option",u){var x,w=yt(m);for(var L in o){var T=o[L];R(T._[0],"selected"),D(T,k+"--selected")}for(var O in o){var A=o[O],C=l(S(A)+"\t"+(x=z(A,"value",!1)));if(""!==f&&f===C.slice(0,d(f))&&!M(A,k+"--disabled")){m.value=x,I(A._[0],"selected",""),B(A,k+"--selected"),U(b,"value",x),J(b,E(A)),x!==w&&n.fire("change",[h(x)]),y&&A.scrollIntoView({block:"nearest"});break}}}else{var P=d(v(o));for(var j in o){var N=o[j],H=l(S(N)+"\t"+z(N,"value",!1));""!==f&&!t(f,H)||M(N,k+"--disabled")?(N.hidden=!0,--P):N.hidden=!1}g.hidden=!P}n.fire("search",[a]);var K=_.options;e(K)&&(K=K.call(n,a),r(K,Promise)&&K.then((function(t){pt(n,t,g),n.fire("load",[t,a])})))}),10);function Pt(){var t=this,n=kt(t).state.n;D(t,n+="--focus"),D(t,n+="-self")}function St(){var t=this,n=kt(t);n.mask;var e=n.state.n;D(t,e+="--focus"),D(t,e+="-option")}function jt(){var t=kt(this),n=t._mask,e=t.mask,r=t.state,i=n.text,o=r.n;D(e,o+"--focus-text"),D(i,o+"__text--focus")}function Mt(){var t=this,n=kt(t),e=n._mask,r=n.self,i=e.hint;$((function(){return F(i,S(t,!1)?"":r.placeholder)}),1)()}function Nt(){var t=this,n=kt(t).state.n;B(t,n+="--focus"),B(t,n+="-self")}function Rt(){var t=kt(this),n=t.mask,e=t.state.n;rn(),B(n,e+="--focus"),B(n,e+="-option")}function Dt(){kt(this).focus()}function Ht(){var t=kt(this),n=t._mask,e=t.mask;t.self;var r=t.state,i=n.input,o=n.text,u=r.n;B(o,u+"__text--focus"),B(e,u+="--focus"),B(e,u+="-text"),S(i,!1)?on(this):t.enter().fit()}function It(t){var n,e=this,r=t.key,i=kt(e),o=i._mask,u=i._options,a=i.self,s=i.state,f=o.hint,l=s.n;if(l+="__option--disabled",$((function(){return F(f,S(e,!1)?"":a.placeholder)}),1)(),it!==r&&ot!==r&&1!==d(r)||$((function(){return i.enter().fit()}),11)(),et===r||rt===r||ut===r){var c=u[yt(a)];if(!c||c.hidden)for(c=p(u).shift();c&&(M(c,l)||c.hidden);)c=T(c);c&&mt(c),n=!0}else lt===r?i.exit():Ct(i,e,u);n&&(Z(t),tt(t))}var Kt="",Bt=X((function(){return Kt=""}),500);function Ut(t){var n,e=t.key,r=t.altKey,i=t.ctrlKey,o=kt(this),u=o._options,a=o.self;if(Bt(),wt(a)||zt(a))return Z(t);it===e||ot===e?Kt="":at===e?(Kt="",o.exit(n=!0)):lt===e?(Kt="",o.exit(!(n=!1))):et===e||rt===e||ut===e||st===e||ft===e||""===Kt&&" "===e?o.enter(n=!0).fit():1!==d(e)||r||i||(Kt+=e),""!==Kt&&Ct(o,Kt,u,n=!0),n&&Z(t)}function Yt(t){var n,e=this,r=t.key,i=t.altKey,o=t.ctrlKey,u=kt(e),a=u._mask,s=u._options;u.mask;var f=u.self,l=u.state,c=a.hint,v=a.input,m=a.value,_=l.n;_+="__option";var g,b,k,y,A,P="input"===L(f);if(it===r)u.exit(n=!0);else if(ut===r||at===r||lt===r||" "===r){if(at!==r){var j,N=yt(f);(A=s[yt(f)])&&(R(A._[0],"selected"),D(A,_+"--selected")),I(e._[0],"selected",""),B(e,_+"--selected"),f.value=j=z(e,"value",!1),P?(F(c,""),F(v,S(e))):(U(m,"value",j),J(m,E(e))),j!==N&&u.fire("change",[h(j)])}u.exit(n=lt!==r)}else if(et===r||st===r){for(n=!0,k=st===r&&M(y=O(e),_+"-group")?T(y):T(e);k&&(M(k,_+"--disabled")||k.hidden);)k=T(k);for(k?M(k,_+"-group")&&(k=x(k)):((y=O(e))&&M(y,_+"-group")&&(k=T(y)),k&&M(k,_+"-group")&&(k=x(k)));k&&(M(k,_+"--disabled")||k.hidden);)k=T(k);k?mt(k):(g=p(s).find((function(t){return!t.hidden&&!M(t,_+"--disabled")})))&&mt(g)}else if(rt===r||ft===r){for(n=!0,A=ft===r&&M(y=O(e),_+"-group")?C(y):C(e);A&&(M(A,_+"--disabled")||A.hidden);)A=C(A);for(A?M(A,_+"-group")&&(A=w(A)):((y=O(e))&&M(y,_+"-group")&&(A=C(y)),A&&M(A,_+"-group")&&(A=w(A)));A&&(M(A,_+"--disabled")||A.hidden);)A=C(A);A?mt(A):(b=p(s).findLast((function(t){return!t.hidden&&!M(t,_+"--disabled")})))&&mt(b)}else"Home"===r?(n=!0,(g=p(s).find((function(t){return!t.hidden&&!M(t,_+"--disabled")})))&&mt(g)):"End"===r?(n=!0,(b=p(s).findLast((function(t){return!t.hidden&&!M(t,_+"--disabled")})))&&mt(b)):(P&&1===d(r)&&!i&&!o&&F(c,""),u.exit(!(n=!1)));n&&(Z(t),tt(t))}function Jt(){var t=this,n=kt(t),e=n._mask,r=n.self,i=e.hint;$((function(){return F(t,S(t))}))(),$((function(){return F(i,S(t,!1)?"":r.placeholder)}),1)()}function Vt(t){var n=this,e=kt(n),r=e.self,i=e.state.n,o=t.target;Z(t),wt(r)||zt(r)||z(n,"size")||M(o,i+"__options")||O(o,"."+i+"__options")||e[M(n,i+"--open")?"exit":"enter"](!0).fit()}var Wt=0;function Ft(t){var n=this,e=kt(n),r=e._mask,i=e.mask,o=r.options;"mousedown"===t.type?(un(n,e),z(i,"size")||e.exit(!0)):(mt(n),Wt=G(o)[1]),Z(t)}var Xt=!1;function $t(t){"touchstart"===t.type&&(Xt=t.touches[0].clientY);var n=kt(this);if(n){var e=n.mask,r=n.state.n,i=t.target;e!==i&&e!==O(i,"."+r)&&(z(e,"size")?n.blur():(Et(this),n.exit()))}}function qt(t){if(!1!==Xt){var n,e,r=kt(this);if("touchmove"===t.type&&r){var i=r._mask.options,o=t.touches[0].clientY;if(i){var u=G(i);u[1]-=o-Xt,e=u,(n=i).scrollLeft=e[0],n.scrollTop=e[1],Xt=o}}}}function Gt(t){var n=kt(this),e=n._mask.options;G(e)[1]===Wt&&(un(this,n),n.exit(!0))}function Qt(t){Xt=!1}function Zt(t){kt(this).let().fire("reset",[t])}function tn(){var t=kt(this);t&&ct(t)}function nn(){tn.call(this)}function en(t){return kt(this).fire("submit",[t])}function rn(t){var n=g.getSelection();n.rangeCount&&n.removeRange(n.getRangeAt(0))}function on(t,n){var e=g.getSelection();rn();var r=g.createRange();r.selectNodeContents(t),e.addRange(r),1===n?e.collapseToEnd():-1===n&&e.collapseToStart()}function un(t,n){var e=n._mask,r=n._options,i=n.self,o=n.state,u=e.hint,a=e.input;e.options;var s=e.value,f=o.n;f+="__option--selected";var l,c=yt(i);for(var d in r){var v=r[d];t!==v&&(R(v._[0],"selected"),D(v,f))}I(t._[0],"selected",""),B(t,f),i.value=l=z(t,"value",!1),"input"===L(i)?(F(u,""),F(a,S(t))):(U(s,"value",l),J(s,E(t))),l!==c&&n.fire("change",[h(l)])}return At.attach=function(t,i){var o,f=this;t=t||f.self,i=i||f.state,f._active=!wt(t)&&!zt(t),f._options={},f._value=yt(t)||null,f.self=t,f.state=i;var l="input"===L(t),c=i.n,v=Y("span",{class:c+"__arrow"}),h=A(t),m=Y("div",{class:c,tabindex:!wt(t)&&!l&&0});f.mask=m;var _=Y("div",{class:c+"__options"}),g=i.options;e(g)&&(g=g.call(f,null),r(g,Promise)&&g.then((function(t){pt(f,t,_),f.fire("load",[t,null])}))),r(g,Promise)||pt(f,g,_);var k,x,w=Y("div",{class:c+"__values"}),C=Y("span",{class:c+"__"+(l?"text":"value")}),P=Y("span",{contenteditable:!(wt(t)||zt(t)||!l)&&"",spellcheck:!!l&&"false"}),j=Y("span",l?t.placeholder+"":"");K(m,w),K(m,_),K(w,C),K(w,v),l?(nt("blur",P,jt),nt("cut",P,Mt),nt("focus",P,Ht),nt("keydown",P,It),nt("paste",P,Jt),K(C,P),K(C,j),Lt(P,f)):(nt("blur",m,Pt),nt("focus",m,Nt),nt("keydown",m,Ut)),B(t,c+"__self"),x=m,O(k=t).insertBefore(x,T(k,!0)),h&&(nt("reset",h,Zt),nt("submit",h,en),Lt(h,f)),nt("focus",t,Dt),nt("mousedown",y,$t),nt("mousedown",m,Vt),nt("mousemove",y,qt),nt("mouseup",y,Qt),nt("resize",b,tn),nt("scroll",b,nn),nt("touchend",y,Qt),nt("touchmove",y,qt,{passive:!1}),nt("touchstart",y,$t),nt("touchstart",m,Vt),t.tabIndex=-1,Lt(m,f);var M,N={};if(N.arrow=v,N.hint=l?j:null,N.input=l?P:null,N.of=t,N.options=_,N.root=y,N.self=m,N[l?"text":"value"]=C,f._mask=N,f.size=null!=(o=i.size)?o:l?1:t.size,(M=f._options[f._value]||(l?0:p(f._options).find((function(t){return!wt(t._[0])}))))&&(I(M._[0],"selected",""),l?(F(P,S(M)),S(P,!1)&&F(j,"")):(U(C,"value",z(M,"value",!1)),J(C,E(M)))),a(i)&&n(i.with))for(var R=0,D=d(i.with);R<D;++R){var H=i.with[R];s(H)&&(H=Ot[H]),e(H)?H.call(f,t,i):u(H)&&e(H.attach)&&H.attach.call(f,t,i)}return f},At.blur=function(){rn();var t=this,n=t._mask,e=t.mask;return(n.input||e).blur(),t.exit()},At.detach=function(){var t,r=this,i=r._mask,o=r.mask,a=r.self,f=r.state,l=i.input,c=A(a);if(r._active=!1,r._value=yt(a)||null,c&&(Q("reset",c,Zt),Q("submit",c,en)),l&&(Q("blur",l,jt),Q("blur",o,Pt),Q("cut",l,Mt),Q("focus",l,Ht),Q("focus",o,Nt),Q("keydown",l,It),Q("keydown",o,Ut),Q("paste",l,Jt)),Q("focus",a,Dt),Q("mousedown",y,$t),Q("mousedown",o,Vt),Q("mousemove",y,qt),Q("mouseup",y,Qt),Q("resize",b,tn),Q("scroll",b,nn),Q("touchend",y,Qt),Q("touchmove",y,qt),Q("touchstart",y,$t),Q("touchstart",o,Vt),n(f.with))for(var v=0,p=d(f.with);v<p;++v){var h=f.with[v];s(h)&&(h=Ot[h]),u(h)&&e(h.detach)&&h.detach.call(r,a,f)}return a.tabIndex=null,D(a,f.n+"__self"),O(t=o),t.remove(),r._mask={of:a},r.mask=null,r},At.enter=function(t){var n,e=this,r=e._mask,i=e._options,o=e.mask,u=e.self,a=e.state,s=r.input,f=a.n;B(o,f+"--focus"),B(o,f+"--focus-option"),B(o,f+="--open");var l=kt(y);return l&&e!==l&&l.exit(),Lt(y,e),Lt(b,e),e.fire("enter"),t&&(e.fire("focus"),"input"===L(u)?(mt(s),on(s)):(n=i[yt(u)])&&mt(n),e.fire("focus.option")),e},At.exit=function(t){var n=this,e=n._mask,r=n.mask,i=n.self,o=n.state,u=e.input,a=o.n;return D(r,a+"--focus"),D(r,a+"--focus-option"),D(r,a+="--open"),n.fire("exit"),t&&("input"===L(i)?(mt(u),on(u)):mt(r),n.fire("focus").fire("focus.self")),n},At.fit=function(){var t=this,n=t._mask,e=t.mask,r=n.options;if(z(e,"size"))return t;var i=P(e,"border-bottom-width"),o=P(e,"border-top-width"),u=q(e),a=q(b);return u[1]+u[3]/2>a[3]/2?W(r,{bottom:"100%","max-height":"calc("+u[1]+"px + "+i+")",top:"auto"}):W(r,{bottom:"auto","max-height":"calc("+(a[3]-u[1]-u[3])+"px + "+o+")",top:"100%"}),t},At.focus=function(t){var n=this,e=n._mask,r=n.mask,i=e.input;return i?(mt(i),on(i,t),n):(mt(r),n)},Ot}));