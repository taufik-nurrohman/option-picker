/*!
 *
 * The MIT License (MIT)
 *
 * Copyright © 2025 Taufik Nurrohman <https://github.com/taufik-nurrohman>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the “Software”), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).OptionPicker=e()}(this,(function(){"use strict";function t(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function e(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=i(t))||t&&"number"==typeof t.length){n&&(t=n);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function n(e,n,r){if(n&&!Array.isArray(n)&&"number"==typeof n.length){var i=n.length;return t(n,r<i?r:i)}return e(n,r)}function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,u,o,a=[],l=!0,s=!1;try{if(u=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=u.call(n)).done)&&(a.push(r.value),a.length!==e);l=!0);}catch(t){s=!0,i=t}finally{try{if(!l&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(s)throw i}}return a}}(t,e)||i(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,n){if(e){if("string"==typeof e)return t(e,n);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(e,n):void 0}}var u=function(t,e){return-1!==e.indexOf(t)},o=function(t){return Array.isArray(t)},a=function(t){return f(t)&&0!=t%1},l=function(t){return"function"==typeof t},s=function(t,e,n){return!(!t||"object"!=typeof t)&&(n?d(e)&&d(t.constructor)&&e===t.constructor:d(e)&&t instanceof e)},c=function(t){return f(t)&&0==t%1},f=function(t){return"number"==typeof t},v=function(t,e){return void 0===e&&(e=!0),!(!t||"object"!=typeof t)&&(!e||s(t,Object,1))},d=function(t){return function(t){return void 0!==t}(t)&&!function(t){return null===t}(t)},p=function(t){return"string"==typeof t},h=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=e.shift(),i=0,a=y(e);i<a;++i)for(var l in e[i])if(d(r[l]))if(o(r[l])&&o(e[i][l])){r[l]=[].concat(r[l]);for(var s=0,c=y(e[i][l]);s<c;++s)u(e[i][l][s],r[l])||r[l].push(e[i][l][s])}else v(r[l])&&v(e[i][l])?r[l]=h({},r[l],e[i][l]):r[l]=e[i][l];else r[l]=e[i][l];return r},m=function(t){if(o(t))return t.map((function(e){return m(t)}));if(v(t)){for(var e in t)t[e]=m(t[e]);return t}return!1===t?"false":null===t?"null":!0===t?"true":""+t},_=function(t){return t.replace(/[-_.](\w)/g,(function(t,e){return g(e)}))},b=function(t){return t.toLowerCase()},g=function(t){return t.toUpperCase()},y=function(t){return t.length},x=function(t){return t.size},k=function(t){if(o(t))return t.map((function(t){return k(t)}));if(v(t)){for(var e in t)t[e]=k(t[e]);return t}return p(t)&&function(t){return/^[+-]?(?:\d*\.)?\d+$/.test(t+"")}(t)?"0"===t[0]&&-1===t.indexOf(".")?t:function(t,e){return void 0===e&&(e=10),e?parseInt(t,e):parseFloat(t)}(t):"false"!==t&&("null"===t?null:"true"===t||t)},w=function(t,e){for(var n,r=0,i=y(t);r<i;++r)if(-1!==(n=e(t[r],r))){if(0===n)break}else t.splice(r,1);return t},A=function(t,i){for(var u,o=e(t);!(u=o()).done;){var a=n(r,u.value,2),l=a[0],s=a[1];if(-1!==(s=i(s,l))){if(0===s)break}else j(l,t)}return t},S=function(t,e){var n;for(var r in t)if(-1!==(n=e(t[r],r))){if(0===n)break}else delete t[r];return t},z=function(t,i){for(var u,o=e(t.entries());!(u=o()).done;){var a=n(r,u.value,2),l=a[0],s=a[1];if(-1!==(s=i(s,l))){if(0===s)break}else j(l,t)}return t},T=function(t){return t.prototype},O=function(t){return E(t,R)||null},E=function(t,e){return e.get(t)},L=function(t,e){return e.has(t)},C=function(t){return j(t,R)},j=function(t,e){return e.delete(t)},P=function(t,e,n){return n||(t=T(t)),S(e,(function(e,n){Object.defineProperty(t,n,e)})),t},I=function(t,e,n){return t=T(t),S(e,(function(e,n){t[n]=e})),t},N=function(t,e){return M(t,e,R)},M=function(t,e,n){return n.set(t,e)},D=function(t){var e=[];return A(t,(function(t){e.push(t)})),e},R=new WeakMap;var H=document,B=window,K=H.body,U=H.documentElement,Y=function(t,e,n){return void 0===n&&(n=!0),F(t,"aria-"+e,n)},F=function(t,e,n){if(void 0===n&&(n=!0),!ct(t,e))return null;var r=t.getAttribute(e);return n?k(r):r},J=function(t,e){return t["first"+(e?"":"Element")+"Child"]||null},V=function(t,e){return t["last"+(e?"":"Element")+"Child"]||null},W=function(t,e,n){var r,i=(r=t["child"+(n?"Nodes":"ren")],Array.from(r));return f(e)?i[e]||null:i},$=function(t,e,n){void 0===n&&(n=!0);var r=F(t,"data-"+e,n),i=(r+"").trim();return n&&i&&("["===i[0]&&"]"===i.slice(-1)||"{"===i[0]&&"}"===i.slice(-1))&&null!==(i=function(t){var e=null;try{e=JSON.parse(t)}catch(t){}return e}(r))?i:r},q=function(t,e){return(e||H).querySelector(t)},X=function(t,e){if(!t||!et(t))return-1;for(var n=0;t=rt(t,e);)++n;return n},G=function(t,e){void 0===e&&(e=!0);var n="innerHTML";if(!dt(t,n))return!1;var r=t[n];return""!==(r=e?r.trim():r)?r:null},Q=function(t,e){return void 0===e&&(e="e:"),vt(t)?F(t,"id"):(d(Ht[e])||(Ht[e]=0),e+(n=Date.now()+(Ht[e]+=1),r=16,f(n)?n.toString(r):""+n));var n,r},Z=function(t){return b(t&&t.nodeName||"")||null},tt=function(t,e){return t["next"+(e?"":"Element")+"Sibling"]||null},et=function(t,e){return e?t.closest(e)||null:t.parentNode||null},nt=function(t){var e="form";return dt(t,e)&&e===Z(t[e])?t[e]:et(t,e)},rt=function(t,e){return t["previous"+(e?"":"Element")+"Sibling"]||null},it=function(t){return F(t,"role")},ut=function(t,e,n){var r=B.getComputedStyle(t).getPropertyValue(e);return r||""===r||0===r?r:null},ot=function(t,e){return dt(t,e)&&t[e]||null},at=function(t,e){void 0===e&&(e=!0);var n="textContent";if(!dt(t,n))return!1;var r=t[n];return""!==(r=e?r.trim():r)?r:null},lt=function(t){return t&&t.nodeType||null},st=function(t,e){var n=(t.value||"").replace(/\r?\n|\r/g,"\n");return""!==n?n:null},ct=function(t,e){return t.hasAttribute(e)},ft=function(t,e){return ct(t,"data-"+e)},vt=function(t){return ct(t,"id")},dt=function(t,e){return e in t},pt=function(t){return t.disabled},ht=function(t){return t.readOnly},mt=function(t,e){return _t(t,"aria-"+e)},_t=function(t,e){return t.removeAttribute(e),t},bt=function(t,e){return t.classList.remove(e),t},gt=function(t,e){return _t(t,"data-"+e)},yt=function(t){var e=et(t);return t.remove(),e},xt=function(t,e){return t.style[_(e)]=null,t},kt=function(t,e,n){return wt(t,"aria-"+e,!0===n?"true":n)},wt=function(t,e,n){return!0===n&&(n=e),t.setAttribute(e,m(n)),t},At=function(t,e){return S(e,(function(e,n){return"aria"===n&&v(e)?(function(t,e){S(e,(function(e,n){e||""===e||0===e?kt(t,n,e):mt(t,n)}))}(t,e),1):"class"===n?(Tt(t,e),1):"data"===n&&v(e)?(Ot(t,e),1):"style"===n&&v(e)?(Mt(t,e),1):void(e||""===e||0===e?wt(t,n,e):_t(t,n))})),t},St=function(t,e){return t.append(e),e},zt=function(t,e){return t.classList.add(e),t},Tt=function(t,e){return o(e)?(w(e,(function(e){return zt(t,e)})),t):v(e)?(S(e,(function(e,n){return e?zt(t,n):bt(t,n)})),t):(t.className=e,t)},Ot=function(t,e){return S(e,(function(e,n){e||""===e||0===e?Et(t,n,e):gt(t,n)})),t},Et=function(t,e,n){return(o(n)||v(n))&&(n=JSON.stringify(n)),wt(t,"data-"+e,!0===n?"true":n)},Lt=function(t,e,n,r){return t=p(t)?H.createElement(t,p(r)?{is:r}:r):t,o(e)&&y(e)?(!function(t){var e="innerHTML";dt(t,e)&&(t[e]="")}(t),w(e,(function(t){return St(p(t)?Ct(t):t)}))):v(e)&&(n=e,e=!1),p(e)&&jt(t,e),v(n)?(At(t,n),t):t},Ct=function(t){return p(t)&&(t=H.createTextNode(t)),t},jt=function(t,e,n){if(void 0===n&&(n=!0),null===e)return t;var r="innerHTML";return dt(t,r)&&(t[r]=n?e.trim():e),t},Pt=function(t,e,n){return void 0===n&&(n="e:"),wt(t,"id",d(e)?e:Q(t,n))},It=function(t,e){return et(t).insertBefore(e,tt(t,!0)),e},Nt=function(t,e,n){return f(n)&&(n+="px"),t.style[_(e)]=m(n),t},Mt=function(t,e){return S(e,(function(e,n){e||""===e||0===e?Nt(t,n,e):xt(t,n)})),t},Dt=function(t,e,n){if(void 0===n&&(n=!0),null===e)return t;var r="textContent";return dt(t,r)&&(t[r]=n?e.trim():e),t},Rt=function(t,e){return null===e?_t(t,"value"):(t.value=m(e),t)},Ht={},Bt=function(t,e){var n;return function(){var r=arguments,i=this;n&&clearTimeout(n),n=setTimeout((function(){return t.apply(i,r)}),e)}},Kt=function(t,e){return function(){var n=arguments,r=this;setTimeout((function(){return t.apply(r,n)}),e)}},Ut=function(){return H.getSelection()},Yt=function(){return H.createRange()},Ft=function(t,e){return(e=e||Ut()).empty(),e},Jt=function(t,e,n){var r=0,i=Yt();i.setStart(t,0),i.collapse(!0);for(var u,o,a,l=[t];!u&&(a=l.pop());)if(3===lt(a)){var s=r+y(a);!o&&e[0]>=r&&e[0]<=s&&(i.setStart(a,e[0]-r),o=!0),o&&e[1]>=r&&e[1]<=s&&(u=!0,i.setEnd(a,e[1]-r)),r=s}else w(W(a,null,1),(function(t){return l.push(t)}));return $t(t,i,Ft(0,n))},Vt=function(t,e,n){n=n||Ut(),Ft(0,n);var r=Yt();r.selectNodeContents(t),n=$t(t,r,n),1===e?n.collapseToEnd():-1===e&&n.collapseToStart()},Wt=function(t){return(t=t||Ut()).rangeCount&&t.removeRange(t.getRangeAt(0)),t},$t=function(t,e,n){return n=n||Ut(),o(e)?Jt(t,e,n):(n.addRange(e),n)},qt=function(t){var e,n,r,i,u,o,a;return!function(t){return t===B}(t)?(i=(n=t.getBoundingClientRect()).left,u=n.top,r=n.width,e=n.height,o=n.right,a=n.bottom):(i=t.pageXOffset||U.scrollLeft||K.scrollLeft,u=t.pageYOffset||U.scrollTop||K.scrollTop,r=t.innerWidth,e=t.innerHeight),[i,u,r,e,o,a]};var Xt=function(t,e,n){e.removeEventListener(t,n)},Gt=function(t){return t&&t.preventDefault()},Qt=function(t){return t&&t.stopPropagation()},Zt=function(t,e,n,r){void 0===r&&(r=!1),e.addEventListener(t,n,r)},te="ArrowDown",ee="ArrowUp",ne="Backspace",re="Delete",ie="Enter",ue="Escape",oe="PageDown",ae="PageUp",le="Tab",se=Bt((function(t,e,n,r){var i,o=p(e)?e:at(e)||"",a=b(o),c=t._mask,f=t.mask,v=t.state,d=c.options,h=v.strict,m=$(f,"size"),_=n.count();if(r)A(n,(function(e){var n=b(at(e[2])+"\t"+_e(e[2]));if(""!==a&&a===n.slice(0,y(a))&&!Y(e[2],"disabled"))return Xe(e[2],t),m&&qe(e[2]),0;--_}));else{A(n,(function(t){var e=b(at(t[2])+"\t"+_e(t[2]));""===a||u(a,e)?t[2].hidden=!1:(t[2].hidden=!0,--_)})),d.hidden=!_;var g,x=st(self);h?(Qe(t),_&&(i=xe(t))?(kt(i,"selected",!0),i._[0].selected=!0,Rt(self,g=_e(i))):Rt(self,g="")):Rt(self,g=o),x!==g&&t.fire("change",[""!==g?g:null])}t.fire("search",[o=""!==o?o:null]);var k=v.options;0===_&&l(k)&&(kt(f,"busy",!0),k=k.call(t,o),s(k,Promise)?k.then((function(e){fe(t,e,d),mt(f,"busy"),t.fire("load",[o,t.values])[xe(t)?"enter":"exit"]().fit()})):fe(t,k,d))}),10),ce="OptionPicker";function fe(t,e,n){var r=s(e,Map)?e:new Map;return o(e)?w(e,(function(t){var e,n,i;o(t)?(t[0]=null!=(e=t[0])?e:"",t[1]=null!=(n=t[1])?n:{},M(k(null!=(i=t[1].value)?i:t[0]),t,r)):M(k(t),[t,{}],r)})):v(e,0)&&S(e,(function(t,n){var i,u,a;o(t)?(e[n][0]=null!=(i=t[0])?i:"",e[n][1]=null!=(u=t[1])?u:{},M(k(null!=(a=t[1].value)?a:n),t,r)):M(k(n),[t,{}],r)})),function(t,e,n){var r,i,u=[],a=t._options,s=t.self,c=t.state;c.n;var f=st(s);if(ke(s)?!(r=s.list)||W(r):W(r=s),a.delete(null,0,0),A(n,(function(t,e){var n,r;o(t)&&t[1]&&!t[1].disabled&&t[1].selected&&u.push(k(null!=(r=t[1].value)?r:e)),a.set(k(o(t)&&t[1]&&null!=(n=t[1].value)?n:e),t,0)})),l(c.options)||(c.options=n),0===y(u)){if(L(i=k(f),n))return[i];if(i=me(t))return[_e(i,1)]}return u}(t,0,r)}function ve(t){return t.focus(),t}function de(t,e){if(t)return ve(t),t}function pe(t,e){var n;if(n=xe(t,e))return de(n)}function he(t){return pe(t,"Last")}function me(t,e){var n,r=t._options,i=t.self;return A(r,(function(t,e){if(o(t)&&t[2]&&!Y(t[2],"disabled")&&Y(t[2],"selected"))return n=t[2],0})),d(n)||!e&&ke(i)||A(r,(function(t,e){return n=t[2],0})),n}function _e(t,e){return $(t,"value",e)}function be(t,e){return t.map((function(t){return _e(t,e)}))}function ge(t){var e,n,r,i=new Map,u=[],o=st(t);return n=ke(t)?(r=t.list)?W(r):[]:W(r=t),w(n,(function(t,e){var n=function(t,e){void 0===e&&(e=!0);var n=t.attributes,r={};return w(n,(function(t){var n=t.name,i=t.value;r[n]=e?k(i):i})),r}(t);w(["disabled","selected"],(function(t){dt(n,t)?(n[t]=""===n[t]||n[t],"selected"===t&&u.push(1)):n[t]=null})),"optgroup"===Z(t)?A(ge(t),(function(e,n){e[1]["&"]=t.label,M(k(n),e,i)})):M(k(t.value),[at(t)||t.value,n,null,t],i)})),0===y(u)&&(e=E(o=k(o),i))&&(e[1].selected=!0,M(o,e,i)),i}function ye(t){var e=t._options,n=[];return A(e,(function(t,e){o(t)&&t[2]&&!Y(t[2],"disabled")&&Y(t[2],"selected")&&n.push(t[2])})),n}function xe(t,e){var n,r=t._options;if(n=D(r)["find"+(e||"")]((function(t){return!Y(t[2],"disabled")&&!t[2].hidden})))return n[2]}function ke(t){return"input"===Z(t)}function we(t){var e,n=O(this),r=n._mask,i=n.state,u=r.options;i.strict&&(!u.hidden&&(e=me(n,1))?Xe(e,n):(u.hidden=!1,Qe(n,1)))}function Ae(t){var e,n=this,r=O(n),i=r._mask,u=r.self,o=r.strict,a=i.hint,l=st(u);Kt((function(){at(n,0)?Nt(a,"color","transparent"):xt(a,"color"),o||l!==(e=at(n))&&(Rt(u,e),r.fire("change",[""!==e?e:null]))}),1)()}function Se(t){Wt()}function ze(t){O(this).focus()}function Te(t){var e=this,n=O(e);at(e,0)?Vt(e):n.enter().fit()}var Oe="";function Ee(t){var e,n=this,r=t.key,i=O(n),u=i._mask,o=i._options,a=i.mask,l=i.self,s=i.state,c=u.hint,f=s.strict;if(i._event=t,Kt((function(){return at(n,0)?Nt(c,"color","transparent"):xt(c,"color")}),1)(),ne!==r&&re!==r&&1!==y(r)||Kt((function(){return i.enter().fit()}),11)(),te===r||ee===r||ie===r){var v=E(k(st(l)),o.values);if(!(v=v?v[2]:0)||v.hidden)for(v=(v=D(o).shift())?v[2]:0;v&&(Y(v,"disabled")||v.hidden);)v=tt(v);e=!0,Y(a,"expanded")?f&&ie===r?Ge(i)&&i.exit(e):v&&ve(v):(i.enter(e),v&&ve(v))}else le===r?i.exit():Kt((function(){""!==Oe&&Oe===at(n)+""||(se(i,n,o),Oe=at(n)+"")}),1)();e&&(Gt(t),Qt(t))}var Le="",Ce=Bt((function(){return Le=""}),500);function je(t){var e,n,r,i,u,o=this,a=t.key,l=t.altKey,s=t.ctrlKey,c=O(o),f=c._mask,v=c._options,d=c.self,p=f.hint,h=f.value;if(c._event=t,ne===a||re===a)e=!0,(u=q('[data-value="'+_e(o).replace(/"/g,'\\"')+'"]',et(h)))?ve(u):c.exit(e);else if(ie===a||ue===a||le===a||" "===a)c.max>1?ue===a?c.exit(e=!0):le===a?c.exit(e=!1):Ze(o,c):(ue!==a&&Xe(o,c),c.exit(e=le!==a));else if(te===a||oe===a){for(e=!0,n=oe===a&&"group"===it(r=et(o))?tt(r):tt(o);n&&(Y(n,"disabled")||n.hidden);)n=tt(n);for(n?"group"===it(n)&&(n=J(n)):((r=et(o))&&"group"===it(r)&&(n=tt(r)),n&&"group"===it(n)&&(n=J(n)));n&&(Y(n,"disabled")||n.hidden);)n=tt(n);n?de(n):pe(c)}else if(ee===a||ae===a){for(e=!0,i=ae===a&&"group"===it(r=et(o))?rt(r):rt(o);i&&(Y(i,"disabled")||i.hidden);)i=rt(i);for(i?"group"===it(i)&&(i=V(i)):((r=et(o))&&"group"===it(r)&&(i=rt(r)),i&&"group"===it(i)&&(i=V(i)));i&&(Y(i,"disabled")||i.hidden);)i=rt(i);i?de(i):he(c)}else"Home"===a?(e=!0,pe(c)):"End"===a?(e=!0,he(c)):s&&"a"===a&&!ke(d)&&c.max>1?(e=!0,A(v,(function(t,e){Y(t[2],"disabled")||t[2].hidden||(mt(u=t[2],"selected"),t[3].selected=!1,Ze(u,c))})),u&&ve(u)):s||(1!==y(a)||l||(ke(d)?Nt(p,"color","transparent"):Le+=a),c.exit(!(e=!1)));e&&(Gt(t),Qt(t))}function Pe(t){var e,n,r,i,u=this,o=t.key,a=t.altKey,s=t.ctrlKey,c=O(u),f=c._mask,v=c._options,d=c.self,p=f.options,h=f.value,m=f.values,_=c.max,b=c.min;if(Ce(),pt(d)||ke(d)&&ht(d))return Gt(t);if(c._event=t,!Y(u,"selected")||ne!==o&&re!==o){if(ne===o){Le="";var g=x(m);b<g?(n=E(_e(u,1),v.values))&&(mt(n[2],"selected"),n[3].selected=!1,(i=rt(u))&&ft(i,"value")||(i=tt(u))&&ft(i,"value")?(ve(f.value=i),Xt("keydown",u,Pe),Xt("mousedown",u,Ie),Xt("touchstart",u,Ie),j(u,m),yt(u)):(gt(f.value=u,"value"),jt(u,""))):c.fire("min.options",[g,b]),_!==1/0&&_>g&&A(v,(function(t,e){t[3].disabled||(mt(t[2],"disabled"),wt(t[2],"tabindex",0))}))}else if(re===o){Le="";var k=x(m);b<k?(n=E(_e(u,1),v.values))&&(mt(n[2],"selected"),n[3].selected=!1,(r=tt(u))&&ft(r,"value")||(r=rt(u))&&ft(r,"value")?(ve(f.value=r),Xt("keydown",u,Pe),Xt("mousedown",u,Ie),Xt("touchstart",u,Ie),j(u,m),yt(u)):(gt(f.value=u,"value"),jt(u,""))):c.fire("min.options",[k,b]),_!==1/0&&_>k&&A(v,(function(t,e){t[3].disabled||(mt(t[2],"disabled"),wt(t[2],"tabindex",0))}))}else if(ue===o)Le="",c.exit(e=!0);else if(le===o)Le="",c.exit(e=!1);else if(te===o||ee===o||ie===o||oe===o||ae===o||""===Le&&" "===o){var w=e=!0;(ie===o||""===Le&&" "===o)&&(n=E(_e(u,1),v.values))&&(w=!1,l(p.getAnimations)?Promise.all(p.getAnimations().map((function(t){return t.finished}))).then((function(){return ve(n[2])}),qe(n[2])):(ve(n[2]),qe(n[2]))),c.enter(w).fit()}else if("ArrowLeft"===o)e=!0,(i=rt(u))&&ft(i,"value")&&ve(i);else if("ArrowRight"===o)e=!0,(r=tt(u))&&ft(r,"value")&&ve(r);else if(1===y(o)&&!a)if(s&&"a"===o&&_>1){for(kt(n=h,"selected",!0);(r=tt(n))&&ft(r,"value");)kt(n=r,"selected",!0);for(;(i=rt(n))&&ft(i,"value");)kt(n=i,"selected",!0)}else Le+=o}else if(Le="",b===x(m))c.fire("min.options",[b,b]);else{var S=0;z(m,(function(t){b>S?((n=E(_e(t,1),v.values))&&b<1&&(mt(n[2],"selected"),n[3].selected=!1,gt(t,"value"),jt(t,"")),ve(f.value=t)):((n=E(_e(t,1),v.values))&&(mt(n[2],"selected"),n[3].selected=!1),Xt("keydown",t,Pe),Xt("mousedown",t,Ie),Xt("touchstart",t,Ie),j(t,m),yt(t)),++S}))}""!==Le&&se(c,Le,v,e=!0),e&&Gt(t)}function Ie(t){Gt(t);var e=O(this),n=e._mask;n.value;var r=n.values,i=e.max;e._event=t,z(r,(function(t){return mt(t,"selected")})),i>1&&x(r)>1&&(e.exit(),ve(this),Qt(t))}function Ne(t){Gt(t);var e=this,n=O(e)._mask.hint;Kt((function(){return at(e,0)?Nt(n,"color","transparent"):xt(n,"color")}),1)(),function(t,e,n,r){var i,u,a;if((r=r||Ut()).rangeCount){var l,s,c;if((u=r.getRangeAt(0)).deleteContents(),a=H.createDocumentFragment(),p(e))for(i=Lt("div"),jt(i,e);l=J(i,1);)c=St(a,l);else o(e)?w(e,(function(t){return c=St(a,t)})):c=St(a,e);s=J(a,1),u.insertNode(a),c&&((u=u.cloneRange()).setStartAfter(c),u.setStartBefore(s),$t(t,u,Wt(r)))}}(e,t.clipboardData.getData("text/plain"))}var Me=0,De=!1,Re=0;function He(t){Gt(t);var e=O(this),n=e._options,r=e.self,i=t.target;e._event=t,pt(r)||ht(r)||$(this,"size")||"listbox"===it(i)||et(i,"[role=listbox]")||(A(n,(function(t){return t[2].hidden=!1})),e[O(U)!==e?"enter":"exit"](!0).fit())}function Be(t){ve(this),O(this)._event=t,Me=1}function Ke(t){var e=O(this);if(e){"touchstart"===t.type&&(De=t.touches[0].clientY);var n=e.mask,r=e.state.n,i=t.target;e._event=t,n!==i&&n!==et(i,"."+r)&&($(n,"size")?e.blur():(C(this),e.exit()))}}function Ue(t){var e,n=O(this);if(n){n._event=t;var r=n._mask.lot;if(1===Me&&++Me,"touchmove"===t.type&&!1!==De){Re=t.touches[0].clientY;var i=[(e=r).scrollLeft,e.scrollTop];i[1]-=Re-De,function(t,e){t.scrollLeft=e[0],t.scrollTop=e[1]}(r,i),De=Re}}}function Ye(t){var e=this,n=O(e);n._event=t,Me>1||Y(e,"disabled")||(n.max>1?Ze(e,n):(Xe(e,n),n.exit(!0))),Me=0}function Fe(){Me=0,De=!1}function Je(t){O(this).reset()._event=t}function Ve(t){var e=O(this),n=y(ye(e)),r=e.max,i=e.min;n<i?(e.fire("min.options",[n,i]),Gt(t)):n>r&&(e.fire("max.options",[n,r]),Gt(t))}function We(t){var e=O(U);e&&(e.fit()._event=t)}function $e(t){We(t)}function qe(t){t.scrollIntoView({block:"nearest"})}function Xe(t,e){var n=e._mask,r=e.self,i=n.hint,u=n.input,o=n.value;if(t){var a,l=st(r);return Qe(e),kt(t,"selected",!0),wt(t._[0],"selected",""),Rt(r,a=_e(t)),t._[0].selected=!0,ke(r)?(kt(u,"activedescendant",Q(t)),Nt(i,"color","transparent"),Dt(u,at(t))):(Et(o,"value",a),jt(o,G(t))),l!==a&&e.fire("change",[""!==a?a:null]),t}}function Ge(t,e){var n;if(n=xe(t,e))return Xe(n,t)}function Qe(t,e){var n=t._mask,r=t._options,i=t.self,u=n.hint,o=n.input,a=n.value;A(r,(function(t){mt(t[2],"selected"),t[3].selected=!1})),e&&(Rt(i,""),ke(i)?(mt(o,"activedescendant"),xt(u,"color"),Dt(o,"")):(gt(a,"value"),jt(a,"")))}function Ze(t,e){var n,r,i,u,o=e._mask,a=e._options,l=e.self,s=e.state,c=o.value,f=o.values,v=s.max,d=s.min;if(t){var p,h,m=be(ye(e));return Y(t,"selected")?d>0&&(h=y(m))<=d?e.fire("min.options",[h,d]):(mt(t,"selected"),t._[0].selected=!1):(kt(t,"selected",!0),wt(t._[0],"selected",""),t._[0].selected=!0),ke(l)||(p=be(ye(e)),v!==1/0&&(h=y(p))===v?(A(a,(function(t,e){Y(t[2],"selected")||(_t(t[2],"tabindex"),kt(t[2],"disabled",!0))})),e.fire("max.options",[h,v])):A(a,(function(t,e){t[3].disabled||(mt(t[2],"disabled"),wt(t[2],"tabindex",0))})),(r=(n=ye(e)).shift())&&(Et(c,"value",_e(r)),jt(c,G(r)),j(c,f),z(f,(function(t){return Xt("keydown",t,Pe),Xt("mousedown",t,Ie),Xt("touchstart",t,Ie),C(t),yt(t),-1})),f.add(i=c),w(n,(function(t,n){var r;(u=Pt((r=c.cloneNode(!0),_t(r,"id")))).tabIndex=-1,Zt("keydown",u,Pe),Zt("mousedown",u,Ie),Zt("touchstart",u,Ie),mt(u,"selected"),Et(u,"value",_e(t)),jt(u,G(t)),N(u,e),f.add(It(i,u)),i=u})))),m.sort().join("\n")!==p.sort().join("\n")&&e.fire("change",[p]),t}}function tn(t,e){var n,r=this;return t?s(r,tn)?(N(t,function(t,e){return(e=e||t).fire=function(t,e,n){var r=this,i=r.hooks;return d(i[t])?(w(i[t],(function(t){t.apply(n||r,e)})),r):r},e.off=function(t,e){var n=this,r=n.hooks;if(!d(t))return r={},n;if(d(r[t]))if(d(e)){var i=y(r[t]);if(0===i)delete r[t];else for(var u=0;u<i;++u)if(e===r[t][u]){r[t].splice(u,1);break}}else delete r[t];return n},e.on=function(t,e){var n=this.hooks;return d(n[t])||(n[t]=[]),d(e)&&n[t].push(e),this},t.hooks={},t}(r,tn._)),r.attach(t,h({},tn.state,!1===(n=e)||!0===n?{strict:e}:e||{}))):new tn(t,e):r}function en(t,e){var n=this;return s(n,en)?(n.of=t,n.values=new Map,e&&fe(t,e,t._mask.options),n):new en(t,e)}return tn.from=function(t,e){return new tn(t,e)},tn.of=O,tn.state={max:null,min:null,n:"option-picker",options:null,size:null,strict:!1,with:[]},tn.version="2.0.0",P(tn,{name:{value:ce}},1),P(tn,{active:{get:function(){return this._active},set:function(t){var e=this,n=e.self,r=!!t;return e._active=r,n.disabled=!r,e.detach().attach()}},fix:{get:function(){return this._fix},set:function(t){var e=this,n=e._active,r=e.self,i=!!t;return n&&ke(r)?(e._fix=i,r.readOnly=!i,e.detach().attach()):e}},max:{get:function(){var t=this.self,e=this.state;return!ke(t)&&t.multiple?e.max:1},set:function(t){var e=this,n=e._active,r=e.mask,i=e.self,u=e.state;return!n||ke(i)||((t=(1/0===t||c(t))&&t>1?t:1)>1?(kt(r,"multiselectable",i.multiple=!0),u.max=t):(mt(r,"multiselectable"),i.multiple=!1,u.max=t)),e}},min:{get:function(){var t=this.state.min;return!c(t)||t<0?0:t},set:function(t){var e=this,n=e._active,r=e.state;return n?(r.min=c(t)&&t>0?t:0,e):e}},options:{get:function(){return this._options},set:function(t){var e,n=this,r=n._active,i=n._mask;if(n._options,n.self,!r)return n;(a(t)||c(t)||p(t))&&(t=[t]),y(e=fe(n,t,i.options))&&(n.value=n._value=e[0],n.values=n._values=e,n.fire("change",[n["value"+(n.max>1?"s":"")]]));var u=[];return A(n._options,(function(t){return u.push(_e(t[2]))})),n.fire("set.options",[u])}},size:{get:function(){var t,e,n=this.self,r=this.state;return ke(n)?null:(e=null!=(t=n.size)?t:r.size||1,!c(e)||e<1?1:e)},set:function(t){var e=this,n=e._active,r=e._mask,i=e.mask,u=e.self,o=e.state,a=r.options,l=!c(t)||t<1?1:t;if(!n||ke(u))return e;if(u.size=o.size=l,1===l)gt(i,"size"),xt(a,"max-height"),C(U);else{var s=xe(e);if(s){var f,v,d=ut(a,"gap"),p=ut(a,"padding-bottom"),h=null!=(f=null!=(v=ut(s,"height"))?v:ut(s,"min-height"))?f:ut(s,"line-height");Et(i,"size",l),Nt(a,"max-height","calc(("+h+" + max("+d+","+p+"))*"+l+")"),N(U,e)}}return e}},text:{get:function(){var t=this._mask,e=t.input;return t.text?at(e):null},set:function(t){var e,n=this,r=n._active,i=n._mask,u=i.hint,o=i.input,a=i.text;return r&&a?(Dt(o,e=m(t)),e?Nt(u,"color","transparent"):xt(u,"color"),n):n}},value:{get:function(){var t=st(this.self);return""!==t?t:null},set:function(t){var e,n=this,r=n._active,i=n._options;return r?((e=E(k(t),i.values))&&Xe(e[2],n),n):n}},values:{get:function(){return be(ye(this))},set:function(t){var e,n=this,r=n._active,i=n._options;return!r||n.max<2||(Qe(n),(a(t)||c(t)||p(t))&&(t=[t]),o(t)&&w(t,(function(t){(e=E(k(t),i.values))&&Ze(e[2],n)}))),n}}}),tn._=I(tn,{attach:function(t,e){var n,r=this;t=t||r.self,e=e||r.state,r._event=null,r._options=new en(r),r._value=null,r._values=[],r.self=t,r.state=e;var i=e,u=i.max,a=i.min,c=i.n,f=pt(t),h=ke(t),m=u&&u>1||!h&&t.multiple,_=ht(t);r._active=!f&&!_,r._fix=h&&_;var b=Lt("span",{class:c+"__arrow",role:"none"}),g=nt(t),x=Lt("div",{aria:{disabled:!!pt(t)&&"true",expanded:"false",haspopup:"listbox",multiselectable:!!m&&"true",readonly:!(!h||!_)&&"true"},class:c,role:"combobox"});r.mask=x;var k=Lt("div",{class:c+"__flex",role:"group"}),A=Lt("div",{class:c+"__options",role:"listbox"}),S=Lt("div",{class:c+"__options-lot",role:"none"}),z=Lt("span",{class:c+"__"+(h?"text":"value"),tabindex:!h&&0}),T=Lt("span",{aria:{autocomplete:"list",disabled:!!f&&"true",multiline:"false",placeholder:!!h&&t.placeholder,readonly:!!_&&"true"},autocapitalize:"off",contenteditable:!(f||_||!h)&&"",role:"searchbox",spellcheck:!!h&&"false",tabindex:!(!_||!h)&&0}),O=Lt("span",h?t.placeholder+"":"",{role:"none"});St(x,k),St(x,A),St(A,S),St(k,z),St(k,b),h?(Zt("blur",T,we),Zt("cut",T,Ae),Zt("focus",T,Te),Zt("keydown",T,Ee),Zt("paste",T,Ne),St(z,T),St(z,O),N(T,r)):(Zt("keydown",z,Pe),Zt("mousedown",z,Ie),Zt("touchstart",z,Ie),N(z,r)),zt(t,c+"__self"),It(t,x),g&&(Zt("reset",g,Je),Zt("submit",g,Ve),Pt(g),N(g,r)),Zt("focus",t,ze),Zt("mousedown",U,Ke),Zt("mousedown",x,He),Zt("mousemove",U,Ue),Zt("mouseup",U,Fe),Zt("resize",B,We,{passive:!0}),Zt("scroll",B,$e,{passive:!0}),Zt("touchend",U,Fe),Zt("touchmove",U,Ue,{passive:!0}),Zt("touchstart",U,Ke),Zt("touchstart",x,He),t.tabIndex=-1,N(x,r);var E={};E.arrow=b,E.flex=k,E.hint=h?O:null,E.input=h?T:null,E.lot=S,E.of=t,E.options=A,E.self=x,E.values=new Set,E[h?"text":"value"]=z,h||E.values.add(z),r._mask=E,r.max=m?null!=u?u:1/0:1,r.min=h?0:null!=a?a:1,r.size=null!=(n=e.size)?n:h?1:t.size;var L,C=r._active,j=e.options;return r._active=!0,l(j)?(kt(x,"busy","true"),j=j.call(r,null),s(j,Promise)?j.then((function(t){mt(x,"busy"),y(L=fe(r,t))?(r.value=r._value=L[0],r.values=r._values=L):(L=me(r,1))&&(r.value=r._value=L=_e(L),r.values=r._values=[L]),r.fire("load",[null,r.values])[r.options.open?"enter":"exit"]().fit()})):y(L=fe(r,j))&&(r.value=r._value=L[0],r.values=r._values=L)):y(L=fe(r,j||ge(t)))&&(r.value=r._value=L[0],r.values=r._values=L),r._active=C,kt(x,"controls",Q(Pt(A))),kt(x,"labelledby",Q(Pt(z))),kt(t,"hidden",!0),kt(T,"controls",Q(A)),Pt(b),Pt(x),Pt(k),Pt(S),Pt(t),Pt(T),Pt(O),d(e)&&o(e.with)&&w(e.with,(function(n,i){p(n)&&(n=tn[n]),l(n)?n.call(r,t,e):v(n)&&l(n.attach)&&n.attach.call(r,t,e)})),r},blur:function(){var t=this,e=t._mask,n=t.mask,r=e.input;return r&&Wt(),(r||n).blur(),t.exit()},detach:function(){var t=this,e=t._mask,n=t.mask,r=t.self,i=t.state,u=e.input;e.options;var a=e.value,s=nt(r);return t._active=!1,t._options=new en(t),t._value=null,t._values=[],s&&(Xt("reset",s,Je),Xt("submit",s,Ve)),u&&(Xt("blur",u,we),Xt("cut",u,Ae),Xt("focus",u,Te),Xt("keydown",u,Ee),Xt("paste",u,Ne)),a&&Xt("keydown",a,Pe),Xt("focus",r,ze),Xt("mousedown",U,Ke),Xt("mousedown",n,He),Xt("mousemove",U,Ue),Xt("mouseup",U,Fe),Xt("resize",B,We),Xt("scroll",B,$e),Xt("touchend",U,Fe),Xt("touchmove",U,Ue),Xt("touchstart",U,Ke),Xt("touchstart",n,He),o(i.with)&&w(i.with,(function(e,n){p(e)&&(e=tn[e]),v(e)&&l(e.detach)&&e.detach.call(t,r,i)})),r.tabIndex=null,mt(r,"hidden"),bt(r,i.n+"__self"),yt(n),t._mask={of:r},t.mask=null,t},enter:function(t,e){var n,r=this,i=r._active,u=r._mask,o=r._options,a=r.mask,s=r.self,c=u.input,f=u.lot,v=u.options,d=u.values;if(!i)return r;kt(a,"expanded",y(W(f))>0);var p=O(U);return p&&r!==p&&p.exit(),N(U,r),z(d,(function(t){return mt(t,"selected")})),r.fire("enter"),t&&(ke(s)?(ve(c),Vt(c,e)):(n=E(k(st(s)),o.values))?l(v.getAnimations)?Promise.all(v.getAnimations().map((function(t){return t.finished}))).then((function(){return ve(n[2])}),qe(n[2])):(ve(n[2]),qe(n[2])):(n=xe(r))&&(l(v.getAnimations)?Promise.all(v.getAnimations().map((function(t){return t.finished}))).then((function(){return ve(n)}),qe(n)):(ve(n),qe(n)))),r},exit:function(t,e){var n=this,r=n._active,i=n._mask,u=n._options,o=n.mask,a=n.self,l=i.input,s=i.value;return r?(A(u,(function(t){return t[2].hidden=!1})),kt(o,"expanded",!1),C(U),n.fire("exit"),t&&(ke(a)?(ve(l),Vt(l,e)):ve(s)),n):n},fit:function(){var t=this,e=t._active,n=t._mask,r=t.mask,i=n.options;if(!e||!Y(r,"expanded")||$(r,"size"))return t;Nt(i,"max-height",0);var u=ut(r,"border-bottom-width"),o=ut(r,"border-top-width"),a=qt(r),l=qt(B);return a[1]+a[3]/2>l[3]/2?Mt(i,{bottom:"100%","max-height":"calc("+a[1]+"px + "+u+")",top:"auto"}):Mt(i,{bottom:"auto","max-height":"calc("+(l[3]-a[1]-a[3])+"px + "+o+")",top:"100%"}),t.fire("fit")},focus:function(t){var e=this._mask,n=e.input,r=e.value;return n?(ve(n),Vt(n,t)):ve(r),this},reset:function(t,e){var n=this,r=n._active,i=n._value;return n._values,r?(picker.max>1||(n.value=i),t?n.focus(e):n):n}}),P(en,{name:{value:ce+"Options"}},1),P(en,{open:{get:function(){var t=this.of.mask;return Y(t,"expanded")}}}),I(en,{at:function(t){return E(k(t),this.values)},count:function(){return this.values.size},delete:function(t,e,n){void 0===e&&(e=1),void 0===n&&(n=1);var r,i=this,u=i.of,o=i.values,a=u._active,s=u._mask,c=u.self,f=u.state,v=s.lot,p=s.options;if(!a)return!1;if(!d(t))return A(o,(function(t,e){return i.let(e,0)})),Qe(u,e),p.hidden=!0,n&&u.fire("let.options",[[]])&&0===i.count();if(!(r=E(t=k(t),o)))return n&&u.fire("not.option",[t]),!1;var h=et(r[2]),m=et(r[3]),_=_e(r[2]),b=u.value;return Xt("focus",r[2],Se),Xt("keydown",r[2],je),Xt("mousedown",r[2],Be),Xt("mouseup",r[2],Ye),Xt("touchend",r[2],Ye),Xt("touchstart",r[2],Be),yt(r[2]),yt(r[3]),r=j(t,o),h&&"group"===it(h)&&0===y(W(h))&&yt(h),m&&"optgroup"===Z(m)&&0===y(W(m))&&yt(m),0===y(W(v))?(Qe(u,!ke(c)),p.hidden=!0):(Rt(c,""),_===b&&Ge(u)),l(f.options)||(f.options=o),n&&u.fire("let.option",[t]),r},get:function(t){var e,n=this.values,r=E(k(t),n);return r&&(e=et(r[2]))&&"group"===it(e)?[X(r[2]),X(e)]:r?X(r[2]):-1},has:function(t){return L(k(t),this.values)},let:function(t,e){return void 0===e&&(e=1),this.delete(t,1,e)},set:function(t,e,n){var r,i,u;void 0===n&&(n=1);var o=this,s=o.of,f=o.values;if(!s._active)return!1;if(o.has(t=k(t)))return n&&s.fire("has.option",[t]),!1;var h,_,b,g,y,x,w,A,S,z=s._mask,T=s.self,O=s.state,E=z.lot,L=z.options,C=O.n;(C+="__option",ke(T)?!(_=T.list)||W(_):W(_=T),L.hidden=!1,Pt(_),d(e)?(a(e)||c(e)||p(e))&&(e=[e,{}]):e=[t,{}],dt(e[1],"&"))?(g=q("."+C+'s-batch[data-value="'+e[1]["&"].replace(/"/g,'\\"')+'"]',E))&&_e(g)===e[1]["&"]||(St(E,g=Lt("span",{class:C+"s-batch",data:{value:e[1]["&"]},role:"group",title:null!=(A=ot(e[1],"title"))&&A})),St(_,y=Lt("optgroup",{label:e[1]["&"],title:null!=(S=ot(e[1],"title"))&&S})),(h=ot(e[1],"class"))&&(Tt(g,h),Tt(y,h)),v(w=ot(e[1],"style"))?(Mt(g,w),Mt(y,w)):w&&(wt(g,"style",w),wt(y,"style",w)),Pt(g),Pt(y)):g=y=!1;var j=e[1],P=j.disabled,I=j.selected,D=j.value;return D=m(D||t),b=e[2]||Lt("span",m(e[0]),{aria:{disabled:!!P&&"true",selected:!!I&&"true"},class:C,data:{batch:null!=(r=ot(e[1],"&"))&&r,value:D},role:"option",tabindex:!P&&-1,title:null!=(i=ot(e[1],"title"))&&i}),x=e[3]||Lt("option",m(e[0]),{disabled:!!P&&"",selected:!!I&&"",title:null!=(u=ot(e[1],"title"))&&u,value:D}),(h=ot(e[1],"class"))&&(Tt(b,h),Tt(x,h)),v(w=ot(e[1],"style"))?(Mt(b,w),Mt(x,w)):w&&(wt(b,"style",w),wt(x,"style",w)),Pt(b),Pt(x),b._={},b._[0]=x,P||e[2]||(Zt("focus",b,Se),Zt("keydown",b,je),Zt("mousedown",b,Be),Zt("mouseup",b,Ye),Zt("touchend",b,Ye),Zt("touchstart",b,Be)),St(g||E,b),St(y||_,x),N(b,s),e[2]=b,e[3]=x,M(t,e,f),l(O.options)||(O.options=f),n&&s.fire("set.option",[t]),!0}}),T(en)[Symbol.iterator]=function(){return this.values[Symbol.iterator]()},tn.Options=en,tn}));