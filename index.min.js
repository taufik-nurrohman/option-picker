/*!
 *
 * The MIT License (MIT)
 *
 * Copyright © 2025 Taufik Nurrohman <https://github.com/taufik-nurrohman>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the “Software”), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).OptionPicker=e()}(this,(function(){"use strict";function t(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function e(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=i(t))||t&&"number"==typeof t.length){n&&(t=n);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function n(e,n,r){if(n&&!Array.isArray(n)&&"number"==typeof n.length){var i=n.length;return t(n,r<i?r:i)}return e(n,r)}function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,u,o,a=[],l=!0,s=!1;try{if(u=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=u.call(n)).done)&&(a.push(r.value),a.length!==e);l=!0);}catch(t){s=!0,i=t}finally{try{if(!l&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(s)throw i}}return a}}(t,e)||i(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,n){if(e){if("string"==typeof e)return t(e,n);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(e,n):void 0}}var u=function(t){return Array.isArray(t)},o=function(t){return c(t)&&0!=t%1},a=function(t){return"function"==typeof t},l=function(t,e,n){return!(!t||"object"!=typeof t)&&(n?v(e)&&v(t.constructor)&&e===t.constructor:v(e)&&t instanceof e)},s=function(t){return c(t)&&0==t%1},c=function(t){return"number"==typeof t},f=function(t,e){return void 0===e&&(e=!0),!(!t||"object"!=typeof t)&&(!e||l(t,Object,1))},v=function(t){return function(t){return void 0!==t}(t)&&!function(t){return null===t}(t)},d=function(t){return"string"==typeof t},p=function(t,e){return-1!==e.indexOf(t)},h=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=e.shift(),i=0,o=y(e);i<o;++i)for(var a in e[i])if(v(r[a]))if(u(r[a])&&u(e[i][a])){r[a]=[].concat(r[a]);for(var l=0,s=y(e[i][a]);l<s;++l)p(e[i][a][l],r[a])||r[a].push(e[i][a][l])}else f(r[a])&&f(e[i][a])?r[a]=h({},r[a],e[i][a]):r[a]=e[i][a];else r[a]=e[i][a];return r},m=function(t){if(u(t))return t.map((function(e){return m(t)}));if(f(t)){for(var e in t)t[e]=m(t[e]);return t}return!1===t?"false":null===t?"null":!0===t?"true":""+t},_=function(t){return t.replace(/[-_.](\w)/g,(function(t,e){return g(e)}))},b=function(t){return t.toLowerCase()},g=function(t){return t.toUpperCase()},y=function(t){return t.length},x=function(t){return t.size},k=function(t){if(u(t))return t.map((function(t){return k(t)}));if(f(t)){for(var e in t)t[e]=k(t[e]);return t}return d(t)&&function(t){return/^[+-]?(?:\d*\.)?\d+$/.test(t+"")}(t)?"0"===t[0]&&-1===t.indexOf(".")?t:function(t,e){return void 0===e&&(e=10),e?parseInt(t,e):parseFloat(t)}(t):"false"!==t&&("null"===t?null:"true"===t||t)},w=function(t,e){for(var n,r=0,i=y(t);r<i;++r)if(-1!==(n=e(t[r],r))){if(0===n)break}else t.splice(r,1);return t},A=function(t,i){for(var u,o=e(t);!(u=o()).done;){var a=n(r,u.value,2),l=a[0],s=a[1];if(-1!==(s=i(s,l))){if(0===s)break}else j(l,t)}return t},S=function(t,e){var n;for(var r in t)if(-1!==(n=e(t[r],r))){if(0===n)break}else delete t[r];return t},z=function(t,i){for(var u,o=e(t.entries());!(u=o()).done;){var a=n(r,u.value,2),l=a[0],s=a[1];if(-1!==(s=i(s,l))){if(0===s)break}else j(l,t)}return t},T=function(t){return t.prototype},O=function(t){return E(t,H)||null},E=function(t,e){return e.get(t)},L=function(t,e){return e.has(t)},C=function(t){return j(t,H)},j=function(t,e){return e.delete(t)},I=function(t,e){return a(t.getAnimations)?Promise.all(t.getAnimations().map((function(t){return t.finished}))).then(e):e(),t},N=function(t,e,n){return n||(t=T(t)),S(e,(function(e,n){Object.defineProperty(t,n,e)})),t},P=function(t,e,n){return t=T(t),S(e,(function(e,n){t[n]=e})),t},M=function(t,e){return D(t,e,H)},D=function(t,e,n){return n.set(t,e)},R=function(t){var e=[];return A(t,(function(t){e.push(t)})),e},H=new WeakMap;var K=document,B=window,U=K.body,Y=K.documentElement,F=function(t,e,n){return void 0===n&&(n=!0),J(t,"aria-"+e,n)},J=function(t,e,n){if(void 0===n&&(n=!0),!ft(t,e))return null;var r=t.getAttribute(e);return n?k(r):r},V=function(t,e){return t["first"+(e?"":"Element")+"Child"]||null},W=function(t,e){return t["last"+(e?"":"Element")+"Child"]||null},$=function(t,e,n){var r,i=(r=t["child"+(n?"Nodes":"ren")],Array.from(r));return c(e)?i[e]||null:i},q=function(t,e,n){void 0===n&&(n=!0);var r=J(t,"data-"+e,n),i=(r+"").trim();return n&&i&&("["===i[0]&&"]"===i.slice(-1)||"{"===i[0]&&"}"===i.slice(-1))&&null!==(i=function(t){var e=null;try{e=JSON.parse(t)}catch(t){}return e}(r))?i:r},X=function(t,e){return(e||K).querySelector(t)},G=function(t,e){if(!t||!nt(t))return-1;for(var n=0;t=it(t,e);)++n;return n},Q=function(t,e){void 0===e&&(e=!0);var n="innerHTML";if(!pt(t,n))return!1;var r=t[n];return""!==(r=e?r.trim():r)?r:null},Z=function(t,e){return void 0===e&&(e="e:"),dt(t)?J(t,"id"):(v(Kt[e])||(Kt[e]=0),e+(n=Date.now()+(Kt[e]+=1),r=16,c(n)?n.toString(r):""+n));var n,r},tt=function(t){return b(t&&t.nodeName||"")||null},et=function(t,e){return t["next"+(e?"":"Element")+"Sibling"]||null},nt=function(t,e){return e?t.closest(e)||null:t.parentNode||null},rt=function(t){var e="form";return pt(t,e)&&e===tt(t[e])?t[e]:nt(t,e)},it=function(t,e){return t["previous"+(e?"":"Element")+"Sibling"]||null},ut=function(t){return J(t,"role")},ot=function(t,e,n){var r=B.getComputedStyle(t).getPropertyValue(e);return r||""===r||0===r?r:null},at=function(t,e){return pt(t,e)&&t[e]||null},lt=function(t,e){void 0===e&&(e=!0);var n="textContent";if(!pt(t,n))return!1;var r=t[n];return""!==(r=e?r.trim():r)?r:null},st=function(t){return t&&t.nodeType||null},ct=function(t,e){var n=(t.value||"").replace(/\r?\n|\r/g,"\n");return""!==n?n:null},ft=function(t,e){return t.hasAttribute(e)},vt=function(t,e){return ft(t,"data-"+e)},dt=function(t){return ft(t,"id")},pt=function(t,e){return e in t},ht=function(t){return t.disabled},mt=function(t){return t.readOnly},_t=function(t,e){return bt(t,"aria-"+e)},bt=function(t,e){return t.removeAttribute(e),t},gt=function(t,e){return t.classList.remove(e),t},yt=function(t,e){return bt(t,"data-"+e)},xt=function(t){var e=nt(t);return t.remove(),e},kt=function(t,e){return t.style[_(e)]=null,t},wt=function(t,e,n){return At(t,"aria-"+e,!0===n?"true":n)},At=function(t,e,n){return!0===n&&(n=e),t.setAttribute(e,m(n)),t},St=function(t,e){return S(e,(function(e,n){return"aria"===n&&f(e)?(function(t,e){S(e,(function(e,n){e||""===e||0===e?wt(t,n,e):_t(t,n)}))}(t,e),1):"class"===n?(Ot(t,e),1):"data"===n&&f(e)?(Et(t,e),1):"style"===n&&f(e)?(Dt(t,e),1):void(e||""===e||0===e?At(t,n,e):bt(t,n))})),t},zt=function(t,e){return t.append(e),e},Tt=function(t,e){return t.classList.add(e),t},Ot=function(t,e){return u(e)?(w(e,(function(e){return Tt(t,e)})),t):f(e)?(S(e,(function(e,n){return e?Tt(t,n):gt(t,n)})),t):(t.className=e,t)},Et=function(t,e){return S(e,(function(e,n){e||""===e||0===e?Lt(t,n,e):yt(t,n)})),t},Lt=function(t,e,n){return(u(n)||f(n))&&(n=JSON.stringify(n)),At(t,"data-"+e,!0===n?"true":n)},Ct=function(t,e,n,r){return t=d(t)?K.createElement(t,d(r)?{is:r}:r):t,u(e)&&y(e)?(!function(t){var e="innerHTML";pt(t,e)&&(t[e]="")}(t),w(e,(function(t){return zt(d(t)?jt(t):t)}))):f(e)&&(n=e,e=!1),d(e)&&It(t,e),f(n)?(St(t,n),t):t},jt=function(t){return d(t)&&(t=K.createTextNode(t)),t},It=function(t,e,n){if(void 0===n&&(n=!0),null===e)return t;var r="innerHTML";return pt(t,r)&&(t[r]=n?e.trim():e),t},Nt=function(t,e,n){return void 0===n&&(n="e:"),At(t,"id",v(e)?e:Z(t,n))},Pt=function(t,e){return nt(t).insertBefore(e,et(t,!0)),e},Mt=function(t,e,n){return c(n)&&(n+="px"),t.style[_(e)]=m(n),t},Dt=function(t,e){return S(e,(function(e,n){e||""===e||0===e?Mt(t,n,e):kt(t,n)})),t},Rt=function(t,e,n){if(void 0===n&&(n=!0),null===e)return t;var r="textContent";return pt(t,r)&&(t[r]=n?e.trim():e),t},Ht=function(t,e){return null===e?bt(t,"value"):(t.value=m(e),t)},Kt={},Bt=function(t,e){var n;return function(){var r=arguments,i=this;n&&clearTimeout(n),n=setTimeout((function(){return t.apply(i,r)}),e)}},Ut=function(t,e){return function(){var n=arguments,r=this;setTimeout((function(){return t.apply(r,n)}),e)}},Yt=function(){return K.getSelection()},Ft=function(){return K.createRange()},Jt=function(t,e){return(e=e||Yt()).empty(),e},Vt=function(t,e,n){var r=0,i=Ft();i.setStart(t,0),i.collapse(!0);for(var u,o,a,l=[t];!u&&(a=l.pop());)if(3===st(a)){var s=r+y(a);!o&&e[0]>=r&&e[0]<=s&&(i.setStart(a,e[0]-r),o=!0),o&&e[1]>=r&&e[1]<=s&&(u=!0,i.setEnd(a,e[1]-r)),r=s}else w($(a,null,1),(function(t){return l.push(t)}));return qt(t,i,Jt(0,n))},Wt=function(t,e,n){n=n||Yt(),Jt(0,n);var r=Ft();r.selectNodeContents(t),n=qt(t,r,n),1===e?n.collapseToEnd():-1===e&&n.collapseToStart()},$t=function(t){return(t=t||Yt()).rangeCount&&t.removeRange(t.getRangeAt(0)),t},qt=function(t,e,n){return n=n||Yt(),u(e)?Vt(t,e,n):(n.addRange(e),n)},Xt=function(t){var e,n,r,i,u,o,a;return!function(t){return t===B}(t)?(i=(n=t.getBoundingClientRect()).left,u=n.top,r=n.width,e=n.height,o=n.right,a=n.bottom):(i=t.pageXOffset||Y.scrollLeft||U.scrollLeft,u=t.pageYOffset||Y.scrollTop||U.scrollTop,r=t.innerWidth,e=t.innerHeight),[i,u,r,e,o,a]};var Gt=function(t,e,n){e.removeEventListener(t,n)},Qt=function(t){return t&&t.preventDefault()},Zt=function(t){return t&&t.stopPropagation()},te=function(t,e,n,r){void 0===r&&(r=!1),e.addEventListener(t,n,r)},ee="ArrowDown",ne="ArrowUp",re="Backspace",ie="Delete",ue="Enter",oe="Escape",ae="PageDown",le="PageUp",se="Tab",ce=Bt((function(t,e,n,r){var i,u=d(e)?e:lt(e)||"",o=b(u),s=t._mask,c=t.mask,f=t.state,v=s.options,h=f.strict,m=q(c,"size"),_=n.count();if(r)A(n,(function(e){var n=b(lt(e[2])+"\t"+be(e[2]));if(""!==o&&o===n.slice(0,y(o))&&!F(e[2],"disabled"))return Ge(e[2],t),m&&Xe(e[2]),0;--_}));else{A(n,(function(t){var e=b(lt(t[2])+"\t"+be(t[2]));""===o||p(o,e)?t[2].hidden=!1:(t[2].hidden=!0,--_)})),v.hidden=!_;var g,x=ct(self);h?(Ze(t),_&&(i=ke(t))?(wt(i,"selected",!0),i._[0].selected=!0,Ht(self,g=be(i))):Ht(self,g="")):Ht(self,g=u),x!==g&&t.fire("change",[""!==g?g:null])}t.fire("search",[u=""!==u?u:null]);var k=f.options;0===_&&a(k)&&(wt(c,"busy",!0),k=k.call(t,u),l(k,Promise)?k.then((function(e){ve(t,e,v),_t(c,"busy"),t.fire("load",[u,t.values])[ke(t)?"enter":"exit"]().fit()})):ve(t,k,v))}),10),fe="OptionPicker";function ve(t,e,n){var r=l(e,Map)?e:new Map;return u(e)?w(e,(function(t){var e,n,i;u(t)?(t[0]=null!=(e=t[0])?e:"",t[1]=null!=(n=t[1])?n:{},D(k(null!=(i=t[1].value)?i:t[0]),t,r)):D(k(t),[t,{}],r)})):f(e,0)&&S(e,(function(t,n){var i,o,a;u(t)?(e[n][0]=null!=(i=t[0])?i:"",e[n][1]=null!=(o=t[1])?o:{},D(k(null!=(a=t[1].value)?a:n),t,r)):D(k(n),[t,{}],r)})),function(t,e,n){var r,i,o=[],l=t._options,s=t.self,c=t.state;c.n;var f=ct(s);if(we(s)?!(r=s.list)||$(r):$(r=s),l.delete(null,0,0),A(n,(function(t,e){var n,r;u(t)&&t[1]&&!t[1].disabled&&t[1].selected&&o.push(k(null!=(r=t[1].value)?r:e)),l.set(k(u(t)&&t[1]&&null!=(n=t[1].value)?n:e),t,0)})),a(c.options)||(c.options=n),0===y(o)){if(L(i=k(f),n))return[i];if(i=_e(t))return[be(i,1)]}return o}(t,0,r)}function de(t){return t.focus(),t}function pe(t,e){if(t)return de(t),t}function he(t,e){var n;if(n=ke(t,e))return pe(n)}function me(t){return he(t,"Last")}function _e(t,e){var n,r=t._options,i=t.self;return A(r,(function(t,e){if(u(t)&&t[2]&&!F(t[2],"disabled")&&F(t[2],"selected"))return n=t[2],0})),v(n)||!e&&we(i)||A(r,(function(t,e){return n=t[2],0})),n}function be(t,e){return q(t,"value",e)}function ge(t,e){return t.map((function(t){return be(t,e)}))}function ye(t){var e,n,r,i=new Map,u=[],o=ct(t);return n=we(t)?(r=t.list)?$(r):[]:$(r=t),w(n,(function(t,e){var n=function(t,e){void 0===e&&(e=!0);var n=t.attributes,r={};return w(n,(function(t){var n=t.name,i=t.value;r[n]=e?k(i):i})),r}(t);w(["disabled","selected"],(function(t){pt(n,t)?(n[t]=""===n[t]||n[t],"selected"===t&&u.push(1)):n[t]=null})),"optgroup"===tt(t)?A(ye(t),(function(e,n){e[1]["&"]=t.label,D(k(n),e,i)})):D(k(t.value),[lt(t)||t.value,n,null,t],i)})),0===y(u)&&(e=E(o=k(o),i))&&(e[1].selected=!0,D(o,e,i)),i}function xe(t){var e=t._options,n=[];return A(e,(function(t,e){u(t)&&t[2]&&!F(t[2],"disabled")&&F(t[2],"selected")&&n.push(t[2])})),n}function ke(t,e){var n,r=t._options;if(n=R(r)["find"+(e||"")]((function(t){return!F(t[2],"disabled")&&!t[2].hidden})))return n[2]}function we(t){return"input"===tt(t)}function Ae(t){var e,n=O(this),r=n._mask,i=n.state,u=r.options;i.strict&&(!u.hidden&&(e=_e(n,1))?Ge(e,n):(u.hidden=!1,Ze(n,1)))}function Se(t){var e,n=this,r=O(n),i=r._mask,u=r.self,o=r.strict,a=i.hint,l=ct(u);Ut((function(){lt(n,0)?Mt(a,"color","transparent"):kt(a,"color"),o||l!==(e=lt(n))&&(Ht(u,e),r.fire("change",[""!==e?e:null]))}),1)()}function ze(t){$t()}function Te(t){O(this).focus()}function Oe(t){var e=this,n=O(e);lt(e,0)?Wt(e):n.enter().fit()}var Ee="";function Le(t){var e,n=this,r=t.key,i=O(n),u=i._mask,o=i._options,a=i.mask,l=i.self,s=i.state,c=u.hint,f=s.strict;if(i._event=t,Ut((function(){return lt(n,0)?Mt(c,"color","transparent"):kt(c,"color")}),1)(),re!==r&&ie!==r&&1!==y(r)||Ut((function(){return i.enter().fit()}),11)(),ee===r||ne===r||ue===r){var v=E(k(ct(l)),o.values);if(!(v=v?v[2]:0)||v.hidden)for(v=(v=R(o).shift())?v[2]:0;v&&(F(v,"disabled")||v.hidden);)v=et(v);e=!0,F(a,"expanded")?f&&ue===r?Qe(i)&&i.exit(e):v&&de(v):(i.enter(e).fit(),v&&de(v))}else se===r?i.exit():Ut((function(){""!==Ee&&Ee===lt(n)+""||(ce(i,n,o),Ee=lt(n)+"")}),1)();e&&(Qt(t),Zt(t))}var Ce="",je=Bt((function(){return Ce=""}),500);function Ie(t){var e,n,r,i,u,o=this,a=t.key,l=t.altKey,s=t.ctrlKey,c=t.shiftKey,f=O(o),v=f._mask,d=f._options,p=f.self,h=v.hint,m=v.value;if(f._event=t,re===a||ie===a)e=!0,(u=X('[data-value="'+be(o).replace(/"/g,'\\"')+'"]',nt(m)))?de(u):f.exit(e);else if(ue===a||oe===a||se===a||" "===a)f.max>1?oe===a?f.exit(e=!0):se===a?f.exit(e=!1):tn(o,f):(oe!==a&&Ge(o,f),f.exit(e=se!==a));else if(ee===a||ae===a){for(e=!0,n=ae===a&&"group"===ut(r=nt(o))?et(r):et(o);n&&(F(n,"disabled")||n.hidden);)n=et(n);for(n?"group"===ut(n)&&(n=V(n)):((r=nt(o))&&"group"===ut(r)&&(n=et(r)),n&&"group"===ut(n)&&(n=V(n)));n&&(F(n,"disabled")||n.hidden);)n=et(n);c?n&&(F(n,"selected")||tn(n,f),pe(n)):n?pe(n):he(f)}else if(ne===a||le===a){for(e=!0,i=le===a&&"group"===ut(r=nt(o))?it(r):it(o);i&&(F(i,"disabled")||i.hidden);)i=it(i);for(i?"group"===ut(i)&&(i=W(i)):((r=nt(o))&&"group"===ut(r)&&(i=it(r)),i&&"group"===ut(i)&&(i=W(i)));i&&(F(i,"disabled")||i.hidden);)i=it(i);c?i&&(F(i,"selected")||tn(i,f),pe(i)):i?pe(i):me(f)}else"Home"===a?(e=!0,he(f)):"End"===a?(e=!0,me(f)):s&&"a"===a&&!we(p)&&f.max>1?(e=!0,A(d,(function(t,e){F(t[2],"disabled")||t[2].hidden||(_t(u=t[2],"selected"),t[3].selected=!1,tn(u,f))})),u&&de(u)):s||(1!==y(a)||l||(we(p)?Mt(h,"color","transparent"):Ce+=a),!c&&f.exit(!(e=!1)));e&&(Qt(t),Zt(t))}function Ne(t){var e,n,r,i,u=this,o=t.key,a=t.altKey,l=t.ctrlKey,s=O(u),c=s._mask,f=s._options,v=s.self,d=c.options,p=c.value,h=c.values,m=s.max,_=s.min;if(je(),ht(v)||we(v)&&mt(v))return Qt(t);if(s._event=t,!F(u,"selected")||re!==o&&ie!==o){if(re===o){Ce="";var b=x(h);_<b?(n=E(be(u,1),f.values))&&(_t(n[2],"selected"),n[3].selected=!1,(i=it(u))&&vt(i,"value")||(i=et(u))&&vt(i,"value")?(de(c.value=i),Gt("keydown",u,Ne),Gt("mousedown",u,Pe),Gt("touchstart",u,Pe),j(u,h),xt(u)):(yt(c.value=u,"value"),It(u,""))):s.fire("min.options",[b,_]),m!==1/0&&m>b&&A(f,(function(t,e){t[3].disabled||(_t(t[2],"disabled"),At(t[2],"tabindex",0))}))}else if(ie===o){Ce="";var g=x(h);_<g?(n=E(be(u,1),f.values))&&(_t(n[2],"selected"),n[3].selected=!1,(r=et(u))&&vt(r,"value")||(r=it(u))&&vt(r,"value")?(de(c.value=r),Gt("keydown",u,Ne),Gt("mousedown",u,Pe),Gt("touchstart",u,Pe),j(u,h),xt(u)):(yt(c.value=u,"value"),It(u,""))):s.fire("min.options",[g,_]),m!==1/0&&m>g&&A(f,(function(t,e){t[3].disabled||(_t(t[2],"disabled"),At(t[2],"tabindex",0))}))}else if(oe===o)Ce="",s.exit(e=!0);else if(se===o)Ce="",s.exit(e=!1);else if(ee===o||ne===o||ue===o||ae===o||le===o||""===Ce&&" "===o){var k=e=!0;(ue===o||""===Ce&&" "===o)&&(n=E(be(u,1),f.values))&&(k=!1,I(d,(function(){return de(n[2])}),Xe(n[2]))),s.enter(k).fit()}else if("ArrowLeft"===o)e=!0,(i=it(u))&&vt(i,"value")&&de(i);else if("ArrowRight"===o)e=!0,(r=et(u))&&vt(r,"value")&&de(r);else if(1===y(o)&&!a)if(l&&"a"===o&&m>1){for(wt(n=p,"selected",!0);(r=et(n))&&vt(r,"value");)wt(n=r,"selected",!0);for(;(i=it(n))&&vt(i,"value");)wt(n=i,"selected",!0)}else Ce+=o}else{if(Ce="",_===x(h))s.fire("min.options",[_,_]);else{var w=0;z(h,(function(t){_>w?((n=E(be(t,1),f.values))&&_<1&&(_t(n[2],"selected"),n[3].selected=!1,yt(t,"value"),It(t,"")),de(c.value=t)):((n=E(be(t,1),f.values))&&(_t(n[2],"selected"),n[3].selected=!1),Gt("keydown",t,Ne),Gt("mousedown",t,Pe),Gt("touchstart",t,Pe),j(t,h),xt(t)),++w}))}z(h,(function(t){return _t(t,"selected")}))}""!==Ce&&ce(s,Ce,f,e=!0),e&&Qt(t)}function Pe(t){Qt(t);var e=O(this),n=e._mask;n.value;var r=n.values,i=e.max;e._event=t,z(r,(function(t){return _t(t,"selected")})),i>1&&x(r)>1&&(e.exit(),de(this),Zt(t))}function Me(t){Qt(t);var e=this,n=O(e)._mask.hint;Ut((function(){return lt(e,0)?Mt(n,"color","transparent"):kt(n,"color")}),1)(),function(t,e,n,r){var i,o,a;if((r=r||Yt()).rangeCount){var l,s,c;if((o=r.getRangeAt(0)).deleteContents(),a=K.createDocumentFragment(),d(e))for(i=Ct("div"),It(i,e);l=V(i,1);)c=zt(a,l);else u(e)?w(e,(function(t){return c=zt(a,t)})):c=zt(a,e);s=V(a,1),o.insertNode(a),c&&((o=o.cloneRange()).setStartAfter(c),o.setStartBefore(s),qt(t,o,$t(r)))}}(e,t.clipboardData.getData("text/plain"))}var De=0,Re=!1,He=0;function Ke(t){Qt(t);var e=O(this),n=e._options,r=e.self,i=t.target;e._event=t,ht(r)||mt(r)||q(this,"size")||"listbox"===ut(i)||nt(i,"[role=listbox]")||(A(n,(function(t){return t[2].hidden=!1})),e[O(Y)!==e?"enter":"exit"](!0).fit())}function Be(t){var e=this;O(e)._event=t,"touchstart"!==t.type||F(e,"disabled")||wt(e,"selected",!0),De=1}function Ue(t){var e=O(this);if(e){"touchstart"===t.type&&(Re=t.touches[0].clientY);var n=e.mask,r=e.state.n,i=t.target;e._event=t,n!==i&&n!==nt(i,"."+r)&&(q(n,"size")?e.blur():(C(this),e.exit()))}}function Ye(t){var e,n=O(this);if(n){n._event=t;var r=n._mask.lot;if(1===De&&!1!==Re&&Re!==t.touches[0].clientY&&++De,"touchmove"===t.type&&!1!==Re){He=t.touches[0].clientY;var i=[(e=r).scrollLeft,e.scrollTop];i[1]-=He-Re,function(t,e){t.scrollLeft=e[0],t.scrollTop=e[1]}(r,i),Re=He}}}function Fe(t){var e=this,n=O(e);n._event=t,1===De?F(e,"disabled")||(n.max>1?tn(e,n):(Ge(e,n),n.exit(!0))):_t(e,"selected"),De=0}function Je(){De=0,Re=!1}function Ve(t){O(this).reset()._event=t}function We(t){var e=O(this),n=y(xe(e)),r=e.max,i=e.min;n<i?(e.fire("min.options",[n,i]),Qt(t)):n>r&&(e.fire("max.options",[n,r]),Qt(t))}function $e(t){var e=O(Y);e&&(e.fit()._event=t)}function qe(t){$e(t)}function Xe(t){t.scrollIntoView({block:"nearest"})}function Ge(t,e){var n=e._mask,r=e.self,i=n.hint,u=n.input,o=n.value;if(t){var a,l=ct(r);return Ze(e),wt(t,"selected",!0),At(t._[0],"selected",""),Ht(r,a=be(t)),t._[0].selected=!0,we(r)?(wt(u,"activedescendant",Z(t)),Mt(i,"color","transparent"),Rt(u,lt(t))):(Lt(o,"value",a),It(o,Q(t))),l!==a&&e.fire("change",[""!==a?a:null]),t}}function Qe(t,e){var n;if(n=ke(t,e))return Ge(n,t)}function Ze(t,e){var n=t._mask,r=t._options,i=t.self,u=n.hint,o=n.input,a=n.value;A(r,(function(t){_t(t[2],"selected"),t[3].selected=!1})),e&&(Ht(i,""),we(i)?(_t(o,"activedescendant"),kt(u,"color"),Rt(o,"")):(yt(a,"value"),It(a,"")))}function tn(t,e){var n,r,i,u,o=e._mask,a=e._options,l=e.self,s=e.state,c=o.value,f=o.values,v=s.max,d=s.min;if(t){var p,h,m=ge(xe(e));return F(t,"selected")?d>0&&(h=y(m))<=d?e.fire("min.options",[h,d]):(_t(t,"selected"),t._[0].selected=!1):(wt(t,"selected",!0),At(t._[0],"selected",""),t._[0].selected=!0),we(l)||(p=ge(xe(e)),v!==1/0&&(h=y(p))===v?(A(a,(function(t,e){F(t[2],"selected")||(bt(t[2],"tabindex"),wt(t[2],"disabled",!0))})),e.fire("max.options",[h,v])):A(a,(function(t,e){t[3].disabled||(_t(t[2],"disabled"),At(t[2],"tabindex",0))})),(r=(n=xe(e)).shift())&&(Lt(c,"value",be(r)),It(c,Q(r)),j(c,f),z(f,(function(t){return Gt("keydown",t,Ne),Gt("mousedown",t,Pe),Gt("touchstart",t,Pe),C(t),xt(t),-1})),f.add(i=c),w(n,(function(t,n){var r;(u=Nt((r=c.cloneNode(!0),bt(r,"id")))).tabIndex=-1,te("keydown",u,Ne),te("mousedown",u,Pe),te("touchstart",u,Pe),_t(u,"selected"),Lt(u,"value",be(t)),It(u,Q(t)),M(u,e),f.add(Pt(i,u)),i=u})))),m.sort().join("\n")!==p.sort().join("\n")&&e.fire("change",[p]),t}}function en(t,e){var n,r=this;return t?l(r,en)?(M(t,function(t,e){return(e=e||t).fire=function(t,e,n){var r=this,i=r.hooks;return v(i[t])?(w(i[t],(function(t){t.apply(n||r,e)})),r):r},e.off=function(t,e){var n=this,r=n.hooks;if(!v(t))return r={},n;if(v(r[t]))if(v(e)){var i=y(r[t]);if(0===i)delete r[t];else for(var u=0;u<i;++u)if(e===r[t][u]){r[t].splice(u,1);break}}else delete r[t];return n},e.on=function(t,e){var n=this.hooks;return v(n[t])||(n[t]=[]),v(e)&&n[t].push(e),this},t.hooks={},t}(r,en._)),r.attach(t,h({},en.state,!1===(n=e)||!0===n?{strict:e}:e||{}))):new en(t,e):r}function nn(t,e){var n=this;return l(n,nn)?(n.of=t,n.values=new Map,e&&ve(t,e,t._mask.options),n):new nn(t,e)}return en.from=function(t,e){return new en(t,e)},en.of=O,en.state={max:null,min:null,n:"option-picker",options:null,size:null,strict:!1,with:[]},en.version="2.0.0",N(en,{name:{value:fe}},1),N(en,{active:{get:function(){return this._active},set:function(t){var e=this,n=e.self,r=!!t;return e._active=r,n.disabled=!r,e.detach().attach()}},fix:{get:function(){return this._fix},set:function(t){var e=this,n=e._active,r=e.self,i=!!t;return n&&we(r)?(e._fix=i,r.readOnly=!i,e.detach().attach()):e}},max:{get:function(){var t=this.self,e=this.state;return!we(t)&&t.multiple?e.max:1},set:function(t){var e=this,n=e._active,r=e.mask,i=e.self,u=e.state;return!n||we(i)||((t=(1/0===t||s(t))&&t>1?t:1)>1?(wt(r,"multiselectable",i.multiple=!0),u.max=t):(_t(r,"multiselectable"),i.multiple=!1,u.max=t)),e}},min:{get:function(){var t=this.state.min;return!s(t)||t<0?0:t},set:function(t){var e=this,n=e._active,r=e.state;return n?(r.min=s(t)&&t>0?t:0,e):e}},options:{get:function(){return this._options},set:function(t){var e,n=this,r=n._active,i=n._mask;if(n._options,n.self,!r)return n;(o(t)||s(t)||d(t))&&(t=[t]),y(e=ve(n,t,i.options))&&(n.value=n._value=e[0],n.values=n._values=e,n.fire("change",[n["value"+(n.max>1?"s":"")]]));var u=[];return A(n._options,(function(t){return u.push(be(t[2]))})),n.fire("set.options",[u])}},size:{get:function(){var t,e,n=this.self,r=this.state;return we(n)?null:(e=null!=(t=n.size)?t:r.size||1,!s(e)||e<1?1:e)},set:function(t){var e=this,n=e._active,r=e._mask,i=e.mask,u=e.self,o=e.state,a=r.options,l=!s(t)||t<1?1:t;if(!n||we(u))return e;if(u.size=o.size=l,console.log(l),1===l)yt(i,"size"),kt(a,"max-height"),C(Y);else{var c=ke(e);if(c){var f,v,d=ot(a,"gap"),p=ot(a,"padding-bottom"),h=null!=(f=null!=(v=ot(c,"height"))?v:ot(c,"min-height"))?f:ot(c,"line-height");Lt(i,"size",l),Mt(a,"max-height","calc(("+h+" + max("+d+","+p+"))*"+l+")"),M(Y,e)}}return e}},text:{get:function(){var t=this._mask,e=t.input;return t.text?lt(e):null},set:function(t){var e,n=this,r=n._active,i=n._mask,u=i.hint,o=i.input,a=i.text;return r&&a?(Rt(o,e=m(t)),e?Mt(u,"color","transparent"):kt(u,"color"),n):n}},value:{get:function(){var t=ct(this.self);return""!==t?t:null},set:function(t){var e,n=this,r=n._active,i=n._options;return r?((e=E(k(t),i.values))&&Ge(e[2],n),n):n}},values:{get:function(){return ge(xe(this))},set:function(t){var e,n=this,r=n._active,i=n._options;return!r||n.max<2||(Ze(n),(o(t)||s(t)||d(t))&&(t=[t]),u(t)&&w(t,(function(t){(e=E(k(t),i.values))&&tn(e[2],n)}))),n}}}),en._=P(en,{attach:function(t,e){var n,r=this;t=t||r.self,e=e||r.state,r._event=null,r._options=new nn(r),r._value=null,r._values=[],r.self=t,r.state=e;var i=e,o=i.max,s=i.min,c=i.n,p=ht(t),h=we(t),m=o&&o>1||!h&&t.multiple,_=mt(t);r._active=!p&&!_,r._fix=h&&_;var b=Ct("span",{class:c+"__arrow",role:"none"}),g=rt(t),x=Ct("div",{aria:{disabled:!!ht(t)&&"true",expanded:"false",haspopup:"listbox",multiselectable:!!m&&"true",readonly:!(!h||!_)&&"true"},class:c,role:"combobox"});r.mask=x;var k=Ct("div",{class:c+"__flex",role:"group"}),A=Ct("div",{class:c+"__options",role:"listbox"}),S=Ct("div",{class:c+"__options-lot",role:"none"}),z=Ct("span",{class:c+"__"+(h?"text":"value"),tabindex:!h&&0}),T=Ct("span",{aria:{autocomplete:"list",disabled:!!p&&"true",multiline:"false",placeholder:!!h&&t.placeholder,readonly:!!_&&"true"},autocapitalize:"off",contenteditable:!(p||_||!h)&&"",role:"searchbox",spellcheck:!!h&&"false",tabindex:!(!_||!h)&&0}),O=Ct("span",h?t.placeholder+"":"",{role:"none"});zt(x,k),zt(x,A),zt(A,S),zt(k,z),zt(k,b),h?(te("blur",T,Ae),te("cut",T,Se),te("focus",T,Oe),te("keydown",T,Le),te("paste",T,Me),zt(z,T),zt(z,O),M(T,r)):(te("keydown",z,Ne),te("mousedown",z,Pe),te("touchstart",z,Pe),M(z,r)),Tt(t,c+"__self"),Pt(t,x),g&&(te("reset",g,Ve),te("submit",g,We),Nt(g),M(g,r)),te("focus",t,Te),te("mousedown",Y,Ue),te("mousedown",x,Ke),te("mousemove",Y,Ye),te("mouseup",Y,Je),te("resize",B,$e,{passive:!0}),te("scroll",B,qe,{passive:!0}),te("touchend",Y,Je),te("touchmove",Y,Ye,{passive:!0}),te("touchstart",Y,Ue),te("touchstart",x,Ke),t.tabIndex=-1,M(x,r);var E={};E.arrow=b,E.flex=k,E.hint=h?O:null,E.input=h?T:null,E.lot=S,E.of=t,E.options=A,E.self=x,E.values=new Set,E[h?"text":"value"]=z,h||E.values.add(z),r._mask=E,r.max=m?null!=o?o:1/0:1,r.min=h?0:null!=s?s:1;var L,C=r._active,j=e.options;return r._active=!0,a(j)?(wt(x,"busy","true"),j=j.call(r,null),l(j,Promise)?j.then((function(t){_t(x,"busy"),y(L=ve(r,t))?(r.value=r._value=L[0],r.values=r._values=L):(L=_e(r,1))&&(r.value=r._value=L=be(L),r.values=r._values=[L]),r.fire("load",[null,r.values])[r.options.open?"enter":"exit"]().fit()})):y(L=ve(r,j))&&(r.value=r._value=L[0],r.values=r._values=L)):y(L=ve(r,j||ye(t)))&&(r.value=r._value=L[0],r.values=r._values=L),r._active=C,r.size=null!=(n=e.size)?n:h?1:t.size,wt(x,"controls",Z(Nt(A))),wt(x,"labelledby",Z(Nt(z))),wt(t,"hidden",!0),wt(T,"controls",Z(A)),Nt(b),Nt(x),Nt(k),Nt(S),Nt(t),Nt(T),Nt(O),v(e)&&u(e.with)&&w(e.with,(function(n,i){d(n)&&(n=en[n]),a(n)?n.call(r,t,e):f(n)&&a(n.attach)&&n.attach.call(r,t,e)})),r},blur:function(){var t=this,e=t._mask,n=t.mask,r=e.input;return r&&$t(),(r||n).blur(),t.exit()},detach:function(){var t=this,e=t._mask,n=t.mask,r=t.self,i=t.state,o=e.input;e.options;var l=e.value,s=rt(r);return t._active=!1,t._options=new nn(t),t._value=null,t._values=[],s&&(Gt("reset",s,Ve),Gt("submit",s,We)),o&&(Gt("blur",o,Ae),Gt("cut",o,Se),Gt("focus",o,Oe),Gt("keydown",o,Le),Gt("paste",o,Me)),l&&Gt("keydown",l,Ne),Gt("focus",r,Te),Gt("mousedown",Y,Ue),Gt("mousedown",n,Ke),Gt("mousemove",Y,Ye),Gt("mouseup",Y,Je),Gt("resize",B,$e),Gt("scroll",B,qe),Gt("touchend",Y,Je),Gt("touchmove",Y,Ye),Gt("touchstart",Y,Ue),Gt("touchstart",n,Ke),u(i.with)&&w(i.with,(function(e,n){d(e)&&(e=en[e]),f(e)&&a(e.detach)&&e.detach.call(t,r,i)})),r.tabIndex=null,_t(r,"hidden"),gt(r,i.n+"__self"),xt(n),t._mask={of:r},t.mask=null,t},enter:function(t,e){var n,r=this,i=r._active,u=r._mask,o=r._options,a=r.mask,l=r.self,s=u.input,c=u.lot,f=u.options,v=u.values;if(!i)return r;wt(a,"expanded",y($(c))>0);var d=O(Y);return d&&r!==d&&d.exit(),M(Y,r),z(v,(function(t){return _t(t,"selected")})),r.fire("enter"),t&&(we(l)?(de(s),Wt(s,e)):(n=E(k(ct(l)),o.values))?I(f,(function(){return de(n[2])}),Xe(n[2])):(n=ke(r))&&I(f,(function(){return de(n)}),Xe(n))),r},exit:function(t,e){var n=this,r=n._active,i=n._mask,u=n._options,o=n.mask,a=n.self,l=i.input,s=i.value;return r?(A(u,(function(t){return t[2].hidden=!1})),wt(o,"expanded",!1),C(Y),n.fire("exit"),t&&(we(a)?(de(l),Wt(l,e)):de(s)),n):n},fit:function(){var t=this,e=t._active,n=t._mask,r=t.mask,i=n.options;if(!e||!F(r,"expanded")||q(r,"size"))return t;Mt(i,"max-height",0);var u=ot(r,"border-bottom-width"),o=ot(r,"border-top-width"),a=Xt(r),l=Xt(B);return a[1]+a[3]/2>l[3]/2?Dt(i,{bottom:"100%","max-height":"calc("+a[1]+"px + "+u+")",top:"auto"}):Dt(i,{bottom:"auto","max-height":"calc("+(l[3]-a[1]-a[3])+"px + "+o+")",top:"100%"}),t.fire("fit")},focus:function(t){var e=this._mask,n=e.input,r=e.value;return n?(de(n),Wt(n,t)):de(r),this},reset:function(t,e){var n=this,r=n._active,i=n._value;return n._values,r?(picker.max>1||(n.value=i),t?n.focus(e):n):n}}),N(nn,{name:{value:fe+"Options"}},1),N(nn,{open:{get:function(){var t=this.of.mask;return F(t,"expanded")}}}),P(nn,{at:function(t){return E(k(t),this.values)},count:function(){return this.values.size},delete:function(t,e,n){void 0===e&&(e=1),void 0===n&&(n=1);var r,i=this,u=i.of,o=i.values,l=u._active,s=u._mask,c=u.self,f=u.state,d=s.lot,p=s.options;if(!l)return!1;if(!v(t))return A(o,(function(t,e){return i.let(e,0)})),Ze(u,e),p.hidden=!0,n&&u.fire("let.options",[[]])&&0===i.count();if(!(r=E(t=k(t),o)))return n&&u.fire("not.option",[t]),!1;var h=nt(r[2]),m=nt(r[3]),_=be(r[2]),b=u.value;return Gt("focus",r[2],ze),Gt("keydown",r[2],Ie),Gt("mousedown",r[2],Be),Gt("mouseup",r[2],Fe),Gt("touchend",r[2],Fe),Gt("touchstart",r[2],Be),xt(r[2]),xt(r[3]),r=j(t,o),h&&"group"===ut(h)&&0===y($(h))&&xt(h),m&&"optgroup"===tt(m)&&0===y($(m))&&xt(m),0===y($(d))?(Ze(u,!we(c)),p.hidden=!0):(Ht(c,""),_===b&&Qe(u)),a(f.options)||(f.options=o),n&&u.fire("let.option",[t]),r},get:function(t){var e,n=this.values,r=E(k(t),n);return r&&(e=nt(r[2]))&&"group"===ut(e)?[G(r[2]),G(e)]:r?G(r[2]):-1},has:function(t){return L(k(t),this.values)},let:function(t,e){return void 0===e&&(e=1),this.delete(t,1,e)},set:function(t,e,n){var r,i,u;void 0===n&&(n=1);var l=this,c=l.of,p=l.values;if(!c._active)return!1;if(l.has(t=k(t)))return n&&c.fire("has.option",[t]),!1;var h,_,b,g,y,x,w,A,S,z=c._mask,T=c.self,O=c.state,E=z.lot,L=z.options,C=O.n;(C+="__option",we(T)?!(_=T.list)||$(_):$(_=T),L.hidden=!1,Nt(_),v(e)?(o(e)||s(e)||d(e))&&(e=[e,{}]):e=[t,{}],pt(e[1],"&"))?(g=X("."+C+'s-batch[data-value="'+e[1]["&"].replace(/"/g,'\\"')+'"]',E))&&be(g)===e[1]["&"]||(zt(E,g=Ct("span",{class:C+"s-batch",data:{value:e[1]["&"]},role:"group",title:null!=(A=at(e[1],"title"))&&A})),zt(_,y=Ct("optgroup",{label:e[1]["&"],title:null!=(S=at(e[1],"title"))&&S})),(h=at(e[1],"class"))&&(Ot(g,h),Ot(y,h)),f(w=at(e[1],"style"))?(Dt(g,w),Dt(y,w)):w&&(At(g,"style",w),At(y,"style",w)),Nt(g),Nt(y)):g=y=!1;var j=e[1],I=j.disabled,N=j.selected,P=j.value;return P=m(P||t),b=e[2]||Ct("span",m(e[0]),{aria:{disabled:!!I&&"true",selected:!!N&&"true"},class:C,data:{batch:null!=(r=at(e[1],"&"))&&r,value:P},role:"option",tabindex:!I&&-1,title:null!=(i=at(e[1],"title"))&&i}),x=e[3]||Ct("option",m(e[0]),{disabled:!!I&&"",selected:!!N&&"",title:null!=(u=at(e[1],"title"))&&u,value:P}),(h=at(e[1],"class"))&&(Ot(b,h),Ot(x,h)),f(w=at(e[1],"style"))?(Dt(b,w),Dt(x,w)):w&&(At(b,"style",w),At(x,"style",w)),Nt(b),Nt(x),b._={},b._[0]=x,I||e[2]||(te("focus",b,ze),te("keydown",b,Ie),te("mousedown",b,Be),te("mouseup",b,Fe),te("touchend",b,Fe),te("touchstart",b,Be)),zt(g||E,b),zt(y||_,x),M(b,c),e[2]=b,e[3]=x,D(t,e,p),a(O.options)||(O.options=p),n&&c.fire("set.option",[t]),!0}}),T(nn)[Symbol.iterator]=function(){return this.values[Symbol.iterator]()},en.Options=nn,en}));