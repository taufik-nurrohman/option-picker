/*!
 *
 * The MIT License (MIT)
 *
 * Copyright © 2025 Taufik Nurrohman <https://github.com/taufik-nurrohman>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the “Software”), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */
!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(t="undefined"!=typeof globalThis?globalThis:t||self).OptionPicker=n()}(this,(function(){"use strict";function t(t,n,e){return n&&function(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,u(r.key),r)}}(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function n(){return n="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,n,r){var i=function(t,n){for(;!{}.hasOwnProperty.call(t,n)&&null!==(t=e(t)););return t}(t,n);if(i){var o=Object.getOwnPropertyDescriptor(i,n);return o.get?o.get.call(arguments.length<3?t:r):o.value}},n.apply(null,arguments)}function e(t){return e=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},e(t)}function r(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(r=function(){return!!t})()}function i(t,n){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},i(t,n)}function o(t,r,i,o){var u=n(e(1&o?t.prototype:t),r,i);return 2&o&&"function"==typeof u?function(t){return u.apply(i,t)}:u}function u(t){var n=function(t,n){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,n);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return t+""}(t,"string");return"symbol"==typeof n?n:n+""}function a(t){var n="function"==typeof Map?new Map:void 0;return a=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(n){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(t))return n.get(t);n.set(t,o)}function o(){return function(t,n,e){if(r())return Reflect.construct.apply(null,arguments);var o=[null];o.push.apply(o,n);var u=new(t.bind.apply(t,o));return e&&i(u,e.prototype),u}(t,arguments,e(this).constructor)}return o.prototype=Object.create(t.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),i(o,t)},a(t)}var s=function(t,n){return-1!==n.indexOf(t)},f=function(t){return Array.isArray(t)},c=function(t){return d(t)&&0!=t%1},l=function(t){return"function"==typeof t},p=function(t,n,e){return!(!t||"object"!=typeof t)&&(e?_(n)&&_(t.constructor)&&n===t.constructor:_(n)&&t instanceof n)},v=function(t){return d(t)&&0==t%1},d=function(t){return"number"==typeof t},h=function(t,n){return void 0===n&&(n=!0),!(!t||"object"!=typeof t)&&(!n||p(t,Object,1))},_=function(t){return function(t){return void 0!==t}(t)&&!function(t){return null===t}(t)},m=function(t){return"string"==typeof t},b=function(t){return t.replace(/[-_.](\w)/g,(function(t,n){return y(n)}))},g=function(t){return t.toLowerCase()},y=function(t){return t.toUpperCase()},k=function(t){return t.length},w=function(t){if(f(t))return t.map((function(t){return w(t)}));if(function(t){return/^-?(?:\d*.)?\d+$/.test(t+"")}(t))return function(t,n){return void 0===n&&(n=10),n?parseInt(t,n):parseFloat(t)}(t);if(h(t)){for(var n in t)t[n]=w(t[n]);return t}return"false"!==t&&("null"===t?null:"true"===t||t)},x=function(){for(var t=arguments.length,n=Array(t),e=0;e<t;e++)n[e]=arguments[e];for(var r=n.shift(),i=0,o=k(n);i<o;++i)for(var u in n[i])if(_(r[u]))if(f(r[u])&&f(n[i][u])){r[u]=[].concat(r[u]);for(var a=0,c=k(n[i][u]);a<c;++a)s(n[i][u][a],r[u])||r[u].push(n[i][u][a])}else h(r[u])&&h(n[i][u])?r[u]=x({},r[u],n[i][u]):r[u]=n[i][u];else r[u]=n[i][u];return r},O=function(t){if(f(t))return t.map((function(n){return O(t)}));if(h(t)){for(var n in t)t[n]=O(t[n]);return t}return!1===t?"false":null===t?"null":!0===t?"true":""+t},P=document,z=window,j=P.body,E=P.documentElement,T=function(t){return t.firstElementChild||null},L=function(t){return t.lastElementChild||null},S=function(t,n){var e=[].slice.call(t.children);return d(n)?e[n]||null:e},A=function(t,n,e){void 0===e&&(e=!0);var r=function(t,n,e){if(void 0===e&&(e=!0),!K(t,n))return null;var r=t.getAttribute(n);return e?w(r):r}(t,"data-"+n,e),i=(r+"").trim();return e&&i&&("["===i[0]&&"]"===i.slice(-1)||"{"===i[0]&&"}"===i.slice(-1))&&null!==(i=function(t){var n=null;try{n=JSON.parse(t)}catch(t){}return n}(r))?i:r},C=function(t,n){void 0===n&&(n=!0);var e="innerHTML";if(!Y(t,e))return!1;var r=t[e];return""!==(r=n?r.trim():r)?r:null},R=function(t){return g(t&&t.nodeName||"")||null},M=function(t,n){return t["next"+(n?"":"Element")+"Sibling"]||null},B=function(t,n){return n?t.closest(n)||null:t.parentNode||null},D=function(t){var n="form";return Y(t,n)&&n===R(t[n])?t[n]:B(t,n)},N=function(t,n){return t["previous"+(n?"":"Element")+"Sibling"]||null},H=function(t,n,e){var r=z.getComputedStyle(t).getPropertyValue(n);return r||""===r||0===r?r:null},I=function(t,n){void 0===n&&(n=!0);var e="textContent";if(!Y(t,e))return!1;var r=t[e];return""!==(r=n?r.trim():r)?r:null},K=function(t,n){return t.hasAttribute(n)},U=function(t,n){return t.classList.contains(n)},Y=function(t,n){return n in t},F=function(t,n){return t.removeAttribute(n),t},J=function(t,n){return t.classList.remove(n),t},V=function(t){var n=B(t);return t.remove(),n},W=function(t,n){return t.style[b(n)]=null,t},q=function(t,n,e){return!0===e&&(e=n),t.setAttribute(n,O(e)),t},X=function(t,n){return t.append(n),n},$=function(t,n){return t.classList.add(n),t},G=function(t,n,e){return(f(e)||h(e))&&(e=JSON.stringify(e)),q(t,"data-"+n,e)},Q=function(t,n,e){return t=m(t)?P.createElement(t):t,h(n)&&(e=n,n=!1),m(n)&&Z(t,n),h(e)&&function(t,n){var e;for(var r in n)(e=n[r])||""===e||0===e?q(t,r,e):F(t,r)}(t,e),t},Z=function(t,n,e){if(void 0===e&&(e=!0),null===n)return t;var r="innerHTML";return Y(t,r)&&(t[r]=e?n.trim():n),t},tt=function(t,n,e){return d(e)&&(e+="px"),t.style[b(n)]=O(e),t},nt=function(t,n){var e;for(var r in n)(e=n[r])||""===e||0===e?tt(t,r,e):W(t,r);return t},et=function(t,n,e){if(void 0===e&&(e=!0),null===n)return t;var r="textContent";return Y(t,r)&&(t[r]=e?n.trim():n),t},rt=function(t,n){var e;return function(){var r=arguments,i=this;e&&clearTimeout(e),e=setTimeout((function(){return t.apply(i,r)}),n)}},it=function(t,n){return function(){var e=arguments,r=this;setTimeout((function(){return t.apply(r,e)}),n)}},ot=function(t){var n,e,r,i,o,u,a;return!function(t){return t===z}(t)?(i=(e=t.getBoundingClientRect()).left,o=e.top,r=e.width,n=e.height,u=e.right,a=e.bottom):(i=t.pageXOffset||E.scrollLeft||j.scrollLeft,o=t.pageYOffset||E.scrollTop||j.scrollTop,r=t.innerWidth,n=t.innerHeight),[i,o,r,n,u,a]},ut=function(t){return[t.scrollLeft,t.scrollTop]};var at=function(t,n,e){n.removeEventListener(t,e)},st=function(t){return t&&t.preventDefault()},ft=function(t){return t&&t.stopPropagation()},ct=function(t,n,e,r){void 0===r&&(r=!1),n.addEventListener(t,e,r)},lt="ArrowDown",pt="ArrowUp",vt="Backspace",dt="Delete",ht="Enter",_t="Escape",mt="PageDown",bt="PageUp",gt="Tab",yt=rt((function(t){return t.fit()}),10),kt=new WeakMap,wt=function(n){function e(t,e){var r;return(r=n.call(this,e)||this).picker=t||{},r}!function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&i(t,n)}(e,n);var r=e.prototype;return r.let=function(t){return this.picker._mask.options,!!this.get(t)&&o(e,"delete",this,3)([t])},r.set=function(t,n){var r,i,u,a,s,f,l=this.picker,p=l._mask,d=l.self,h=l.state,b=p.options,g=h.n;g+="__option","input"===R(d)?!(r=d.list)||S(r):S(r=d),_(n)?(c(n)||v(n)||m(n))&&(n=[n,{}]):n=[t,{}],"&"in n[1]?(f="."+g+'-group[data-value="'+n[1]["&"].replace(/"/g,'\\"')+'"]',(a=(b||P).querySelector(f))&&Et(a)===n[1]["&"]||(X(b,a=Q("span",{class:g+"-group","data-value":n[1]["&"]})),X(r,s=Q("optgroup",{label:n[1]["&"]})))):a=s=!1;var y=n[1],k=y.disabled,w=y.selected,x=y.value;return Ct(d)&&(k=!0),x=O(x||t),i=n[2]||Q("span",O(n[0]),{class:g+(k?" "+g+"--disabled":"")+(w?" "+g+"--selected":""),"data-group":"&"in n[1]&&n[1]["&"],"data-value":x,tabindex:!k&&-1}),u=n[3]||Q("option",O(n[0]),{disabled:!!k&&"",selected:!!w&&"",value:x}),i._={},i._[0]=u,k||n[2]||(ct("blur",i,Yt),ct("focus",i,Wt),ct("keydown",i,tn),ct("mousedown",i,on),ct("touchend",i,fn),ct("touchstart",i,on)),X(a||b,i),X(s||r,u),Bt(i,l),n[2]=i,n[3]=u,o(e,"set",this,3)([x,n])},t(e,[{key:"count",get:function(){return this.size}}])}(a(Map));function xt(t,n,e){var r=p(n,Map)?n:new Map;if(f(n))zt(n,(function(t){var n,e,i;f(t)?(t[0]=null!=(n=t[0])?n:"",t[1]=null!=(e=t[1])?e:{},Dt(O(null!=(i=t[1].value)?i:t[0]),t,r)):Dt(O(t),[t,{}],r)}));else if(h(n,0))for(var i in n){var o,u,a;if(f(n[i]))n[i][0]=null!=(o=n[i][0])?o:"",n[i][1]=null!=(u=n[i][1])?u:{},Dt(O(null!=(a=n[i][1].value)?a:i),n[i],r);else Dt(O(i),[n[i],{}],r)}!function(t,n,e){var r,i,o=t.self;t.state.n,r="input"===R(o)?(i=o.list)?S(i):[]:S(i=o);for(var u=0,a=k(r);u<a;++u){if("optgroup"===R(r[u]))for(var s=S(r[u]),f=0,c=k(s);f<c;++f)s[f]&&V(s[f]);r[u]&&V(r[u])}t._options=new wt(t,[]),Z(n,""),jt(e,(function(n,e){Dt(e,n,t._options)})),t.state.options=e}(t,e,r)}function Ot(t,n,e){Object.defineProperty(t,n,e)}function Pt(t){t.focus()}function zt(t,n){t.forEach(n)}function jt(t,n){zt(t,n)}function Et(t){return A(t,"value",!1)}function Tt(t){var n,e,r,i=new Map,o=[],u=St(t);e="input"===R(t)?(r=t.list)?S(r):[]:S(r=t);for(var a=function(t){var n=e[t],r=function(t,n){void 0===n&&(n=!0);for(var e,r=t.attributes,i={},o=0,u=r.length;o<u;++o)e=r[o].value,i[r[o].name]=n?w(e):e;return i}(n);if(zt(["disabled","selected"],(function(n){n in r?(r[n]=""===r[n]||r[n],"selected"===n&&o.push(t)):r[n]=null})),"optgroup"===R(n))return jt(Tt(n),(function(t,e){t[1]["&"]=n.label,Dt(O(e),t,i)})),1;Dt(O(n.value),[I(n)||n.value,r,null,n],i)},s=0,f=k(e);s<f;++s)a(s);return 0===k(o)&&(n=At(u=O(u),i))&&(n[1].selected=!0,Dt(u,n,i)),i}function Lt(t){return At(t,kt)||null}function St(t){return(t.value||"").replace(/\r/g,"")}function At(t,n){return n.get(t)}function Ct(t){return t.disabled}function Rt(t){return t.readOnly}function Mt(t){return function(t,n){return n.delete(t)}(t,kt)}function Bt(t,n){return Dt(t,n,kt)}function Dt(t,n,e){return e.set(t,n)}function Nt(t){var n=[];return jt(t,(function(t){return n.push(t)})),n}function Ht(t,n){var e=this;return t?p(e,Ht)?(Bt(t,function(t,n){return(n=n||t).fire=function(t,n,e){var r=this,i=r.hooks;return _(i[t])?(i[t].forEach((function(t){return t.apply(e||r,n)})),r):r},n.off=function(t,n){var e=this,r=e.hooks;if(!_(t))return r={},e;if(_(r[t]))if(_(n)){var i=r[t].length;if(0===i)delete r[t];else for(var o=0;o<i;++o)if(n===r[t][o]){r[t].splice(o,1);break}}else delete r[t];return e},n.on=function(t,n){var e=this.hooks;return _(e[t])||(e[t]=[]),_(n)&&e[t].push(n),this},t.hooks={},t}(e,Ht._)),e.attach(t,x({},Ht.state,n||{}))):new Ht(t,n):e}Ht.from=function(t,n){return new Ht(t,n)},Ht.of=Lt,Ht.state={n:"option-picker",options:null,size:null,strict:!1,with:[]},Ht.version="2.0.0",Ot(Ht,"name",{value:"OptionPicker"});var It=Ht._=Ht.prototype;Ot(It,"options",{get:function(){return this._options},set:function(t){var n=this,e=n._mask,r=n.state.n;r+="__option",(c(t)||v(t)||m(t))&&(t=[t]),xt(n,t,e.options);var i=Nt(n._options).find((function(t){return!t[2].hidden&&!U(t[2],r+"--disabled")}));i&&(n.value=Et(i[2]))}}),Ot(It,"size",{get:function(){var t=this.state.size||1;return v(t)?t<1?1:t:1},set:function(t){var n=this,e=n._mask,r=n._options,i=n.mask,o=n.state,u=e.options;o.n;var a=v(t)?t<1?1:t:1;if(n.state.size=a,1===a)F(i,"data-"+"size"),W(u,"max-height"),Mt(E);else{var s=Nt(r).find((function(t){return!t[2].hidden}));if(s){var f,c,l=H(u,"gap"),p=H(u,"padding-bottom"),d=null!=(f=null!=(c=H(s,"height"))?c:H(s,"min-height"))?f:H(s,"line-height");G(i,"size",a),tt(u,"max-height","calc(("+d+" + max("+l+","+p+"))*"+a+")"),Bt(E,n)}}}}),Ot(It,"text",{get:function(){var t=this._mask,n=t.input;return t.text?I(n):null},set:function(t){var n=this._mask,e=this.self,r=n.hint,i=n.input;n.text&&(et(i,O(t)),I(i,!1)?et(r,""):et(r,e.placeholder+""))}}),Ot(It,"value",{get:function(){var t=St(this.self);return""===t?null:t},set:function(t){var n,e=this._options;(n=At(O(t),e))&&mn(n[2],this)}}),Ot(It,"values",{get:function(){},set:function(t){}});var Kt=rt((function(t,n,e,r){var i=m(n)?n:I(n)||"",o=g(i),u=t._event,a=t._mask,f=t.mask,c=t.self,v=t.state,d=a.options,h=a.value,_=v.n,b=v.strict,y=A(f,"size");if(_+="__option",r){var w,x=St(c);jt(e,(function(t){F(t[3],"selected"),J(t[2],_+"--selected")}));try{jt(e,(function(n){var e=g(I(n[2])+"\t"+(w=Et(n[2])));if(""!==o&&o===e.slice(0,k(o))&&!U(n[2],_+"--disabled"))throw c.value=w,q(n[3],"selected",""),$(n[2],_+"--selected"),G(h,"value",w),Z(h,C(n[2])),w!==x&&t.fire("change",[u,w]),y&&n[2].scrollIntoView({block:"nearest"}),""}))}catch(t){}}else{var O=e.size;jt(e,(function(t){var n=g(I(t[2])+"\t"+Et(t[2]));""!==o&&!s(o,n)||U(t[2],_+"--disabled")?(t[2].hidden=!0,--O):t[2].hidden=!1})),d.hidden=!O,c.value=b?"":i}t.fire("search",[u,i]);var P=v.options;l(P)&&(P=P.call(t,i),p(P,Promise)?P.then((function(n){xt(t,n,d),t.fire("load",[u,n,i])})):xt(t,P,d))}),50);function Ut(t){var n=this,e=Lt(n),r=e.state.n;e._event=t,J(n,r+="--focus"),J(n,r+="-self")}function Yt(t){var n=this,e=Lt(n);e.mask;var r=e.state.n;e._event=t,J(n,r+="--focus"),J(n,r+="-option")}function Ft(t){var n=this,e=Lt(n),r=e._mask,i=e._options,o=e.mask,u=e.self,a=e.state,s=r.options,f=r.text,c=a.n,l=a.strict;if(e._event=t,J(o,c+"--focus-text"),J(f,c+"__text--focus"),l){var p=Nt(i).find((function(t){return I(t[2],!1)===I(n,!1)}))||Nt(i).find((function(t){return!t[2].hidden&&!U(t[2],c+"__option--disabled")}));p&&!s.hidden?mn(p,e):(jt(i,(function(t){F(t[3],"selected"),J(t[2],c+"__option--selected"),t[2].hidden=!1})),s.hidden=!1,e.text=u.value="")}}function Jt(t){var n=this,e=Lt(n),r=e._mask,i=e.self,o=r.hint;e._event=t,it((function(){return et(o,I(n,!1)?"":i.placeholder)}),1)()}function Vt(t){var n=this,e=Lt(n),r=e.state.n;e._event=t,$(n,r+="--focus"),$(n,r+="-self")}function Wt(t){var n=Lt(this),e=n.mask,r=n.state.n;hn(),n._event=t,$(e,r+="--focus"),$(e,r+="-option")}function qt(t){var n=Lt(this);n._event=t,n.focus()}function Xt(t){var n=Lt(this),e=n._mask,r=n.mask;n.self;var i=n.state,o=e.input,u=e.text,a=i.n;n._event=t,$(u,a+"__text--focus"),$(r,a+="--focus"),$(r,a+="-text"),I(o,!1)?_n(this):n.enter().fit()}function $t(t){var n,e=this,r=t.key,i=Lt(e),o=i._mask,u=i._options,a=i.mask,s=i.self,f=i.state,c=o.hint,l=f.n;if(i._event=t,it((function(){return et(c,I(e,!1)?"":s.placeholder)}),1)(),vt!==r&&dt!==r&&1!==k(r)||it((function(){return i.enter().fit()}),51)(),lt===r||pt===r||ht===r){var p=At(St(s),u);if(!(p=p?p[2]:0)||p.hidden)for(p=(p=Nt(u).shift())?p[2]:0;p&&(U(p,l+"__option--disabled")||p.hidden);)p=M(p);ht!==r||U(a,l+"--open")||(console.log({currentOption:p}),jt(u,(function(t){return t[2].hidden=!1}))),p&&!U(a,l+"--open")&&i.enter(),p&&Pt(p),n=!0}else gt===r?(console.log("tab"),i.exit()):Kt(i,e,u);n&&(st(t),ft(t))}var Gt="",Qt=rt((function(){return Gt=""}),500);function Zt(t){var n,e=t.key,r=t.altKey,i=t.ctrlKey,o=Lt(this),u=o._options,a=o.self;if(Qt(),Ct(a)||Rt(a))return st(t);o._event=t,vt===e||dt===e?Gt="":_t===e?(Gt="",o.exit(n=!0)):gt===e?(Gt="",o.exit(!(n=!1))):lt===e||pt===e||ht===e||mt===e||bt===e||""===Gt&&" "===e?o.enter(n=!0).fit():1!==k(e)||r||i||(Gt+=e),""!==Gt&&Kt(o,Gt,u,n=!0),n&&st(t)}function tn(t){var n,e=this,r=t.key,i=t.altKey,o=t.ctrlKey,u=Lt(e),a=u._mask,s=u._options;u.mask;var f=u.self,c=u.state,l=a.hint,p=a.input,v=a.value,d=c.n;d+="__option";var h,_,m,b,g,y="input"===R(f);if(u._event=t,vt===r)u.exit(n=!0);else if(ht===r||_t===r||gt===r||" "===r){if(_t!==r){var w,x=St(f);(g=At(x,s))&&(F(g[3],"selected"),J(g[2],d+"--selected")),q(e._[0],"selected",""),$(e,d+"--selected"),f.value=w=Et(e),y?(et(l,""),et(p,I(e))):(G(v,"value",w),Z(v,C(e))),w!==x&&u.fire("change",[t,w])}u.exit(n=gt!==r)}else if(lt===r||mt===r){for(n=!0,m=mt===r&&U(b=B(e),d+"-group")?M(b):M(e);m&&(U(m,d+"--disabled")||m.hidden);)m=M(m);for(m?U(m,d+"-group")&&(m=T(m)):((b=B(e))&&U(b,d+"-group")&&(m=M(b)),m&&U(m,d+"-group")&&(m=T(m)));m&&(U(m,d+"--disabled")||m.hidden);)m=M(m);m?Pt(m):(h=Nt(s).find((function(t){return!t[2].hidden&&!U(t[2],d+"--disabled")})))&&Pt(h[2])}else if(pt===r||bt===r){for(n=!0,g=bt===r&&U(b=B(e),d+"-group")?N(b):N(e);g&&(U(g,d+"--disabled")||g.hidden);)g=N(g);for(g?U(g,d+"-group")&&(g=L(g)):((b=B(e))&&U(b,d+"-group")&&(g=N(b)),g&&U(g,d+"-group")&&(g=L(g)));g&&(U(g,d+"--disabled")||g.hidden);)g=N(g);g?Pt(g):(_=Nt(s).findLast((function(t){return!t[2].hidden&&!U(t[2],d+"--disabled")})))&&Pt(_[2])}else"Home"===r?(n=!0,(h=Nt(s).find((function(t){return!t[2].hidden&&!U(t[2],d+"--disabled")})))&&Pt(h[2])):"End"===r?(n=!0,(_=Nt(s).findLast((function(t){return!t[2].hidden&&!U(t[2],d+"--disabled")})))&&Pt(_[2])):(y&&1===k(r)&&!i&&!o&&et(l,""),u.exit(!(n=!1)));n&&(st(t),ft(t))}function nn(t){var n=this,e=Lt(n),r=e._mask,i=e.self,o=r.hint;e._event=t,it((function(){return et(n,I(n))}))(),it((function(){return et(o,I(n,!1)?"":i.placeholder)}),1)()}function en(t){var n=this,e=Lt(n),r=e.self,i=e.state.n,o=t.target;st(t),Ct(r)||Rt(r)||A(n,"size")||(e._event=t,U(o,i+"__options")||B(o,"."+i+"__options")||e[U(n,i+"--open")?"exit":"enter"](!0).fit())}var rn=0;function on(t){var n=this,e=Lt(n),r=e._mask,i=e.mask,o=r.options;e._event=t,"mousedown"===t.type?(mn(n,e),A(i,"size")||e.exit(!0)):(Pt(n),rn=ut(o)[1]),st(t)}var un=!1;function an(t){"touchstart"===t.type&&(un=t.touches[0].clientY);var n=Lt(this);if(n){var e=n.mask,r=n.state.n,i=t.target;n._event=t,e!==i&&e!==B(i,"."+r)&&(A(e,"size")?n.blur():(Mt(this),n.exit()))}}function sn(t){if(!1!==un){var n,e,r=Lt(this);if(r._event=t,"touchmove"===t.type&&r){var i=r._mask.options,o=t.touches[0].clientY;if(i){var u=ut(i);u[1]-=o-un,e=u,(n=i).scrollLeft=e[0],n.scrollTop=e[1],un=o}}}}function fn(t){var n=Lt(this),e=n._mask.options;n._event=t,ut(e)[1]===rn&&(mn(this,n),n.exit(!0))}function cn(){un=!1}function ln(t){var n=Lt(this);n._event=t,n.let().fire("reset",[t])}function pn(t){var n=Lt(this);n&&(yt(n),n._event=t)}function vn(t){pn.call(this,t)}function dn(t){var n=Lt(this);return n._event=t,n.fire("submit",[t])}function hn(t){var n=P.getSelection();n.rangeCount&&n.removeRange(n.getRangeAt(0))}function _n(t,n){var e=P.getSelection();hn();var r=P.createRange();r.selectNodeContents(t),e.addRange(r),1===n?e.collapseToEnd():-1===n&&e.collapseToStart()}function mn(t,n){var e=n._event,r=n._mask,i=n._options,o=n.self,u=n.state,a=r.hint,s=r.input;r.options;var f=r.value,c=u.n;c+="__option--selected";var l,p=St(o);jt(i,(function(n){t!==n[2]&&(F(n[3],"selected"),J(n[2],c))})),q(t._[0],"selected",""),$(t,c),o.value=l=Et(t),"input"===R(o)?(et(a,""),et(s,I(t))):(G(f,"value",l),Z(f,C(t))),l!==p&&n.fire("change",[e,l])}return It.attach=function(t,n){var e,r=this;t=t||r.self,n=n||r.state,r._active=!Ct(t)&&!Rt(t),r._event=null,r._options=new wt(r,[]),r._value=St(t)||null,r.self=t,r.state=n;var i="input"===R(t),o=n.n,u=Q("span",{class:o+"__arrow"}),a=D(t),s=Q("div",{class:o,tabindex:!Ct(t)&&!i&&0});r.mask=s;var c,v,d=Q("div",{class:o+"__options"}),b=Q("div",{class:o+"__values"}),g=Q("span",{class:o+"__"+(i?"text":"value")}),y=Q("span",{autocapitalize:"off",contenteditable:!(Ct(t)||Rt(t)||!i)&&"",spellcheck:!!i&&"false"}),w=Q("span",i?t.placeholder+"":"");X(s,b),X(s,d),X(b,g),X(b,u),i?(ct("blur",y,Ft),ct("cut",y,Jt),ct("focus",y,Xt),ct("keydown",y,$t),ct("paste",y,nn),X(g,y),X(g,w),Bt(y,r)):(ct("blur",s,Ut),ct("focus",s,Vt),ct("keydown",s,Zt)),$(t,o+"__self"),v=s,B(c=t).insertBefore(v,M(c,!0)),a&&(ct("reset",a,ln),ct("submit",a,dn),Bt(a,r)),ct("focus",t,qt),ct("mousedown",E,an),ct("mousedown",s,en),ct("mousemove",E,sn),ct("mouseup",E,cn),ct("resize",z,pn),ct("scroll",z,vn),ct("touchend",E,cn),ct("touchmove",E,sn,{passive:!1}),ct("touchstart",E,an),ct("touchstart",s,en),t.tabIndex=-1,Bt(s,r);var x,O={};O.arrow=u,O.hint=i?w:null,O.input=i?y:null,O.of=t,O.options=d,O.self=s,O[i?"text":"value"]=g,r._mask=O,r.size=null!=(e=n.size)?e:i?1:t.size;var P=n.options;if(l(P)?(P=P.call(r,null),p(P,Promise)?P.then((function(t){xt(r,t,d),r.fire("load",[r._event,t,null])})):xt(r,P,d)):xt(r,P||Tt(t),d),(x=At(r._value,r._options)||(i?0:Nt(r._options).find((function(t){return!Ct(t[3])}))))&&(r.value=Et(x[2])),_(n)&&f(n.with))for(var j=0,T=k(n.with);j<T;++j){var L=n.with[j];m(L)&&(L=Ht[L]),l(L)?L.call(r,t,n):h(L)&&l(L.attach)&&L.attach.call(r,t,n)}return r},It.blur=function(){hn();var t=this,n=t._mask,e=t.mask;return(n.input||e).blur(),t.exit()},It.detach=function(){var t=this,n=t._mask,e=t.mask,r=t.self,i=t.state,o=n.input,u=D(r);if(t._active=!1,t._value=St(r)||null,u&&(at("reset",u,ln),at("submit",u,dn)),o&&(at("blur",o,Ft),at("blur",e,Ut),at("cut",o,Jt),at("focus",o,Xt),at("focus",e,Vt),at("keydown",o,$t),at("keydown",e,Zt),at("paste",o,nn)),at("focus",r,qt),at("mousedown",E,an),at("mousedown",e,en),at("mousemove",E,sn),at("mouseup",E,cn),at("resize",z,pn),at("scroll",z,vn),at("touchend",E,cn),at("touchmove",E,sn),at("touchstart",E,an),at("touchstart",e,en),f(i.with))for(var a=0,s=k(i.with);a<s;++a){var c=i.with[a];m(c)&&(c=Ht[c]),h(c)&&l(c.detach)&&c.detach.call(t,r,i)}return r.tabIndex=null,J(r,i.n+"__self"),V(e),t._mask={of:r},t.mask=null,t},It.enter=function(t){var n,e=this,r=e._event,i=e._mask,o=e._options,u=e.mask,a=e.self,s=e.state,f=i.input,c=s.n;$(u,c+"--focus"),$(u,c+"--focus-option"),$(u,c+="--open");var l=Lt(E);return l&&e!==l&&l.exit(),Bt(E,e),Bt(z,e),e.fire("enter",[r]),t&&(e.fire("focus",[r]),"input"===R(a)?(Pt(f),_n(f)):(n=At(St(a),o))&&Pt(n[2]),e.fire("focus.option",[r])),e},It.exit=function(t){var n=this,e=n._event,r=n._mask,i=n.mask,o=n.self,u=n.state,a=r.input,s=u.n;return J(i,s+"--focus"),J(i,s+"--focus-option"),J(i,s+="--open"),n.fire("exit",[e]),t&&("input"===R(o)?(Pt(a),_n(a)):Pt(i),n.fire("focus",[e]).fire("focus.self",[e])),n},It.fit=function(){var t=this,n=t._mask,e=t.mask,r=n.options;if(A(e,"size"))return t;var i=H(e,"border-bottom-width"),o=H(e,"border-top-width"),u=ot(e),a=ot(z);return u[1]+u[3]/2>a[3]/2?nt(r,{bottom:"100%","max-height":"calc("+u[1]+"px + "+i+")",top:"auto"}):nt(r,{bottom:"auto","max-height":"calc("+(a[3]-u[1]-u[3])+"px + "+o+")",top:"100%"}),t},It.focus=function(t){var n=this,e=n._mask,r=n.mask,i=e.input;return i?(Pt(i),_n(i,t),n):(Pt(r),n)},Ht}));