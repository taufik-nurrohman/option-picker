/*!
 *
 * The MIT License (MIT)
 *
 * Copyright © 2025 Taufik Nurrohman <https://github.com/taufik-nurrohman>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the “Software”), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */
!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(t="undefined"!=typeof globalThis?globalThis:t||self).OptionPicker=n()}(this,(function(){"use strict";function t(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=Array(n);e<n;e++)r[e]=t[e];return r}function n(n,e,r){if(e&&!Array.isArray(e)&&"number"==typeof e.length){var i=e.length;return t(e,r<i?r:i)}return n(e,r)}function e(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var r,i,o,u,a=[],s=!0,f=!1;try{if(o=(e=e.call(t)).next,0===n){if(Object(e)!==e)return;s=!1}else for(;!(s=(r=o.call(e)).done)&&(a.push(r.value),a.length!==n);s=!0);}catch(t){f=!0,i=t}finally{try{if(!s&&null!=e.return&&(u=e.return(),Object(u)!==u))return}finally{if(f)throw i}}return a}}(t,n)||r(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(n,e){if(n){if("string"==typeof n)return t(n,e);var r={}.toString.call(n).slice(8,-1);return"Object"===r&&n.constructor&&(r=n.constructor.name),"Map"===r||"Set"===r?Array.from(n):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(n,e):void 0}}var i=function(t,n){return-1!==n.indexOf(t)},o=function(t){return Array.isArray(t)},u=function(t){return l(t)&&0!=t%1},a=function(t){return"function"==typeof t},s=function(t,n,e){return!(!t||"object"!=typeof t)&&(e?v(n)&&v(t.constructor)&&n===t.constructor:v(n)&&t instanceof n)},f=function(t){return l(t)&&0==t%1},l=function(t){return"number"==typeof t},c=function(t,n){return void 0===n&&(n=!0),!(!t||"object"!=typeof t)&&(!n||s(t,Object,1))},v=function(t){return function(t){return void 0!==t}(t)&&!function(t){return null===t}(t)},p=function(t){return"string"==typeof t},d=function(){for(var t=arguments.length,n=Array(t),e=0;e<t;e++)n[e]=arguments[e];for(var r=n.shift(),u=0,a=g(n);u<a;++u)for(var s in n[u])if(v(r[s]))if(o(r[s])&&o(n[u][s])){r[s]=[].concat(r[s]);for(var f=0,l=g(n[u][s]);f<l;++f)i(n[u][s][f],r[s])||r[s].push(n[u][s][f])}else c(r[s])&&c(n[u][s])?r[s]=d({},r[s],n[u][s]):r[s]=n[u][s];else r[s]=n[u][s];return r},h=function(t){if(o(t))return t.map((function(n){return h(t)}));if(c(t)){for(var n in t)t[n]=h(t[n]);return t}return!1===t?"false":null===t?"null":!0===t?"true":""+t},_=function(t){return t.replace(/[-_.](\w)/g,(function(t,n){return b(n)}))},m=function(t){return t.toLowerCase()},b=function(t){return t.toUpperCase()},g=function(t){return t.length},y=function(t){if(o(t))return t.map((function(t){return y(t)}));if(c(t)){for(var n in t)t[n]=y(t[n]);return t}return p(t)&&function(t){return/^[+-]?(?:\d*.)?\d+$/.test(t+"")}(t)?"0"===t[0]&&-1===t.indexOf(".")?t:function(t,n){return void 0===n&&(n=10),n?parseInt(t,n):parseFloat(t)}(t):"false"!==t&&("null"===t?null:"true"===t||t)},k=function(t,n){for(var e=0,r=g(t);e<r&&0!==n(t[e],e);++e);return t},x=function(t,i){for(var o,u=function(t){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=r(t))||t&&"number"==typeof t.length){n&&(t=n);var e=0;return function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(t);!(o=u()).done;){var a=n(e,o.value,2),s=a[0],f=a[1];if(0===(f=i(f,s)))break}return t},w=function(t,n){for(var e in t)if(0===n(t[e],e))break;return t},A=function(t){return t.prototype},S=function(t){return z(t,P)||null},z=function(t,n){return n.get(t)},T=function(t,n){return n.has(t)},O=function(t){return E(t,P)},E=function(t,n){return n.delete(t)},L=function(t,n,e){return e||(t=A(t)),w(n,(function(n,e){return Object.defineProperty(t,e,n)})),t},C=function(t,n,e){return t=A(t),w(n,(function(n,e){return t[e]=n})),t},j=function(t,n){return I(t,n,P)},I=function(t,n,e){return e.set(t,n)},M=function(t){var n=[];return x(t,(function(t){return n.push(t)})),n},P=new WeakMap,N=document,H=window,R=N.body,D=N.documentElement,K=function(t){return t.focus()},U=function(t,n){return t["first"+(n?"":"Element")+"Child"]||null},B=function(t,n){return t["last"+(n?"":"Element")+"Child"]||null},Y=function(t,n,e){var r=[].slice.call(t.children);return l(n)?r[n]||null:r},J=function(t,n,e){void 0===e&&(e=!0);var r=function(t,n,e){if(void 0===e&&(e=!0),!nt(t,n))return null;var r=t.getAttribute(n);return e?y(r):r}(t,"data-"+n,e),i=(r+"").trim();return e&&i&&("["===i[0]&&"]"===i.slice(-1)||"{"===i[0]&&"}"===i.slice(-1))&&null!==(i=function(t){var n=null;try{n=JSON.parse(t)}catch(t){}return n}(r))?i:r},V=function(t,n){if(!t||!q(t))return-1;for(var e=0;t=X(t,n);)++e;return e},W=function(t){return m(t&&t.nodeName||"")||null},$=function(t,n){return t["next"+(n?"":"Element")+"Sibling"]||null},q=function(t,n){return n?t.closest(n)||null:t.parentNode||null},F=function(t){var n="form";return rt(t,n)&&n===W(t[n])?t[n]:q(t,n)},X=function(t,n){return t["previous"+(n?"":"Element")+"Sibling"]||null},G=function(t,n,e){var r=H.getComputedStyle(t).getPropertyValue(n);return r||""===r||0===r?r:null},Q=function(t,n){return rt(t,n)&&t[n]||null},Z=function(t,n){void 0===n&&(n=!0);var e="textContent";if(!rt(t,e))return!1;var r=t[e];return""!==(r=n?r.trim():r)?r:null},tt=function(t,n){var e=(t.value||"").replace(/\r?\n|\r/g,"\n");return""!==e?e:null},nt=function(t,n){return t.hasAttribute(n)},et=function(t,n){return t.classList.contains(n)},rt=function(t,n){return n in t},it=function(t){return t.disabled},ot=function(t){return t.readOnly},ut=function(t,n){return t.removeAttribute(n),t},at=function(t,n){return t.classList.remove(n),t},st=function(t,n){return ut(t,"data-"+n)},ft=function(t){var n=q(t);return t.remove(),n},lt=function(t,n){return t.style[_(n)]=null,t},ct=function(t){var n=N.getSelection();n.rangeCount&&n.removeRange(n.getRangeAt(0))},vt=function(t,n){var e=N.getSelection();ct();var r=N.createRange();r.selectNodeContents(t),e.addRange(r),1===n?e.collapseToEnd():-1===n&&e.collapseToStart()},pt=function(t,n,e){return!0===e&&(e=n),t.setAttribute(n,h(e)),t},dt=function(t,n){return t.append(n),n},ht=function(t,n){return t.classList.add(n),t},_t=function(t,n){return o(n)?(k(n,(function(n){return ht(t,n)})),t):c(n)?(w(n,(function(n,e){return n?ht(t,e):at(t,e)})),t):(t.className=n,t)},mt=function(t,n,e){return(o(e)||c(e))&&(e=JSON.stringify(e)),pt(t,"data-"+n,e)},bt=function(t,n,e,r){return t=p(t)?N.createElement(t,p(r)?{is:r}:r):t,o(n)&&g(n)?(!function(t){var n="innerHTML";rt(t,n)&&(t[n]="")}(t),k(n,(function(t){return dt(p(t)?gt(t):t)}))):c(n)&&(e=n,n=!1),p(n)&&yt(t,n),c(e)?(function(t,n){w(n,(function(n,e){n||""===n||0===n?pt(t,e,n):ut(t,e)}))}(t,e),t):t},gt=function(t){return p(t)?N.createTextNode(t):t},yt=function(t,n,e){if(void 0===e&&(e=!0),null===n)return t;var r="innerHTML";return rt(t,r)&&(t[r]=e?n.trim():n),t},kt=function(t,n,e){return l(e)&&(e+="px"),t.style[_(n)]=h(e),t},xt=function(t,n){return w(n,(function(n,e){n||""===n||0===n?kt(t,e,n):lt(t,e)})),t},wt=function(t,n,e){if(void 0===e&&(e=!0),null===n)return t;var r="textContent";return rt(t,r)&&(t[r]=e?n.trim():n),t},At=function(t,n){return null===n?ut(t,"value"):(t.value=h(n),t)},St=function(t,n){var e;return function(){var r=arguments,i=this;e&&clearTimeout(e),e=setTimeout((function(){return t.apply(i,r)}),n)}},zt=function(t,n){return function(){var e=arguments,r=this;setTimeout((function(){return t.apply(r,e)}),n)}},Tt=function(t){var n,e,r,i,o,u,a;return!function(t){return t===H}(t)?(i=(e=t.getBoundingClientRect()).left,o=e.top,r=e.width,n=e.height,u=e.right,a=e.bottom):(i=t.pageXOffset||D.scrollLeft||R.scrollLeft,o=t.pageYOffset||D.scrollTop||R.scrollTop,r=t.innerWidth,n=t.innerHeight),[i,o,r,n,u,a]},Ot=function(t){return[t.scrollLeft,t.scrollTop]};var Et=function(t,n,e){n.removeEventListener(t,e)},Lt=function(t){return t&&t.preventDefault()},Ct=function(t){return t&&t.stopPropagation()},jt=function(t,n,e,r){void 0===r&&(r=!1),n.addEventListener(t,e,r)},It="ArrowDown",Mt="ArrowUp",Pt="Backspace",Nt="Delete",Ht="Enter",Rt="Escape",Dt="PageDown",Kt="PageUp",Ut="Tab",Bt=St((function(t){return t.fit()}),10);function Yt(t,n,e){var r=s(n,Map)?n:new Map;return o(n)?k(n,(function(t){var n,e,i;o(t)?(t[0]=null!=(n=t[0])?n:"",t[1]=null!=(e=t[1])?e:{},I(y(null!=(i=t[1].value)?i:t[0]),t,r)):I(y(t),[t,{}],r)})):c(n,0)&&w(n,(function(t,e){var i,u,a;o(t)?(n[e][0]=null!=(i=t[0])?i:"",n[e][1]=null!=(u=t[1])?u:{},I(y(null!=(a=t[1].value)?a:e),t,r)):I(y(e),[t,{}],r)})),function(t,n,e){var r,i,u=[],s=t._options,f=t.self,l=t.state;l.n;var c=tt(f);if(Gt(f)?!(r=f.list)||Y(r):Y(r=f),s.delete(null,0),x(e,(function(t,n){var e;o(t)&&t[1]&&!t[1].disabled&&t[1].selected&&u.push(y(t[1].value||n)),I(y(o(t)&&t[1]&&null!=(e=t[1].value)?e:n),t,s)})),a(l.options)||(l.options=e),0===g(u)){if(T(i=y(c),e))return[i];if(i=qt(t))return[Ft(i,1)]}return u}(t,0,r)}function Jt(t,n,e){n.mask;var r=n.state.n;if(t)return $t(n),e?K(t):ht(t,r+"__option--focus"),t}function Vt(t,n,e){var r,i=t._options,o=t.state.n;if(o+="__option--disabled",r=M(i)["find"+(e||"")]((function(t){return!t[2].hidden&&!et(t[2],o)})))return Jt(r[2],t,n)}function Wt(t,n){return Vt(t,n,"Last")}function $t(t){var n=t._options;t.mask;var e=t.state.n;e+="__option--focus",x(n,(function(t){return at(t[2],e)}))}function qt(t,n){var e,r=t._options,i=t.self,u=t.state.n;return u+="__option",x(r,(function(t,n){if(o(t)&&t[2]&&!et(t[2],u+"--disabled")&&et(t[2],u+"--selected"))return e=t[2],0})),v(e)||!n&&Gt(i)||x(r,(function(t,n){return e=t[2],0})),e}function Ft(t,n){return J(t,"value",n)}function Xt(t){var n,e,r,i=new Map,o=[],u=tt(t);return e=Gt(t)?(r=t.list)?Y(r):[]:Y(r=t),k(e,(function(t,n){var e=function(t,n){void 0===n&&(n=!0);var e=t.attributes,r={};return k(e,(function(t){var e=t.name,i=t.value;r[e]=n?y(i):i})),r}(t);k(["disabled","selected"],(function(t){rt(e,t)?(e[t]=""===e[t]||e[t],"selected"===t&&o.push(1)):e[t]=null})),"optgroup"===W(t)?x(Xt(t),(function(n,e){n[1]["&"]=t.label,I(y(e),n,i)})):I(y(t.value),[Z(t)||t.value,e,null,t],i)})),0===g(o)&&(n=z(u=y(u),i))&&(n[1].selected=!0,I(u,n,i)),i}function Gt(t){return"input"===W(t)}var Qt=St((function(t,n,e,r){var o=p(n)?n:Z(n)||"",u=m(o),f=t._event,l=t._mask,c=t.mask,v=t.self,d=t.state,h=l.options;l.value;var _=d.n,b=d.strict,y=J(c,"size");_+="__option--disabled";var k=e.count;r?x(e,(function(n){var e=m(Z(n[2])+"\t"+Ft(n[2]));if(""!==u&&u===e.slice(0,g(u))&&!et(n[2],_))return Tn(n[2],t,1),y&&n[2].scrollIntoView({block:"nearest"}),0;--k})):($t(t),x(e,(function(t){var n=m(Z(t[2])+"\t"+Ft(t[2]));""===u||i(u,n)?t[2].hidden=!1:(t[2].hidden=!0,--k)})),h.hidden=!k,b&&Vt(t),At(v,b?"":o)),t.fire("search",[f,o]);var w=d.options;0===k&&a(w)&&(pt(c,"aria-busy","true"),w=w.call(t,o),s(w,Promise)?w.then((function(n){Yt(t,n),ut(c,"aria-busy"),t.fire("load",[f,o,n]).fit()})):Yt(t,w))}),10);function Zt(t){var n=this,e=S(n),r=e.state.n;e._event=t,at(n,r+="--focus"),at(n,r+="-self")}function tn(t){var n=S(this),e=n.mask,r=n.state.n;n._event=t,at(this,r+"__option--focus"),at(e,r+="--focus"),at(e,r+"-option")}function nn(t){var n,e=S(this),r=e._mask,i=e.mask,o=e.state,u=r.text,a=o.n,s=o.strict;e._event=t,at(u,a+"__text--focus"),at(i,a+="--focus"),at(i,a+"-text"),s&&((n=qt(e))?Tn(n,e,1):On(e,1)||En(e,0,1))}function en(t){var n=this,e=S(n),r=e._mask,i=e.self,o=r.hint;e._event=t,zt((function(){return wt(o,Z(n,!1)?"":i.placeholder)}),1)()}function rn(t){var n=this,e=S(n),r=e.state.n;e._event=t,ht(n,r+="--focus"),ht(n,r+="-self")}function on(t){var n=S(this),e=n.mask,r=n.state.n;ct(),n._event=t,ht(this,r+"__option--focus"),ht(e,r+="--focus"),ht(e,r+="-option")}function un(t){var n=S(this);n._event=t,n.focus()}function an(t){var n=this,e=S(n),r=e._mask,i=e.mask;e.self;var o=e.state,u=r.text,a=o.n;e._event=t,ht(u,a+"__text--focus"),ht(i,a+="--focus"),ht(i,a+="-text"),Z(n,!1)?vt(n):e.enter().fit()}var sn="";function fn(t){var n,e=this,r=t.key,i=S(e),o=i._mask,u=i._options,a=i.mask,s=i.self,f=i.state,l=o.hint;o.input;var c=f.n,v=f.strict;if(i._event=t,zt((function(){return wt(l,Z(e,!1)?"":s.placeholder)}),1)(),Pt!==r&&Nt!==r&&1!==g(r)||zt((function(){return i.enter().fit()}),11)(),It===r||Mt===r||Ht===r){var p=z(y(tt(s)),u._o);if(!(p=p?p[2]:0)||p.hidden)for(p=(p=M(u).shift())?p[2]:0;p&&(et(p,c+"__option--disabled")||p.hidden);)p=$(p);n=!0,et(a,c+"--open")?v&&Ht===r?On(i,1)&&i.exit(n):p&&K(p):(i.enter(n),p&&K(p))}else Ut===r?v&&On(i,1)&&i.exit():zt((function(){""!==sn&&sn===Z(e)+""||(Qt(i,e,u),sn=Z(e)+"")}),1)();n&&(Lt(t),Ct(t))}var ln="",cn=St((function(){return ln=""}),500);function vn(t){var n,e=t.key,r=t.altKey,i=t.ctrlKey,o=S(this),u=o._options,a=o.self;if(cn(),it(a)||ot(a))return Lt(t);o._event=t,Pt===e||Nt===e?ln="":Rt===e?(ln="",o.exit(n=!0)):Ut===e?(ln="",o.exit(!(n=!1))):It===e||Mt===e||Ht===e||Dt===e||Kt===e||""===ln&&" "===e?o.enter(n=!0).fit():1!==g(e)||r||i||(ln+=e),""!==ln&&Qt(o,ln,u,n=!0),n&&Lt(t)}function pn(t){var n,e=this,r=t.key,i=t.altKey,o=t.ctrlKey,u=S(e),a=u._mask;u._options,u.mask;var s=u.self,f=u.state,l=a.hint;a.input,a.value;var c,v,p,d=f.n;if(d+="__option",u._event=t,Pt===r)u.exit(n=!0);else if(Ht===r||Rt===r||Ut===r||" "===r)Rt!==r&&Tn(e,u,1),u.exit(n=Ut!==r);else if(It===r||Dt===r){for(n=!0,c=Dt===r&&et(v=q(e),d+"-group")?$(v):$(e);c&&(et(c,d+"--disabled")||c.hidden);)c=$(c);for(c?et(c,d+"-group")&&(c=U(c)):((v=q(e))&&et(v,d+"-group")&&(c=$(v)),c&&et(c,d+"-group")&&(c=U(c)));c&&(et(c,d+"--disabled")||c.hidden);)c=$(c);c?Jt(c,u,1):Vt(u,1)}else if(Mt===r||Kt===r){for(n=!0,p=Kt===r&&et(v=q(e),d+"-group")?X(v):X(e);p&&(et(p,d+"--disabled")||p.hidden);)p=X(p);for(p?et(p,d+"-group")&&(p=B(p)):((v=q(e))&&et(v,d+"-group")&&(p=X(v)),p&&et(p,d+"-group")&&(p=B(p)));p&&(et(p,d+"--disabled")||p.hidden);)p=X(p);p?Jt(p,u,1):Wt(u,1)}else"Home"===r?(n=!0,Vt(u,1)):"End"===r?(n=!0,Wt(u,1)):(Gt(s)&&1===g(r)&&!i&&!o&&wt(l,""),u.exit(!(n=!1)));n&&(Lt(t),Ct(t))}function dn(t){var n=this,e=S(n),r=e._mask,i=e.self,o=r.hint;e._event=t,zt((function(){return wt(n,Z(n))}))(),zt((function(){return wt(o,Z(n,!1)?"":i.placeholder)}),1)()}function hn(t){var n=this,e=S(n),r=e._options,i=e.self,o=e.state.n,u=t.target;Lt(t),it(i)||ot(i)||J(n,"size")||(e._event=t,et(u,o+"__options")||q(u,"."+o+"__options")||(x(r,(function(t){return t[2].hidden=!1})),e[et(n,o+"--open")?"exit":"enter"](!0).fit()))}var _n=0;function mn(t){var n=this,e=S(n),r=e._mask,i=e.mask,o=r.options;e._event=t,"mousedown"===t.type?(Tn(n,e,1),J(i,"size")||e.exit(!0)):(K(n),_n=Ot(o)[1]),Lt(t)}var bn=!1;function gn(t){"touchstart"===t.type&&(bn=t.touches[0].clientY);var n=S(this);if(n){var e=n.mask,r=n.state.n,i=t.target;n._event=t,e!==i&&e!==q(i,"."+r)&&(J(e,"size")?n.blur():(O(this),n.exit()))}}function yn(t){if(!1!==bn){var n,e,r=S(this);if(r._event=t,"touchmove"===t.type&&r){var i=r._mask.options,o=t.touches[0].clientY;if(i){var u=Ot(i);u[1]-=o-bn,e=u,(n=i).scrollLeft=e[0],n.scrollTop=e[1],bn=o}}}}function kn(t){var n=S(this),e=n._mask.options;n._event=t,Ot(e)[1]===_n&&(Tn(this,n,1),n.exit(!0))}function xn(){bn=!1}function wn(t){var n=S(this);n._event=t,n.reset()}function An(t){var n=S(this);n&&(Bt(n),n._event=t)}function Sn(t){An.call(this,t)}function zn(t){var n=S(this);return n._event=t,n.fire("submit",[t])}function Tn(t,n,e){var r=n._event,i=n._mask;n._options;var o=n.self,u=n.state,a=i.hint,s=i.input,f=i.value,l=u.n;if(l+="__option--selected",t){var c,v=tt(o);return En(n),pt(t._[0],"selected",""),ht(t,l),At(o,c=Ft(t)),Gt(o)?(wt(a,""),wt(s,Z(t))):(mt(f,"value",c),yt(f,function(t,n){void 0===n&&(n=!0);var e="innerHTML";if(!rt(t,e))return!1;var r=t[e];return""!==(r=n?r.trim():r)?r:null}(t))),e&&c!==v&&n.fire("change",[r,y(c)]),t}}function On(t,n,e){var r,i=t._options,o=t.state.n;if(o+="__option--disabled",r=M(i).find((function(t){return!t[2].hidden&&!et(t[2],o)})))return Tn(r[2],t,n)}function En(t,n,e){var r=t._event,i=t._mask,o=t._options,u=t.self,a=t.state,s=i.hint,f=i.input;i.options;var l=i.value,c=a.n;c+="__option--selected";var v=tt(u);x(o,(function(t){ut(t[3],"selected"),at(t[2],c)})),e&&(At(u,""),Gt(u)?(wt(s,u.placeholder),wt(f,"")):(st(l,"value"),yt(l,"")),n&&""!==v&&t.fire("change",[r,y("")]))}function Ln(t,n){var e=this;return t?s(e,Ln)?(j(t,function(t,n){return(n=n||t).fire=function(t,n,e){var r=this,i=r.hooks;return v(i[t])?(i[t].forEach((function(t){return t.apply(e||r,n)})),r):r},n.off=function(t,n){var e=this,r=e.hooks;if(!v(t))return r={},e;if(v(r[t]))if(v(n)){var i=r[t].length;if(0===i)delete r[t];else for(var o=0;o<i;++o)if(n===r[t][o]){r[t].splice(o,1);break}}else delete r[t];return e},n.on=function(t,n){var e=this.hooks;return v(e[t])||(e[t]=[]),v(n)&&e[t].push(n),this},t.hooks={},t}(e,Ln._)),e.attach(t,d({},Ln.state,n||{}))):new Ln(t,n):e}function Cn(t,n,e){var r=this;return s(r,Cn)?(r._o=new Map,r._start=e||0,r.count=0,r.of=t,n&&g(n)&&Yt(t,n,t._mask.options),r):new Cn(t,n,e)}return Ln.from=function(t,n){return new Ln(t,n)},Ln.of=S,Ln.state={n:"option-picker",options:null,size:null,strict:!1,with:[]},Ln.version="2.0.0",L(Ln,{name:{value:"OptionPicker"}},1),L(Ln,{options:{get:function(){return this._options},set:function(t){var n,e=this,r=e._event,i=e._mask;return e._options,e.state.n,(u(t)||f(t)||p(t))&&(t=[t]),g(n=Yt(e,t,i.options))&&(e.value=n[0]),e.fire("set.options",[r,t])}},size:{get:function(){var t=this.state.size||1;return f(t)?t<1?1:t:1},set:function(t){var n=this,e=n._event,r=n._mask,i=n._options,o=n.mask,u=n.state,a=r.options;u.n;var s=f(t)?t<1?1:t:1;if(u.size=s,1===s)st(o,"size"),lt(a,"max-height"),O(D);else{var l=M(i).find((function(t){return!t[2].hidden}));if(l){var c,v,p=G(a,"gap"),d=G(a,"padding-bottom"),h=null!=(c=null!=(v=G(l,"height"))?v:G(l,"min-height"))?c:G(l,"line-height");mt(o,"size",s),kt(a,"max-height","calc(("+h+" + max("+p+","+d+"))*"+s+")"),j(D,n)}}return n.fire("set.size",[e,s])}},text:{get:function(){var t=this._mask,n=t.input;return t.text?Z(n):null},set:function(t){var n=this,e=n._event,r=n._mask,i=n.self,o=r.hint,u=r.input;return r.text&&(wt(u,h(t)),wt(o,Z(u,!1)?"":i.placeholder+"")),n.fire("set.text",[e,t])}},value:{get:function(){var t=tt(this.self);return""===t?null:t},set:function(t){var n,e=this,r=e._active,i=e._event,o=e._options;return e.mask,e.state.n,r?((n=z(y(t),o._o))&&Tn(n[2],e,1),e.fire("set.value",[i,t])):e}},values:{get:function(){},set:function(t){}}}),Ln._=C(Ln,{attach:function(t,n){var e,r=this;t=t||r.self,n=n||r.state,r._active=!it(t)&&!ot(t),r._event=null,r._options=new Cn(r,[],1),r._value=tt(t)||null,r.self=t,r.state=n;var i=Gt(t),u=n.n,f=bt("span",{class:u+"__arrow"}),l=F(t),d=bt("div",{class:u,tabindex:!it(t)&&!i&&0});r.mask=d;var h,_,m=bt("div",{class:u+"__options"}),b=bt("div",{class:u+"__values"}),y=bt("span",{class:u+"__"+(i?"text":"value")}),x=bt("span",{autocapitalize:"off",contenteditable:!(it(t)||ot(t)||!i)&&"",spellcheck:!!i&&"false",tabindex:!(!ot(t)||!i)&&0}),w=bt("span",i?t.placeholder+"":"");dt(d,b),dt(d,m),dt(b,y),dt(b,f),i?(jt("blur",x,nn),jt("cut",x,en),jt("focus",x,an),jt("keydown",x,fn),jt("paste",x,dn),dt(y,x),dt(y,w),j(x,r)):(jt("blur",d,Zt),jt("focus",d,rn),jt("keydown",d,vn)),ht(t,u+"__self"),_=d,q(h=t).insertBefore(_,$(h,!0)),l&&(jt("reset",l,wn),jt("submit",l,zn),j(l,r)),jt("focus",t,un),jt("mousedown",D,gn),jt("mousedown",d,hn),jt("mousemove",D,yn),jt("mouseup",D,xn),jt("resize",H,An,{passive:!0}),jt("scroll",H,Sn,{passive:!0}),jt("touchend",D,xn),jt("touchmove",D,yn,{passive:!0}),jt("touchstart",D,gn),jt("touchstart",d,hn),t.tabIndex=-1,j(d,r);var A={};A.arrow=f,A.hint=i?w:null,A.input=i?x:null,A.of=t,A.options=m,A.self=d,A[i?"text":"value"]=y,r._mask=A,r.size=null!=(e=n.size)?e:i?1:t.size;var S,z=r._active,T=n.options;return r._active=!0,a(T)?(pt(d,"aria-busy","true"),T=T.call(r,null),s(T,Promise)?T.then((function(t){ut(d,"aria-busy"),g(S=Yt(r,t))?r.value=S[0]:(S=qt(r,1))&&(r.value=Ft(S)),r.fire("load",[r._event,null,t]).fit()})):g(S=Yt(r,T))&&(r.value=S[0])):g(S=Yt(r,T||Xt(t)))&&(r.value=S[0]),r._active=z,v(n)&&o(n.with)&&k(n.with,(function(e,i){p(e)&&(e=Ln[e]),a(e)?e.call(r,t,n):c(e)&&a(e.attach)&&e.attach.call(r,t,n)})),r._options._start=0,r},blur:function(){ct();var t=this,n=t._mask,e=t.mask;return(n.input||e).blur(),t.exit()},detach:function(){var t=this,n=t._mask,e=t.mask,r=t.self,i=t.state,u=n.input,s=F(r);return t._active=!1,t._options=new Cn(t,i.options=Xt(r),1),t._value=tt(r)||null,s&&(Et("reset",s,wn),Et("submit",s,zn)),u&&(Et("blur",u,nn),Et("blur",e,Zt),Et("cut",u,en),Et("focus",u,an),Et("focus",e,rn),Et("keydown",u,fn),Et("keydown",e,vn),Et("paste",u,dn)),Et("focus",r,un),Et("mousedown",D,gn),Et("mousedown",e,hn),Et("mousemove",D,yn),Et("mouseup",D,xn),Et("resize",H,An),Et("scroll",H,Sn),Et("touchend",D,xn),Et("touchmove",D,yn),Et("touchstart",D,gn),Et("touchstart",e,hn),o(i.with)&&k(i.with,(function(n,e){p(n)&&(n=Ln[n]),c(n)&&a(n.detach)&&n.detach.call(t,r,i)})),r.tabIndex=null,at(r,i.n+"__self"),ft(e),t._mask={of:r},t.mask=null,t._options._start=0,t},enter:function(t,n){var e,r=this,i=r._active,o=r._event,u=r._mask,a=r._options,s=r.mask,f=r.self,l=r.state,c=u.input,v=l.n;if(!i)return r;ht(s,v+"--open");var p=S(D);return p&&r!==p&&p.exit(),j(D,r),j(H,r),r.fire("enter",[o]),t&&(Gt(f)?(K(c),vt(c,n)):(e=z(y(tt(f)),a._o))&&K(e[2]),r.fire("focus",[o]).fire("focus.option",[o])),r},exit:function(t,n){var e=this,r=e._active,i=e._event,o=e._mask,u=e._options,a=e.mask,s=e.self,f=e.state,l=o.input,c=f.n;return r?(x(u,(function(t){return t[2].hidden=!1})),at(a,c+"--open"),e.fire("exit",[i]),t&&(Gt(s)?(K(l),vt(l,n)):K(a),e.fire("focus",[i]).fire("focus.self",[i])),e):e},fit:function(){var t=this,n=t._active,e=t._event,r=t._mask,i=t.mask,o=r.options;if(!n||J(i,"size"))return t;var u=G(i,"border-bottom-width"),a=G(i,"border-top-width"),s=Tt(i),f=Tt(H);return s[1]+s[3]/2>f[3]/2?xt(o,{bottom:"100%","max-height":"calc("+s[1]+"px + "+u+")",top:"auto"}):xt(o,{bottom:"auto","max-height":"calc("+(f[3]-s[1]-s[3])+"px + "+a+")",top:"100%"}),t.fire("fit",[e])},focus:function(t){var n=this,e=n._event,r=n._mask,i=n.mask,o=r.input;return o?(K(o),vt(o,t)):K(i),n.fire("focus",[e]).fire("focus.self",[e])},reset:function(t,n){var e=this,r=e._active,i=e._event,o=e._value;if(!r)return e;var u=e.value;return e.value=o,e.fire("reset",[i,u]),t?e.focus(n):e}}),L(Cn,{name:{value:"Options"}},1),L(Cn,{open:{get:function(){var t=this.of,n=t.mask,e=t.state.n;return et(n,e+"--open")}}}),C(Cn,{delete:function(t,n){void 0===n&&(n=1);var e,r=this,i=r._o,o=r.of,u=o._active,a=o._event,s=o._mask,f=o.self,l=o.state,c=s.options,p=l.n;if(!u)return!1;if(!v(t))return x(i,(function(t,n){return r.let(n,0)})),En(o,0,n),c.hidden=!0,o.fire("let.options",[a,r]).fire("change",[a,null]),0===r.count;if(!(e=z(t=y(t),i)))return o.fire("not.option",[a,t]),!1;var d=q(e[2]),h=q(e[3]),_=Ft(e[2]),m=o.value;return Et("blur",e[2],tn),Et("focus",e[2],on),Et("keydown",e[2],pn),Et("mousedown",e[2],mn),Et("touchend",e[2],kn),Et("touchstart",e[2],mn),ft(e[2]),ft(e[3]),(e=E(t,i))&&--r.count,d&&et(d,p+"__option-group")&&0===g(Y(d))&&ft(d),h&&"optgroup"===W(h)&&0===g(Y(h))&&ft(h),0===g(Y(c))?(En(o,0,!Gt(f)),c.hidden=!0):_===m&&On(o),o.fire("let.option",[a,t]),e},get:function(t){var n,e=this._o,r=this.of.state.n,i=z(y(t),e);return i&&(n=q(i[2]))&&et(n,r+"__option-group")?[V(i[2]),V(n)]:i?V(i[2]):-1},has:function(t){return T(y(t),this._o)},let:function(t,n){void 0===n&&(n=1);var e,r=this.of,i=r._event,o=r.self,u=tt(o);return e=this.delete(t=y(t)),n&&u!==tt(o)&&r.fire("change",[i,t]),e},set:function(t,n){var e,r,i,o=this,a=o._o,s=o._start,l=o.of,c=l._active,d=l._event;if(!c&&!s)return!1;if(o.has(t=y(t)))return l.fire("has.option",[d,t]),!1;var _,m,b,g,k,x,w,A,S,z,T=l._mask,O=l.self,E=l.state,L=T.options,C=E.n;(C+="__option",Gt(O)?!(m=O.list)||Y(m):Y(m=O),L.hidden=!1,v(n)?(u(n)||f(n)||p(n))&&(n=[n,{}]):n=[t,{}],rt(n[1],"&"))?(z="."+C+'-group[data-value="'+n[1]["&"].replace(/"/g,'\\"')+'"]',(g=(L||N).querySelector(z))&&Ft(g)===n[1]["&"]||(dt(L,g=bt("span",{class:C+"-group","data-value":n[1]["&"],title:null!=(A=Q(n[1],"title"))&&A})),dt(m,k=bt("optgroup",{label:n[1]["&"],title:null!=(S=Q(n[1],"title"))&&S})),(_=Q(n[1],"class"))&&(_t(g,_),_t(k,_)),(w=Q(n[1],"style"))&&(xt(g,w),xt(k,w)))):g=k=!1;var M=n[1],P=M.disabled,H=M.selected,R=M.value;return it(O)&&(P=!0),R=h(R||t),b=n[2]||bt("span",h(n[0]),{class:C+(P?" "+C+"--disabled":"")+(H?" "+C+"--selected":""),"data-group":null!=(e=Q(n[1],"&"))&&e,"data-value":R,tabindex:!P&&-1,title:null!=(r=Q(n[1],"title"))&&r}),x=n[3]||bt("option",h(n[0]),{disabled:!!P&&"",selected:!!H&&"",title:null!=(i=Q(n[1],"title"))&&i,value:R}),(_=Q(n[1],"class"))&&(_t(b,_),_t(x,_)),(w=Q(n[1],"style"))&&(xt(b,w),xt(x,w)),b._={},b._[0]=x,P||n[2]||(jt("blur",b,tn),jt("focus",b,on),jt("keydown",b,pn),jt("mousedown",b,mn),jt("touchend",b,kn),jt("touchstart",b,mn)),dt(g||L,b),dt(k||m,x),j(b,l),n[2]=b,n[3]=x,++o.count,I(t,n,a),l.fire("set.option",[d,t]).value=l.value,!0}}),A(Cn)[Symbol.iterator]=function(){return this._o[Symbol.iterator]()},Ln.Options=Cn,Ln}));