/*!
 *
 * The MIT License (MIT)
 *
 * Copyright © 2025 Taufik Nurrohman <https://github.com/taufik-nurrohman>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the “Software”), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */
!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(t="undefined"!=typeof globalThis?globalThis:t||self).OptionPicker=n()}(this,(function(){"use strict";var t=function(t,n){return-1!==n.indexOf(t)},n=function(t){return Array.isArray(t)},e=function(t){return u(t)&&0!=t%1},r=function(t){return"function"==typeof t},i=function(t,n,e){return!(!t||"object"!=typeof t)&&(e?a(n)&&a(t.constructor)&&n===t.constructor:a(n)&&t instanceof n)},o=function(t){return u(t)&&0==t%1},u=function(t){return"number"==typeof t},s=function(t,n){return void 0===n&&(n=!0),!(!t||"object"!=typeof t)&&(!n||i(t,Object,1))},a=function(t){return function(t){return void 0!==t}(t)&&!function(t){return null===t}(t)},f=function(t){return"string"==typeof t},c=function(t){return t.replace(/[-_.](\w)/g,(function(t,n){return v(n)}))},l=function(t){return t.toLowerCase()},v=function(t){return t.toUpperCase()},d=function(t){return t.length},p=function(t){if(n(t))return t.map((function(t){return p(t)}));if(function(t){return/^-?(?:\d*.)?\d+$/.test(t+"")}(t))return function(t,n){return void 0===n&&(n=10),n?parseInt(t,n):parseFloat(t)}(t);if(s(t)){for(var e in t)t[e]=p(t[e]);return t}return"false"!==t&&("null"===t?null:"true"===t||t)},h=function(){for(var e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];for(var o=r.shift(),u=0,f=d(r);u<f;++u)for(var c in r[u])if(a(o[c]))if(n(o[c])&&n(r[u][c])){o[c]=[].concat(o[c]);for(var l=0,v=d(r[u][c]);l<v;++l)t(r[u][c][l],o[c])||o[c].push(r[u][c][l])}else s(o[c])&&s(r[u][c])?o[c]=h({},o[c],r[u][c]):o[c]=r[u][c];else o[c]=r[u][c];return o},m=function(t){if(n(t))return t.map((function(n){return m(t)}));if(s(t)){for(var e in t)t[e]=m(t[e]);return t}return!1===t?"false":null===t?"null":!0===t?"true":""+t},_=document,g=window,b=_.body,k=_.documentElement,x=function(t){return t.firstElementChild||null},y=function(t){return t.lastElementChild||null},w=function(t,n){var e=[].slice.call(t.children);return u(n)?e[n]||null:e},z=function(t,n,e){void 0===e&&(e=!0);var r=function(t,n,e){if(void 0===e&&(e=!0),!M(t,n))return null;var r=t.getAttribute(n);return e?p(r):r}(t,"data-"+n,e),i=(r+"").trim();return e&&i&&("["===i[0]&&"]"===i.slice(-1)||"{"===i[0]&&"}"===i.slice(-1))&&null!==(i=function(t){var n=null;try{n=JSON.parse(t)}catch(t){}return n}(r))?i:r},E=function(t,n){void 0===n&&(n=!0);var e="innerHTML";if(!N(t,e))return!1;var r=t[e];return""!==(r=n?r.trim():r)?r:null},L=function(t){return l(t&&t.nodeName||"")||null},T=function(t,n){return t["next"+(n?"":"Element")+"Sibling"]||null},O=function(t,n){return n?t.closest(n)||null:t.parentNode||null},A=function(t){var n="form";return N(t,n)&&n===L(t[n])?t[n]:O(t,n)},C=function(t,n){return t["previous"+(n?"":"Element")+"Sibling"]||null},P=function(t,n,e){var r=g.getComputedStyle(t).getPropertyValue(n);return r||""===r||0===r?r:null},S=function(t,n){void 0===n&&(n=!0);var e="textContent";if(!N(t,e))return!1;var r=t[e];return""!==(r=n?r.trim():r)?r:null},M=function(t,n){return t.hasAttribute(n)},j=function(t,n){return t.classList.contains(n)},N=function(t,n){return n in t},R=function(t,n){return t.removeAttribute(n),t},D=function(t,n){return t.classList.remove(n),t},H=function(t){var n=O(t);return t.remove(),n},I=function(t,n){return t.style[c(n)]=null,t},K=function(t,n,e){return!0===e&&(e=n),t.setAttribute(n,m(e)),t},B=function(t,n){return t.append(n),n},U=function(t,n){return t.classList.add(n),t},Y=function(t,e,r){return(n(r)||s(r))&&(r=JSON.stringify(r)),K(t,"data-"+e,r)},J=function(t,n,e){return t=f(t)?_.createElement(t):t,s(n)&&(e=n,n=!1),f(n)&&V(t,n),s(e)&&function(t,n){var e;for(var r in n)(e=n[r])||""===e||0===e?K(t,r,e):R(t,r)}(t,e),t},V=function(t,n,e){if(void 0===e&&(e=!0),null===n)return t;var r="innerHTML";return N(t,r)&&(t[r]=e?n.trim():n),t},W=function(t,n,e){return u(e)&&(e+="px"),t.style[c(n)]=m(e),t},q=function(t,n){var e;for(var r in n)(e=n[r])||""===e||0===e?W(t,r,e):I(t,r);return t},F=function(t,n,e){if(void 0===e&&(e=!0),null===n)return t;var r="textContent";return N(t,r)&&(t[r]=e?n.trim():n),t},X=function(t,n){var e;return function(){var r=arguments,i=this;e&&clearTimeout(e),e=setTimeout((function(){return t.apply(i,r)}),n)}},$=function(t,n){return function(){var e=arguments,r=this;setTimeout((function(){return t.apply(r,e)}),n)}},G=function(t){var n,e,r,i,o,u,s;return!function(t){return t===g}(t)?(i=(e=t.getBoundingClientRect()).left,o=e.top,r=e.width,n=e.height,u=e.right,s=e.bottom):(i=t.pageXOffset||k.scrollLeft||b.scrollLeft,o=t.pageYOffset||k.scrollTop||b.scrollTop,r=t.innerWidth,n=t.innerHeight),[i,o,r,n,u,s]},Q=function(t){return[t.scrollLeft,t.scrollTop]};var Z=function(t,n,e){n.removeEventListener(t,e)},tt=function(t){return t&&t.preventDefault()},nt=function(t){return t&&t.stopPropagation()},et=function(t,n,e,r){void 0===r&&(r=!1),n.addEventListener(t,e,r)},rt="ArrowDown",it="ArrowUp",ot="Backspace",ut="Delete",st="Enter",at="Escape",ft="PageDown",ct="PageUp",lt="Tab",vt=X((function(t){return t.fit()}),10),dt=new WeakMap;function pt(t,e,r){var o=i(e,Map)?e:new Map;if(n(e))_t(e,(function(t){var e,r,i;n(t)?(t[0]=null!=(e=t[0])?e:"",t[1]=null!=(r=t[1])?r:{},At(m(null!=(i=t[1].value)?i:t[0]),t,o)):At(m(t),[t,{}],o)}));else if(s(e,0))for(var u in e){var a,f,c;if(n(e[u]))e[u][0]=null!=(a=e[u][0])?a:"",e[u][1]=null!=(f=e[u][1])?f:{},At(m(null!=(c=e[u][1].value)?c:u),e[u],o);else At(m(u),[e[u],{}],o)}!function(t,n,e){var r,i,o=t.self;t.state.n,r="input"===L(o)?(i=o.list)?w(i):[]:w(i=o);for(var u=0,s=d(r);u<s;++u){if("optgroup"===L(r[u]))for(var a=w(r[u]),f=0,c=d(a);f<c;++f)a[f]&&H(a[f]);r[u]&&H(r[u])}t._options=new cn(t),V(n,""),gt(e,(function(n,e){At(e,n,t._options)})),t.state.options=e}(t,r,o)}function ht(t,n,e){Object.defineProperty(t,n,e)}function mt(t){t.focus()}function _t(t,n){t.forEach(n)}function gt(t,n){t instanceof cn&&(t=t.map),_t(t,n)}function bt(t){return z(t,"value",!1)}function kt(t){var n,e,r,i=new Map,o=[],u=yt(t);e="input"===L(t)?(r=t.list)?w(r):[]:w(r=t);for(var s=function(t){var n=e[t],r=function(t,n){void 0===n&&(n=!0);for(var e,r=t.attributes,i={},o=0,u=r.length;o<u;++o)e=r[o].value,i[r[o].name]=n?p(e):e;return i}(n);if(_t(["disabled","selected"],(function(n){n in r?(r[n]=""===r[n]||r[n],"selected"===n&&o.push(t)):r[n]=null})),"optgroup"===L(n))return gt(kt(n),(function(t,e){t[1]["&"]=n.label,At(m(e),t,i)})),1;At(m(n.value),[S(n)||n.value,r,null,n],i)},a=0,f=d(e);a<f;++a)s(a);return 0===d(o)&&(n=wt(u=m(u),i))&&(n[1].selected=!0,At(u,n,i)),i}function xt(t){return wt(t,dt)||null}function yt(t){return(t.value||"").replace(/\r/g,"")}function wt(t,n){return n.get(t)}function zt(t){return t.disabled}function Et(t){return t.readOnly}function Lt(t){return Tt(t,dt)}function Tt(t,n){return n instanceof cn?n.let(t):n.delete(t)}function Ot(t,n){return At(t,n,dt)}function At(t,n,e){return e.set(t,n)}function Ct(t){var n=[];return gt(t,(function(t){return n.push(t)})),n}function Pt(t,n){var e=this;return t?i(e,Pt)?(Ot(t,function(t,n){return(n=n||t).fire=function(t,n,e){var r=this,i=r.hooks;return a(i[t])?(i[t].forEach((function(t){return t.apply(e||r,n)})),r):r},n.off=function(t,n){var e=this,r=e.hooks;if(!a(t))return r={},e;if(a(r[t]))if(a(n)){var i=r[t].length;if(0===i)delete r[t];else for(var o=0;o<i;++o)if(n===r[t][o]){r[t].splice(o,1);break}}else delete r[t];return e},n.on=function(t,n){var e=this.hooks;return a(e[t])||(e[t]=[]),a(n)&&e[t].push(n),this},t.hooks={},t}(e,Pt._)),e.attach(t,h({},Pt.state,n||{}))):new Pt(t,n):e}Pt.from=function(t,n){return new Pt(t,n)},Pt.of=xt,Pt.state={n:"option-picker",options:null,size:null,strict:!1,with:[]},Pt.version="2.0.0",ht(Pt,"name",{value:"OptionPicker"});var St=Pt._=Pt.prototype;ht(St,"options",{get:function(){return this._options},set:function(t){var n=this,r=n._mask,i=n.state.n;i+="__option",(e(t)||o(t)||f(t))&&(t=[t]),pt(n,t,r.options);var u=Ct(n._options).find((function(t){return!t[2].hidden&&!j(t[2],i+"--disabled")}));u&&(n.value=bt(u[2]))}}),ht(St,"size",{get:function(){var t=this.state.size||1;return o(t)?t<1?1:t:1},set:function(t){var n=this,e=n._mask,r=n._options,i=n.mask,u=n.state,s=e.options;u.n;var a=o(t)?t<1?1:t:1;if(n.state.size=a,1===a)R(i,"data-"+"size"),I(s,"max-height"),Lt(k);else{var f=Ct(r).find((function(t){return!t[2].hidden}));if(f){var c,l,v=P(s,"gap"),d=P(s,"padding-bottom"),p=null!=(c=null!=(l=P(f,"height"))?l:P(f,"min-height"))?c:P(f,"line-height");Y(i,"size",a),W(s,"max-height","calc(("+p+" + max("+v+","+d+"))*"+a+")"),Ot(k,n)}}}}),ht(St,"text",{get:function(){var t=this._mask,n=t.input;return t.text?S(n):null},set:function(t){var n=this._mask,e=this.self,r=n.hint,i=n.input;n.text&&(F(i,m(t)),S(i,!1)?F(r,""):F(r,e.placeholder+""))}}),ht(St,"value",{get:function(){var t=yt(this.self);return""===t?null:t},set:function(t){var n,e=this._options;(n=wt(m(t),e))&&fn(n[2],this)}}),ht(St,"values",{get:function(){},set:function(t){}});var Mt=X((function(n,e,o,u){var s=f(e)?e:S(e)||"",a=l(s),c=n._event,v=n._mask,p=n.mask,h=n.self,m=n.state,_=v.options,g=v.value,b=m.n,k=m.strict,x=z(p,"size");if(b+="__option",u){var y,w=yt(h);gt(o,(function(t){R(t[3],"selected"),D(t[2],b+"--selected")}));try{gt(o,(function(t){var e=l(S(t[2])+"\t"+(y=bt(t[2])));if(""!==a&&a===e.slice(0,d(a))&&!j(t[2],b+"--disabled"))throw h.value=y,K(t[3],"selected",""),U(t[2],b+"--selected"),Y(g,"value",y),V(g,E(t[2])),y!==w&&n.fire("change",[c,y]),x&&t[2].scrollIntoView({block:"nearest"}),""}))}catch(t){}}else{var L,T=o.count;gt(o,(function(n){D(n[2],b+"--focus");var e=l(S(n[2])+"\t"+bt(n[2]));""===a||t(a,e)?(n[2].hidden=!1,k&&(L=Ct(o).find((function(t){return!t[2].hidden&&!j(t[2],b+"--disabled")})))&&U(L[2],b+"--focus")):(n[2].hidden=!0,--T)})),_.hidden=!T,h.value=k?"":s}n.fire("search",[c,s]);var O=m.options;r(O)&&(O=O.call(n,s),i(O,Promise)?O.then((function(t){pt(n,t,_),n.fire("load",[c,t,s])})):pt(n,O,_))}),50);function jt(t){var n=this,e=xt(n),r=e.state.n;e._event=t,D(n,r+="--focus"),D(n,r+="-self")}function Nt(t){var n=this,e=xt(n);e.mask;var r=e.state.n;e._event=t,D(n,r+="--focus"),D(n,r+="-option")}function Rt(t){var n=this,e=xt(n),r=e._mask,i=e._options,o=e.mask,u=e.self,s=e.state,a=r.options,f=r.text,c=s.n,l=s.strict;if(e._event=t,D(o,c+"--focus-text"),D(f,c+"__text--focus"),l){var v=Ct(i).find((function(t){return S(t[2],!1)===S(n,!1)}))||Ct(i).find((function(t){return!t[2].hidden&&!j(t[2],c+"__option--disabled")}));v&&!a.hidden?fn(v[2],e):(gt(i,(function(t){R(t[3],"selected"),D(t[2],c+"__option--selected"),t[2].hidden=!1})),a.hidden=!1,e.text=u.value="")}}function Dt(t){var n=this,e=xt(n),r=e._mask,i=e.self,o=r.hint;e._event=t,$((function(){return F(o,S(n,!1)?"":i.placeholder)}),1)()}function Ht(t){var n=this,e=xt(n),r=e.state.n;e._event=t,U(n,r+="--focus"),U(n,r+="-self")}function It(t){var n=xt(this),e=n.mask,r=n.state.n;sn(),n._event=t,U(e,r+="--focus"),U(e,r+="-option")}function Kt(t){var n=xt(this);n._event=t,n.focus()}function Bt(t){var n=xt(this),e=n._mask,r=n.mask;n.self;var i=n.state,o=e.input,u=e.text,s=i.n;n._event=t,U(u,s+"__text--focus"),U(r,s+="--focus"),U(r,s+="-text"),S(o,!1)?an(this):n.enter().fit()}function Ut(t){var n,e=this,r=t.key,i=xt(e),o=i._mask,u=i._options,s=i.mask,a=i.self,f=i.state,c=o.hint,l=o.input,v=f.n,p=f.strict;if(i._event=t,$((function(){return F(c,S(e,!1)?"":a.placeholder)}),1)(),ot!==r&&ut!==r&&1!==d(r)||$((function(){return i.enter().fit()}),51)(),rt===r||it===r||st===r){var h,m=wt(yt(a),u);if(!(m=m?m[2]:0)||m.hidden)for(m=(m=Ct(u).shift())?m[2]:0;m&&(j(m,v+"__option--disabled")||m.hidden);)m=T(m);st===r&&(j(s,v+"--open")?p&&(h=Ct(u).find((function(t){return!t[2].hidden&&!j(t[2],v+"--disabled")})))&&(fn(h[2],i),i.exit(),mt(l),an(l)):(gt(u,(function(t){return t[2].hidden=!1})),i.enter())),m&&mt(m),n=!0}else lt===r?i.exit():Mt(i,e,u);n&&(tt(t),nt(t))}var Yt="",Jt=X((function(){return Yt=""}),500);function Vt(t){var n,e=t.key,r=t.altKey,i=t.ctrlKey,o=xt(this),u=o._options,s=o.self;if(Jt(),zt(s)||Et(s))return tt(t);o._event=t,ot===e||ut===e?Yt="":at===e?(Yt="",o.exit(n=!0)):lt===e?(Yt="",o.exit(!(n=!1))):rt===e||it===e||st===e||ft===e||ct===e||""===Yt&&" "===e?o.enter(n=!0).fit():1!==d(e)||r||i||(Yt+=e),""!==Yt&&Mt(o,Yt,u,n=!0),n&&tt(t)}function Wt(t){var n,e=this,r=t.key,i=t.altKey,o=t.ctrlKey,u=xt(e),s=u._mask,a=u._options;u.mask;var f=u.self,c=u.state,l=s.hint,v=s.input,p=s.value,h=c.n;h+="__option";var m,_,g,b,k,w="input"===L(f);if(u._event=t,ot===r)u.exit(n=!0);else if(st===r||at===r||lt===r||" "===r){if(at!==r){var z,A=yt(f);(k=wt(A,a))&&(R(k[3],"selected"),D(k[2],h+"--selected")),K(e._[0],"selected",""),U(e,h+"--selected"),f.value=z=bt(e),w?(F(l,""),F(v,S(e))):(Y(p,"value",z),V(p,E(e))),z!==A&&u.fire("change",[t,z])}u.exit(n=lt!==r)}else if(rt===r||ft===r){for(n=!0,g=ft===r&&j(b=O(e),h+"-group")?T(b):T(e);g&&(j(g,h+"--disabled")||g.hidden);)g=T(g);for(g?j(g,h+"-group")&&(g=x(g)):((b=O(e))&&j(b,h+"-group")&&(g=T(b)),g&&j(g,h+"-group")&&(g=x(g)));g&&(j(g,h+"--disabled")||g.hidden);)g=T(g);g?mt(g):(m=Ct(a).find((function(t){return!t[2].hidden&&!j(t[2],h+"--disabled")})))&&mt(m[2])}else if(it===r||ct===r){for(n=!0,k=ct===r&&j(b=O(e),h+"-group")?C(b):C(e);k&&(j(k,h+"--disabled")||k.hidden);)k=C(k);for(k?j(k,h+"-group")&&(k=y(k)):((b=O(e))&&j(b,h+"-group")&&(k=C(b)),k&&j(k,h+"-group")&&(k=y(k)));k&&(j(k,h+"--disabled")||k.hidden);)k=C(k);k?mt(k):(_=Ct(a).findLast((function(t){return!t[2].hidden&&!j(t[2],h+"--disabled")})))&&mt(_[2])}else"Home"===r?(n=!0,(m=Ct(a).find((function(t){return!t[2].hidden&&!j(t[2],h+"--disabled")})))&&mt(m[2])):"End"===r?(n=!0,(_=Ct(a).findLast((function(t){return!t[2].hidden&&!j(t[2],h+"--disabled")})))&&mt(_[2])):(w&&1===d(r)&&!i&&!o&&F(l,""),u.exit(!(n=!1)));n&&(tt(t),nt(t))}function qt(t){var n=this,e=xt(n),r=e._mask,i=e.self,o=r.hint;e._event=t,$((function(){return F(n,S(n))}))(),$((function(){return F(o,S(n,!1)?"":i.placeholder)}),1)()}function Ft(t){var n=this,e=xt(n),r=e.self,i=e.state.n,o=t.target;tt(t),zt(r)||Et(r)||z(n,"size")||(e._event=t,j(o,i+"__options")||O(o,"."+i+"__options")||e[j(n,i+"--open")?"exit":"enter"](!0).fit())}var Xt=0;function $t(t){var n=this,e=xt(n),r=e._mask,i=e.mask,o=r.options;e._event=t,"mousedown"===t.type?(fn(n,e),z(i,"size")||e.exit(!0)):(mt(n),Xt=Q(o)[1]),tt(t)}var Gt=!1;function Qt(t){"touchstart"===t.type&&(Gt=t.touches[0].clientY);var n=xt(this);if(n){var e=n.mask,r=n.state.n,i=t.target;n._event=t,e!==i&&e!==O(i,"."+r)&&(z(e,"size")?n.blur():(Lt(this),n.exit()))}}function Zt(t){if(!1!==Gt){var n,e,r=xt(this);if(r._event=t,"touchmove"===t.type&&r){var i=r._mask.options,o=t.touches[0].clientY;if(i){var u=Q(i);u[1]-=o-Gt,e=u,(n=i).scrollLeft=e[0],n.scrollTop=e[1],Gt=o}}}}function tn(t){var n=xt(this),e=n._mask.options;n._event=t,Q(e)[1]===Xt&&(fn(this,n),n.exit(!0))}function nn(){Gt=!1}function en(t){var n=xt(this);n._event=t,n.let().fire("reset",[t])}function rn(t){var n=xt(this);n&&(vt(n),n._event=t)}function on(t){rn.call(this,t)}function un(t){var n=xt(this);return n._event=t,n.fire("submit",[t])}function sn(t){var n=_.getSelection();n.rangeCount&&n.removeRange(n.getRangeAt(0))}function an(t,n){var e=_.getSelection();sn();var r=_.createRange();r.selectNodeContents(t),e.addRange(r),1===n?e.collapseToEnd():-1===n&&e.collapseToStart()}function fn(t,n){var e=n._event,r=n._mask,i=n._options,o=n.self,u=n.state,s=r.hint,a=r.input;r.options;var f=r.value,c=u.n;c+="__option--selected";var l,v=yt(o);gt(i,(function(n){t!==n[2]&&(R(n[3],"selected"),D(n[2],c))})),K(t._[0],"selected",""),U(t,c),o.value=l=bt(t),"input"===L(o)?(F(s,""),F(a,S(t))):(Y(f,"value",l),V(f,E(t))),l!==v&&n.fire("change",[e,l])}function cn(t,n){var e=this;return i(e,cn)?(e.count=0,e.map=new Map,e.of=t,e):new cn(t)}St.attach=function(t,e){var o,u=this;t=t||u.self,e=e||u.state,u._active=!zt(t)&&!Et(t),u._event=null,u._options=new cn(u),u._value=yt(t)||null,u.self=t,u.state=e;var c="input"===L(t),l=e.n,v=J("span",{class:l+"__arrow"}),p=A(t),h=J("div",{class:l,tabindex:!zt(t)&&!c&&0});u.mask=h;var m,_,b=J("div",{class:l+"__options"}),x=J("div",{class:l+"__values"}),y=J("span",{class:l+"__"+(c?"text":"value")}),w=J("span",{autocapitalize:"off",contenteditable:!(zt(t)||Et(t)||!c)&&"",spellcheck:!!c&&"false"}),z=J("span",c?t.placeholder+"":"");B(h,x),B(h,b),B(x,y),B(x,v),c?(et("blur",w,Rt),et("cut",w,Dt),et("focus",w,Bt),et("keydown",w,Ut),et("paste",w,qt),B(y,w),B(y,z),Ot(w,u)):(et("blur",h,jt),et("focus",h,Ht),et("keydown",h,Vt)),U(t,l+"__self"),_=h,O(m=t).insertBefore(_,T(m,!0)),p&&(et("reset",p,en),et("submit",p,un),Ot(p,u)),et("focus",t,Kt),et("mousedown",k,Qt),et("mousedown",h,Ft),et("mousemove",k,Zt),et("mouseup",k,nn),et("resize",g,rn),et("scroll",g,on),et("touchend",k,nn),et("touchmove",k,Zt,{passive:!1}),et("touchstart",k,Qt),et("touchstart",h,Ft),t.tabIndex=-1,Ot(h,u);var E,C={};C.arrow=v,C.hint=c?z:null,C.input=c?w:null,C.of=t,C.options=b,C.self=h,C[c?"text":"value"]=y,u._mask=C,u.size=null!=(o=e.size)?o:c?1:t.size;var P=e.options;if(r(P)?(P=P.call(u,null),i(P,Promise)?P.then((function(t){pt(u,t,b),u.fire("load",[u._event,t,null])})):pt(u,P,b)):pt(u,P||kt(t),b),(E=wt(u._value,u._options)||(c?0:Ct(u._options).find((function(t){return!zt(t[3])}))))&&(u.value=bt(E[2])),a(e)&&n(e.with))for(var S=0,M=d(e.with);S<M;++S){var j=e.with[S];f(j)&&(j=Pt[j]),r(j)?j.call(u,t,e):s(j)&&r(j.attach)&&j.attach.call(u,t,e)}return u},St.blur=function(){sn();var t=this,n=t._mask,e=t.mask;return(n.input||e).blur(),t.exit()},St.detach=function(){var t=this,e=t._mask,i=t.mask,o=t.self,u=t.state,a=e.input,c=A(o);if(t._active=!1,t._value=yt(o)||null,c&&(Z("reset",c,en),Z("submit",c,un)),a&&(Z("blur",a,Rt),Z("blur",i,jt),Z("cut",a,Dt),Z("focus",a,Bt),Z("focus",i,Ht),Z("keydown",a,Ut),Z("keydown",i,Vt),Z("paste",a,qt)),Z("focus",o,Kt),Z("mousedown",k,Qt),Z("mousedown",i,Ft),Z("mousemove",k,Zt),Z("mouseup",k,nn),Z("resize",g,rn),Z("scroll",g,on),Z("touchend",k,nn),Z("touchmove",k,Zt),Z("touchstart",k,Qt),Z("touchstart",i,Ft),n(u.with))for(var l=0,v=d(u.with);l<v;++l){var p=u.with[l];f(p)&&(p=Pt[p]),s(p)&&r(p.detach)&&p.detach.call(t,o,u)}return o.tabIndex=null,D(o,u.n+"__self"),H(i),t._mask={of:o},t.mask=null,t},St.enter=function(t){var n,e=this,r=e._event,i=e._mask,o=e._options,u=e.mask,s=e.self,a=e.state,f=i.input,c=a.n;U(u,c+"--focus"),U(u,c+"--focus-option"),U(u,c+="--open");var l=xt(k);return l&&e!==l&&l.exit(),Ot(k,e),Ot(g,e),e.fire("enter",[r]),t&&(e.fire("focus",[r]),"input"===L(s)?(mt(f),an(f)):(n=wt(yt(s),o))&&mt(n[2]),e.fire("focus.option",[r])),e},St.exit=function(t){var n=this,e=n._event,r=n._mask,i=n.mask,o=n.self,u=n.state,s=r.input,a=u.n;return D(i,a+"--focus"),D(i,a+"--focus-option"),D(i,a+="--open"),n.fire("exit",[e]),t&&("input"===L(o)?(mt(s),an(s)):mt(i),n.fire("focus",[e]).fire("focus.self",[e])),n},St.fit=function(){var t=this,n=t._mask,e=t.mask,r=n.options;if(z(e,"size"))return t;var i=P(e,"border-bottom-width"),o=P(e,"border-top-width"),u=G(e),s=G(g);return u[1]+u[3]/2>s[3]/2?q(r,{bottom:"100%","max-height":"calc("+u[1]+"px + "+i+")",top:"auto"}):q(r,{bottom:"auto","max-height":"calc("+(s[3]-u[1]-u[3])+"px + "+o+")",top:"100%"}),t},St.focus=function(t){var n=this,e=n._mask,r=n.mask,i=e.input;return i?(mt(i),an(i,t),n):(mt(r),n)};var ln=cn.prototype;return ln.get=function(t){return wt(m(t),this.map)},ln.has=function(t){return n=m(t),this.map.has(n);var n},ln.let=function(t){var n=this;return Tt(m(t),n.map)&&--n.count,n},ln.set=function(t,n){var r=this;if(r.has(t))return r;var i,u,s,c,l,v,d=r.map,p=r.of,h=p._mask,g=p.self,b=p.state,k=h.options,x=b.n;x+="__option","input"===L(g)?!(i=g.list)||w(i):w(i=g),a(n)?(e(n)||o(n)||f(n))&&(n=[n,{}]):n=[t,{}],"&"in n[1]?(v="."+x+'-group[data-value="'+n[1]["&"].replace(/"/g,'\\"')+'"]',(c=(k||_).querySelector(v))&&bt(c)===n[1]["&"]||(B(k,c=J("span",{class:x+"-group","data-value":n[1]["&"]})),B(i,l=J("optgroup",{label:n[1]["&"]})))):c=l=!1;var y=n[1],z=y.disabled,E=y.selected,T=y.value;return zt(g)&&(z=!0),T=m(T||t),u=n[2]||J("span",m(n[0]),{class:x+(z?" "+x+"--disabled":"")+(E?" "+x+"--selected":""),"data-group":"&"in n[1]&&n[1]["&"],"data-value":T,tabindex:!z&&-1}),s=n[3]||J("option",m(n[0]),{disabled:!!z&&"",selected:!!E&&"",value:T}),u._={},u._[0]=s,z||n[2]||(et("blur",u,Nt),et("focus",u,It),et("keydown",u,Wt),et("mousedown",u,$t),et("touchend",u,tn),et("touchstart",u,$t)),B(c||k,u),B(l||i,s),Ot(u,p),n[2]=u,n[3]=s,++r.count,At(t,n,d),r},Pt.Options=cn,Pt}));